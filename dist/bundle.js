(()=>{var e={3010:e=>{function t(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=t,t.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},t.prototype.reset=function(){this.attempts=0},t.prototype.setMin=function(e){this.ms=e},t.prototype.setMax=function(e){this.max=e},t.prototype.setJitter=function(e){this.jitter=e}},3704:(e,t)=>{!function(e){"use strict";t.encode=function(t){var n,r=new Uint8Array(t),o=r.length,a="";for(n=0;n<o;n+=3)a+=e[r[n]>>2],a+=e[(3&r[n])<<4|r[n+1]>>4],a+=e[(15&r[n+1])<<2|r[n+2]>>6],a+=e[63&r[n+2]];return o%3==2?a=a.substring(0,a.length-1)+"=":o%3==1&&(a=a.substring(0,a.length-2)+"=="),a},t.decode=function(t){var n,r,o,a,i,s=.75*t.length,l=t.length,c=0;"="===t[t.length-1]&&(s--,"="===t[t.length-2]&&s--);var u=new ArrayBuffer(s),h=new Uint8Array(u);for(n=0;n<l;n+=4)r=e.indexOf(t[n]),o=e.indexOf(t[n+1]),a=e.indexOf(t[n+2]),i=e.indexOf(t[n+3]),h[c++]=r<<2|o>>4,h[c++]=(15&o)<<4|a>>2,h[c++]=(3&a)<<6|63&i;return u}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},6077:e=>{var t=[].slice;e.exports=function(e,n){if("string"==typeof n&&(n=e[n]),"function"!=typeof n)throw new Error("bind() requires a function");var r=t.call(arguments,2);return function(){return n.apply(e,r.concat(t.call(arguments)))}}},8767:e=>{function t(e){if(e)return function(e){for(var n in t.prototype)e[n]=t.prototype[n];return e}(e)}e.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},t.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var o=0;o<r.length;o++)if((n=r[o])===t||n.fn===t){r.splice(o,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t)}return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length}},3549:e=>{e.exports="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")()},5983:(e,t,n)=>{const r=n(2192);e.exports=(e,t)=>new r(e,t),e.exports.Socket=r,e.exports.protocol=r.protocol,e.exports.Transport=n(6496),e.exports.transports=n(3352),e.exports.parser=n(9743)},2192:(e,t,n)=>{const r=n(3352),o=n(8767),a=n(4802)("engine.io-client:socket"),i=n(9743),s=n(4187),l=n(1830);class c extends o{constructor(e,t={}){super(),e&&"object"==typeof e&&(t=e,e=null),e?(e=s(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=s(t.host).host),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.transports=t.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,upgrade:!0,jsonp:!0,timestampParam:"t",policyPort:843,rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{}},t),this.opts.path=this.opts.path.replace(/\/$/,"")+"/","string"==typeof this.opts.query&&(this.opts.query=l.decode(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,this.open()}createTransport(e){a('creating transport "%s"',e);const t=function(e){const t={};for(let n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(this.opts.query);t.EIO=i.protocol,t.transport=e,this.id&&(t.sid=this.id);const n=Object.assign({},this.opts.transportOptions[e],this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return a("options: %j",n),new r[e](n)}open(){let e;if(this.opts.rememberUpgrade&&c.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){const e=this;return void setTimeout((function(){e.emit("error","No transports available")}),0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return a("error while creating transport: %s",e),this.transports.shift(),void this.open()}e.open(),this.setTransport(e)}setTransport(e){a("setting transport %s",e.name);const t=this;this.transport&&(a("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",(function(){t.onDrain()})).on("packet",(function(e){t.onPacket(e)})).on("error",(function(e){t.onError(e)})).on("close",(function(){t.onClose("transport close")}))}probe(e){a('probing transport "%s"',e);let t=this.createTransport(e,{probe:1}),n=!1;const r=this;function o(){if(r.onlyBinaryUpgrades){const e=!this.supportsBinary&&r.transport.supportsBinary;n=n||e}n||(a('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",(function(o){if(!n)if("pong"===o.type&&"probe"===o.data){if(a('probe transport "%s" pong',e),r.upgrading=!0,r.emit("upgrading",t),!t)return;c.priorWebsocketSuccess="websocket"===t.name,a('pausing current transport "%s"',r.transport.name),r.transport.pause((function(){n||"closed"!==r.readyState&&(a("changing transport and sending upgrade packet"),p(),r.setTransport(t),t.send([{type:"upgrade"}]),r.emit("upgrade",t),t=null,r.upgrading=!1,r.flush())}))}else{a('probe transport "%s" failed',e);const n=new Error("probe error");n.transport=t.name,r.emit("upgradeError",n)}})))}function i(){n||(n=!0,p(),t.close(),t=null)}function s(n){const o=new Error("probe error: "+n);o.transport=t.name,i(),a('probe transport "%s" failed because of error: %s',e,n),r.emit("upgradeError",o)}function l(){s("transport closed")}function u(){s("socket closed")}function h(e){t&&e.name!==t.name&&(a('"%s" works - aborting "%s"',e.name,t.name),i())}function p(){t.removeListener("open",o),t.removeListener("error",s),t.removeListener("close",l),r.removeListener("close",u),r.removeListener("upgrading",h)}c.priorWebsocketSuccess=!1,t.once("open",o),t.once("error",s),t.once("close",l),this.once("close",u),this.once("upgrading",h),t.open()}onOpen(){if(a("socket open"),this.readyState="open",c.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause){a("starting upgrade probes");let e=0;const t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(a('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emit("pong");break;case"error":const t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else a('packet received with socket readyState "%s"',this.readyState)}onHandshake(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){clearTimeout(this.pingTimeoutTimer),this.pingTimeoutTimer=setTimeout((()=>{this.onClose("ping timeout")}),this.pingInterval+this.pingTimeout)}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()}flush(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(a("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))}write(e,t,n){return this.sendPacket("message",e,t,n),this}send(e,t,n){return this.sendPacket("message",e,t,n),this}sendPacket(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"===this.readyState||"closed"===this.readyState)return;(n=n||{}).compress=!1!==n.compress;const o={type:e,data:t,options:n};this.emit("packetCreate",o),this.writeBuffer.push(o),r&&this.once("flush",r),this.flush()}close(){const e=this;function t(){e.onClose("forced close"),a("socket closing - telling transport to close"),e.transport.close()}function n(){e.removeListener("upgrade",n),e.removeListener("upgradeError",n),t()}function r(){e.once("upgrade",n),e.once("upgradeError",n)}return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(function(){this.upgrading?r():t()})):this.upgrading?r():t()),this}onError(e){a("socket error %j",e),c.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)}onClose(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){a('socket close with reason: "%s"',e);const n=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),n.writeBuffer=[],n.prevBufferLen=0}}filterUpgrades(e){const t=[];let n=0;const r=e.length;for(;n<r;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}c.priorWebsocketSuccess=!1,c.protocol=i.protocol,e.exports=c},6496:(e,t,n)=>{const r=n(9743),o=n(8767);e.exports=class extends o{constructor(e){super(),this.opts=e,this.query=e.query,this.readyState="",this.socket=e.socket}onError(e,t){const n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this}open(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)}onOpen(){this.readyState="open",this.writable=!0,this.emit("open")}onData(e){const t=r.decodePacket(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){this.emit("packet",e)}onClose(){this.readyState="closed",this.emit("close")}}},3352:(e,t,n)=>{const r=n(2777),o=n(3416),a=n(9785),i=n(4442);t.polling=function(e){let t,n=!1,i=!1;const s=!1!==e.jsonp;if("undefined"!=typeof location){const t="https:"===location.protocol;let r=location.port;r||(r=t?443:80),n=e.hostname!==location.hostname||r!==e.port,i=e.secure!==t}if(e.xdomain=n,e.xscheme=i,t=new r(e),"open"in t&&!e.forceJSONP)return new o(e);if(!s)throw new Error("JSONP disabled");return new a(e)},t.websocket=i},9785:(e,t,n)=>{const r=n(9015),o=n(3549),a=/\n/g,i=/\\n/g;let s;function l(){}e.exports=class extends r{constructor(e){super(e),this.query=this.query||{},s||(s=o.___eio=o.___eio||[]),this.index=s.length;const t=this;s.push((function(e){t.onData(e)})),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",(function(){t.script&&(t.script.onerror=l)}),!1)}get supportsBinary(){return!1}doClose(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),super.doClose()}doPoll(){const e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};const n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){const e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)}),100)}doWrite(e,t){const n=this;let r;if(!this.form){const e=document.createElement("form"),t=document.createElement("textarea"),n=this.iframeId="eio_iframe_"+this.index;e.className="socketio",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.target=n,e.method="POST",e.setAttribute("accept-charset","utf-8"),t.name="d",e.appendChild(t),document.body.appendChild(e),this.form=e,this.area=t}function o(){s(),t()}function s(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(e){n.onError("jsonp polling iframe removal error",e)}try{const e='<iframe src="javascript:0" name="'+n.iframeId+'">';r=document.createElement(e)}catch(e){r=document.createElement("iframe"),r.name=n.iframeId,r.src="javascript:0"}r.id=n.iframeId,n.form.appendChild(r),n.iframe=r}this.form.action=this.uri(),s(),e=e.replace(i,"\\\n"),this.area.value=e.replace(a,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===n.iframe.readyState&&o()}:this.iframe.onload=o}}},3416:(e,t,n)=>{const r=n(2777),o=n(9015),a=n(8767),{pick:i}=n(6839),s=n(3549),l=n(4802)("engine.io-client:polling-xhr");function c(){}const u=null!=new(n(2777))({xdomain:!1}).responseType;class h extends a{constructor(e,t){super(),this.opts=t,this.method=t.method||"GET",this.uri=e,this.async=!1!==t.async,this.data=void 0!==t.data?t.data:null,this.isBinary=t.isBinary,this.supportsBinary=t.supportsBinary,this.create()}create(){const e=i(this.opts,"agent","enablesXDR","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized");e.xdomain=!!this.opts.xd,e.xscheme=!!this.opts.xs;const t=this.xhr=new r(e),n=this;try{l("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0);for(let e in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(e)&&t.setRequestHeader(e,this.opts.extraHeaders[e])}}catch(e){console.log(e)}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(t.timeout=this.opts.requestTimeout),this.hasXDR()?(t.onload=function(){n.onLoad()},t.onerror=function(){n.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState)try{const e=t.getResponseHeader("Content-Type");(n.supportsBinary&&"application/octet-stream"===e||"application/octet-stream; charset=UTF-8"===e)&&(t.responseType="arraybuffer")}catch(e){}4===t.readyState&&(200===t.status||1223===t.status?n.onLoad():setTimeout((function(){n.onError("number"==typeof t.status?t.status:0)}),0))},l("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout((function(){n.onError(e)}),0)}"undefined"!=typeof document&&(this.index=h.requestsCount++,h.requests[this.index]=this)}onSuccess(){this.emit("success"),this.cleanup()}onData(e){this.emit("data",e),this.onSuccess()}onError(e){this.emit("error",e),this.cleanup(!0)}cleanup(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=c:this.xhr.onreadystatechange=c,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete h.requests[this.index],this.xhr=null}}onLoad(){const e=this.xhr.responseText;null!==e&&this.onData(e)}hasXDR(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR}abort(){this.cleanup()}}function p(){for(let e in h.requests)h.requests.hasOwnProperty(e)&&h.requests[e].abort()}h.requestsCount=0,h.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",p):"function"==typeof addEventListener&&addEventListener("onpagehide"in s?"pagehide":"unload",p,!1)),e.exports=class extends o{constructor(e){if(super(e),"undefined"!=typeof location){const t="https:"===location.protocol;let n=location.port;n||(n=t?443:80),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==t}const t=e&&e.forceBase64;this.supportsBinary=u&&!t}request(e={}){return Object.assign(e,{supportsBinary:this.supportsBinary,xd:this.xd,xs:this.xs},this.opts),new h(this.uri(),e)}doWrite(e,t){const n="string"!=typeof e&&void 0!==e,r=this.request({method:"POST",data:e,isBinary:n}),o=this;r.on("success",t),r.on("error",(function(e){o.onError("xhr post error",e)}))}doPoll(){l("xhr poll");const e=this.request(),t=this;e.on("data",(function(e){t.onData(e)})),e.on("error",(function(e){t.onError("xhr poll error",e)})),this.pollXhr=e}},e.exports.Request=h},9015:(e,t,n)=>{const r=n(6496),o=n(1830),a=n(9743),i=n(2281),s=n(4802)("engine.io-client:polling");e.exports=class extends r{get name(){return"polling"}doOpen(){this.poll()}pause(e){const t=this;function n(){s("paused"),t.readyState="paused",e()}if(this.readyState="pausing",this.polling||!this.writable){let e=0;this.polling&&(s("we are currently polling - waiting to pause"),e++,this.once("pollComplete",(function(){s("pre-pause polling complete"),--e||n()}))),this.writable||(s("we are currently writing - waiting to pause"),e++,this.once("drain",(function(){s("pre-pause writing complete"),--e||n()})))}else n()}poll(){s("polling"),this.polling=!0,this.doPoll(),this.emit("poll")}onData(e){const t=this;s("polling got data %s",e),a.decodePayload(e,this.socket.binaryType).forEach((function(e,n,r){if("opening"===t.readyState&&t.onOpen(),"close"===e.type)return t.onClose(),!1;t.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():s('ignoring poll - transport state "%s"',this.readyState))}doClose(){const e=this;function t(){s("writing close packet"),e.write([{type:"close"}])}"open"===this.readyState?(s("transport open - closing"),t()):(s("transport not open - deferring close"),this.once("open",t))}write(e){this.writable=!1,a.encodePayload(e,(e=>{this.doWrite(e,(()=>{this.writable=!0,this.emit("drain")}))}))}uri(){let e=this.query||{};const t=this.opts.secure?"https":"http";let n="";return!1!==this.opts.timestampRequests&&(e[this.opts.timestampParam]=i()),this.supportsBinary||e.sid||(e.b64=1),e=o.encode(e),this.opts.port&&("https"===t&&443!==Number(this.opts.port)||"http"===t&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),e.length&&(e="?"+e),t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+e}}},866:(e,t,n)=>{const r=n(3549);e.exports={WebSocket:r.WebSocket||r.MozWebSocket,usingBrowserWebSocket:!0,defaultBinaryType:"arraybuffer"}},4442:(e,t,n)=>{const r=n(6496),o=n(9743),a=n(1830),i=n(2281),{pick:s}=n(6839),{WebSocket:l,usingBrowserWebSocket:c,defaultBinaryType:u}=n(866),h=n(4802)("engine.io-client:websocket"),p="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class d extends r{constructor(e){super(e),e&&e.forceBase64&&(this.supportsBinary=!1),this.supportsBinary=!0}get name(){return"websocket"}doOpen(){if(!this.check())return;const e=this.uri(),t=this.opts.protocols;let n;n=p?s(this.opts,"localAddress"):s(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress"),this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=c&&!p?t?new l(e,t):new l(e):new l(e,t,n)}catch(e){return this.emit("error",e)}this.ws.binaryType=this.socket.binaryType||u,this.addEventListeners()}addEventListeners(){const e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}}write(e){const t=this;this.writable=!1;let n=e.length,r=0;const a=n;for(;r<a;r++)!function(e){o.encodePacket(e,t.supportsBinary,(function(r){const o={};!c&&(e.options&&(o.compress=e.options.compress),t.opts.perMessageDeflate)&&("string"==typeof r?Buffer.byteLength(r):r.length)<t.opts.perMessageDeflate.threshold&&(o.compress=!1);try{c?t.ws.send(r):t.ws.send(r,o)}catch(e){h("websocket closed before onclose event")}--n||(t.emit("flush"),setTimeout((function(){t.writable=!0,t.emit("drain")}),0))}))}(e[r])}onClose(){r.prototype.onClose.call(this)}doClose(){void 0!==this.ws&&this.ws.close()}uri(){let e=this.query||{};const t=this.opts.secure?"wss":"ws";let n="";return this.opts.port&&("wss"===t&&443!==Number(this.opts.port)||"ws"===t&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=i()),this.supportsBinary||(e.b64=1),e=a.encode(e),e.length&&(e="?"+e),t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+e}check(){return!(!l||"__initialize"in l&&this.name===d.prototype.name)}}e.exports=d},6839:e=>{e.exports.pick=(e,...t)=>t.reduce(((t,n)=>(t[n]=e[n],t)),{})},2777:(e,t,n)=>{const r=n(8058),o=n(3549);e.exports=function(e){const t=e.xdomain,n=e.xscheme,a=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||r))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&a)return new XDomainRequest}catch(e){}if(!t)try{return new(o[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}},4802:(e,t,n)=>{t.log=function(...e){return"object"==typeof console&&console.log&&console.log(...e)},t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(o=r))})),t.splice(o,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=n(804)(t);const{formatters:r}=e.exports;r.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},804:(e,t,n)=>{e.exports=function(e){function t(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return r.colors[Math.abs(t)%r.colors.length]}function r(e){let n;function i(...e){if(!i.enabled)return;const t=i,o=Number(new Date),a=o-(n||o);t.diff=a,t.prev=n,t.curr=o,n=o,e[0]=r.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,o)=>{if("%%"===n)return n;s++;const a=r.formatters[o];if("function"==typeof a){const r=e[s];n=a.call(t,r),e.splice(s,1),s--}return n})),r.formatArgs.call(t,e),(t.log||r.log).apply(t,e)}return i.namespace=e,i.enabled=r.enabled(e),i.useColors=r.useColors(),i.color=t(e),i.destroy=o,i.extend=a,"function"==typeof r.init&&r.init(i),r.instances.push(i),i}function o(){const e=r.instances.indexOf(this);return-1!==e&&(r.instances.splice(e,1),!0)}function a(e,t){const n=r(this.namespace+(void 0===t?":":t)+e);return n.log=this.log,n}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return r.debug=r,r.default=r,r.coerce=function(e){return e instanceof Error?e.stack||e.message:e},r.disable=function(){const e=[...r.names.map(i),...r.skips.map(i).map((e=>"-"+e))].join(",");return r.enable(""),e},r.enable=function(e){let t;r.save(e),r.names=[],r.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),o=n.length;for(t=0;t<o;t++)n[t]&&("-"===(e=n[t].replace(/\*/g,".*?"))[0]?r.skips.push(new RegExp("^"+e.substr(1)+"$")):r.names.push(new RegExp("^"+e+"$")));for(t=0;t<r.instances.length;t++){const e=r.instances[t];e.enabled=r.enabled(e.namespace)}},r.enabled=function(e){if("*"===e[e.length-1])return!0;let t,n;for(t=0,n=r.skips.length;t<n;t++)if(r.skips[t].test(e))return!1;for(t=0,n=r.names.length;t<n;t++)if(r.names[t].test(e))return!0;return!1},r.humanize=n(7824),Object.keys(e).forEach((t=>{r[t]=e[t]})),r.instances=[],r.names=[],r.skips=[],r.formatters={},r.selectColor=t,r.enable(r.load()),r}},1712:e=>{const t=Object.create(null);t.open="0",t.close="1",t.ping="2",t.pong="3",t.message="4",t.upgrade="5",t.noop="6";const n=Object.create(null);Object.keys(t).forEach((e=>{n[t[e]]=e})),e.exports={PACKET_TYPES:t,PACKET_TYPES_REVERSE:n,ERROR_PACKET:{type:"error",data:"parser error"}}},4965:(e,t,n)=>{const{PACKET_TYPES_REVERSE:r,ERROR_PACKET:o}=n(1712);let a;"function"==typeof ArrayBuffer&&(a=n(3704));const i=(e,t)=>{if(a){const n=a.decode(e);return s(n,t)}return{base64:!0,data:e}},s=(e,t)=>{switch(t){case"blob":return e instanceof ArrayBuffer?new Blob([e]):e;case"arraybuffer":default:return e}};e.exports=(e,t)=>{if("string"!=typeof e)return{type:"message",data:s(e,t)};const n=e.charAt(0);return"b"===n?{type:"message",data:i(e.substring(1),t)}:r[n]?e.length>1?{type:r[n],data:e.substring(1)}:{type:r[n]}:o}},2929:(e,t,n)=>{const{PACKET_TYPES:r}=n(1712),o="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),a="function"==typeof ArrayBuffer,i=(e,t)=>{const n=new FileReader;return n.onload=function(){const e=n.result.split(",")[1];t("b"+e)},n.readAsDataURL(e)};e.exports=({type:e,data:t},n,s)=>{return o&&t instanceof Blob?n?s(t):i(t,s):a&&(t instanceof ArrayBuffer||(l=t,"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(l):l&&l.buffer instanceof ArrayBuffer))?n?s(t instanceof ArrayBuffer?t:t.buffer):i(new Blob([t]),s):s(r[e]+(t||""));var l}},9743:(e,t,n)=>{const r=n(2929),o=n(4965),a=String.fromCharCode(30);e.exports={protocol:4,encodePacket:r,encodePayload:(e,t)=>{const n=e.length,o=new Array(n);let i=0;e.forEach(((e,s)=>{r(e,!1,(e=>{o[s]=e,++i===n&&t(o.join(a))}))}))},decodePacket:o,decodePayload:(e,t)=>{const n=e.split(a),r=[];for(let e=0;e<n.length;e++){const a=o(n[e],t);if(r.push(a),"error"===a.type)break}return r}}},8058:e=>{try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},7824:e=>{var t=1e3,n=60*t,r=60*n,o=24*r;function a(e,t,n,r){var o=t>=1.5*n;return Math.round(e/n)+" "+r+(o?"s":"")}e.exports=function(e,i){i=i||{};var s,l,c=typeof e;if("string"===c&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(a){var i=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*i;case"weeks":case"week":case"w":return 6048e5*i;case"days":case"day":case"d":return i*o;case"hours":case"hour":case"hrs":case"hr":case"h":return i*r;case"minutes":case"minute":case"mins":case"min":case"m":return i*n;case"seconds":case"second":case"secs":case"sec":case"s":return i*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i;default:return}}}}(e);if("number"===c&&isFinite(e))return i.long?(s=e,(l=Math.abs(s))>=o?a(s,l,o,"day"):l>=r?a(s,l,r,"hour"):l>=n?a(s,l,n,"minute"):l>=t?a(s,l,t,"second"):s+" ms"):function(e){var a=Math.abs(e);return a>=o?Math.round(e/o)+"d":a>=r?Math.round(e/r)+"h":a>=n?Math.round(e/n)+"m":a>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},1830:(e,t)=>{t.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){for(var t={},n=e.split("&"),r=0,o=n.length;r<o;r++){var a=n[r].split("=");t[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return t}},4187:e=>{var t=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,n=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var r,o,a=e,i=e.indexOf("["),s=e.indexOf("]");-1!=i&&-1!=s&&(e=e.substring(0,i)+e.substring(i,s).replace(/:/g,";")+e.substring(s,e.length));for(var l,c,u=t.exec(e||""),h={},p=14;p--;)h[n[p]]=u[p]||"";return-1!=i&&-1!=s&&(h.source=a,h.host=h.host.substring(1,h.host.length-1).replace(/;/g,":"),h.authority=h.authority.replace("[","").replace("]","").replace(/;/g,":"),h.ipv6uri=!0),h.pathNames=(r=h.path,o=r.replace(/\/{2,9}/g,"/").split("/"),"/"!=r.substr(0,1)&&0!==r.length||o.splice(0,1),"/"==r.substr(r.length-1,1)&&o.splice(o.length-1,1),o),h.queryKey=(l=h.query,c={},l.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,n){t&&(c[t]=n)})),c),h}},751:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Socket=t.io=t.Manager=t.protocol=void 0;const r=n(6744),o=n(7703),a=n(2277);Object.defineProperty(t,"Socket",{enumerable:!0,get:function(){return a.Socket}});const i=n(3669)("socket.io-client");e.exports=t=l;const s=t.managers={};function l(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};const n=r.url(e),a=n.source,l=n.id,c=n.path,u=s[l]&&c in s[l].nsps;let h;return t.forceNew||t["force new connection"]||!1===t.multiplex||u?(i("ignoring socket cache for %s",a),h=new o.Manager(a,t)):(s[l]||(i("new io instance for %s",a),s[l]=new o.Manager(a,t)),h=s[l]),n.query&&!t.query&&(t.query=n.query),h.socket(n.path,t)}t.io=l;var c=n(5485);Object.defineProperty(t,"protocol",{enumerable:!0,get:function(){return c.protocol}}),t.connect=l;var u=n(7703);Object.defineProperty(t,"Manager",{enumerable:!0,get:function(){return u.Manager}})},7703:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Manager=void 0;const r=n(5983),o=n(2277),a=n(8767),i=n(5485),s=n(5657),l=n(6077),c=n(3010),u=n(3669)("socket.io-client:manager");t.Manager=class extends a{constructor(e,t){super(),this.nsps={},this.subs=[],this.connecting=[],e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new c({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=e;const n=t.parser||i;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this)}randomizationFactor(e){return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this)}reconnectionDelayMax(e){return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(u("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;u("opening %s",this.uri),this.engine=r(this.uri,this.opts);const t=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const o=s.on(t,"open",(function(){n.onopen(),e&&e()})),a=s.on(t,"error",(t=>{u("error"),n.cleanup(),n._readyState="closed",super.emit("error",t),e?e(t):n.maybeReconnectOnOpen()}));if(!1!==this._timeout){const e=this._timeout;u("connect attempt will timeout after %d",e),0===e&&o.destroy();const n=setTimeout((()=>{u("connect attempt timed out after %d",e),o.destroy(),t.close(),t.emit("error",new Error("timeout"))}),e);this.subs.push({destroy:function(){clearTimeout(n)}})}return this.subs.push(o),this.subs.push(a),this}connect(e){return this.open(e)}onopen(){u("open"),this.cleanup(),this._readyState="open",super.emit("open");const e=this.engine;this.subs.push(s.on(e,"data",l(this,"ondata"))),this.subs.push(s.on(e,"ping",l(this,"onping"))),this.subs.push(s.on(e,"error",l(this,"onerror"))),this.subs.push(s.on(e,"close",l(this,"onclose"))),this.subs.push(s.on(this.decoder,"decoded",l(this,"ondecoded")))}onping(){super.emit("ping")}ondata(e){this.decoder.add(e)}ondecoded(e){super.emit("packet",e)}onerror(e){u("error",e),super.emit("error",e)}socket(e,t){let n=this.nsps[e];if(!n){n=new o.Socket(this,e,t),this.nsps[e]=n;var r=this;n.on("connecting",a),this._autoConnect&&a()}function a(){~r.connecting.indexOf(n)||r.connecting.push(n)}return n}_destroy(e){const t=this.connecting.indexOf(e);~t&&this.connecting.splice(t,1),this.connecting.length||this._close()}_packet(e){u("writing packet %j",e),e.query&&0===e.type&&(e.nsp+="?"+e.query);const t=this.encoder.encode(e);for(let n=0;n<t.length;n++)this.engine.write(t[n],e.options)}cleanup(){u("cleanup");const e=this.subs.length;for(let t=0;t<e;t++)this.subs.shift().destroy();this.decoder.destroy()}_close(){u("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,"opening"===this._readyState&&this.cleanup(),this.backoff.reset(),this._readyState="closed",this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e){u("onclose"),this.cleanup(),this.backoff.reset(),this._readyState="closed",super.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)u("reconnect failed"),this.backoff.reset(),super.emit("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();u("will wait %dms before reconnect attempt",t),this._reconnecting=!0;const n=setTimeout((()=>{e.skipReconnect||(u("attempting reconnect"),super.emit("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open((t=>{t?(u("reconnect attempt error"),e._reconnecting=!1,e.reconnect(),super.emit("reconnect_error",t)):(u("reconnect success"),e.onreconnect())})))}),t);this.subs.push({destroy:function(){clearTimeout(n)}})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),super.emit("reconnect",e)}}},5657:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.on=void 0,t.on=function(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}},2277:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Socket=void 0;const r=n(5485),o=n(8767),a=n(5657),i=n(6077),s=n(3669)("socket.io-client:socket"),l={connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1};t.Socket=class extends o{constructor(e,t,n){super(),this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.flags={},this.io=e,this.nsp=t,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.auth&&(this.auth=n.auth),this.io._autoConnect&&this.open()}subEvents(){if(this.subs)return;const e=this.io;this.subs=[a.on(e,"open",i(this,"onopen")),a.on(e,"packet",i(this,"onpacket")),a.on(e,"close",i(this,"onclose"))]}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(l.hasOwnProperty(e))throw new Error('"'+e+'" is a reserved event name');t.unshift(e);const n={type:r.PacketType.EVENT,data:t,options:{}};n.options.compress=!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(s("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),n.id=this.ids++);const o=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return!this.flags.volatile||o&&this.connected?this.connected?this.packet(n):this.sendBuffer.push(n):s("discard packet as the transport is not currently writable"),this.flags={},this}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){s("transport is open - connecting"),"function"==typeof this.auth?this.auth((e=>{this.packet({type:r.PacketType.CONNECT,data:e})})):this.packet({type:r.PacketType.CONNECT,data:this.auth})}onclose(e){s("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,super.emit("disconnect",e)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case r.PacketType.CONNECT:const t=e.data.sid;this.onconnect(t);break;case r.PacketType.EVENT:case r.PacketType.BINARY_EVENT:this.onevent(e);break;case r.PacketType.ACK:case r.PacketType.BINARY_ACK:this.onack(e);break;case r.PacketType.DISCONNECT:this.ondisconnect();break;case r.PacketType.CONNECT_ERROR:const n=new Error(e.data.message);n.data=e.data.data,super.emit("connect_error",n)}}onevent(e){const t=e.data||[];s("emitting event %j",t),null!=e.id&&(s("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?this.emitEvent(t):this.receiveBuffer.push(t)}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const n of t)n.apply(this,e)}super.emit.apply(this,e)}ack(e){const t=this;let n=!1;return function(...o){n||(n=!0,s("sending ack %j",o),t.packet({type:r.PacketType.ACK,id:e,data:o}))}}onack(e){const t=this.acks[e.id];"function"==typeof t?(s("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):s("bad ack %s",e.id)}onconnect(e){this.id=e,this.connected=!0,this.disconnected=!1,super.emit("connect"),this.emitBuffered()}emitBuffered(){for(let e=0;e<this.receiveBuffer.length;e++)this.emitEvent(this.receiveBuffer[e]);this.receiveBuffer=[];for(let e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]}ondisconnect(){s("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){if(this.subs){for(let e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io._destroy(this)}disconnect(){return this.connected&&(s("performing disconnect (%s)",this.nsp),this.packet({type:r.PacketType.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}}},6744:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.url=void 0;const r=n(4187),o=n(3669)("socket.io-client:url");t.url=function(e,t){let n=e;t=t||"undefined"!=typeof location&&location,null==e&&(e=t.protocol+"//"+t.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(o("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),o("parse %s",e),n=r(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const a=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+a+":"+n.port,n.href=n.protocol+"://"+a+(t&&t.port===n.port?"":":"+n.port),n}},3669:(e,t,n)=>{t.log=function(...e){return"object"==typeof console&&console.log&&console.log(...e)},t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(o=r))})),t.splice(o,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=n(9231)(t);const{formatters:r}=e.exports;r.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},9231:(e,t,n)=>{e.exports=function(e){function t(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return r.colors[Math.abs(t)%r.colors.length]}function r(e){let n;function i(...e){if(!i.enabled)return;const t=i,o=Number(new Date),a=o-(n||o);t.diff=a,t.prev=n,t.curr=o,n=o,e[0]=r.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,o)=>{if("%%"===n)return n;s++;const a=r.formatters[o];if("function"==typeof a){const r=e[s];n=a.call(t,r),e.splice(s,1),s--}return n})),r.formatArgs.call(t,e),(t.log||r.log).apply(t,e)}return i.namespace=e,i.enabled=r.enabled(e),i.useColors=r.useColors(),i.color=t(e),i.destroy=o,i.extend=a,"function"==typeof r.init&&r.init(i),r.instances.push(i),i}function o(){const e=r.instances.indexOf(this);return-1!==e&&(r.instances.splice(e,1),!0)}function a(e,t){const n=r(this.namespace+(void 0===t?":":t)+e);return n.log=this.log,n}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return r.debug=r,r.default=r,r.coerce=function(e){return e instanceof Error?e.stack||e.message:e},r.disable=function(){const e=[...r.names.map(i),...r.skips.map(i).map((e=>"-"+e))].join(",");return r.enable(""),e},r.enable=function(e){let t;r.save(e),r.names=[],r.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),o=n.length;for(t=0;t<o;t++)n[t]&&("-"===(e=n[t].replace(/\*/g,".*?"))[0]?r.skips.push(new RegExp("^"+e.substr(1)+"$")):r.names.push(new RegExp("^"+e+"$")));for(t=0;t<r.instances.length;t++){const e=r.instances[t];e.enabled=r.enabled(e.namespace)}},r.enabled=function(e){if("*"===e[e.length-1])return!0;let t,n;for(t=0,n=r.skips.length;t<n;t++)if(r.skips[t].test(e))return!1;for(t=0,n=r.names.length;t<n;t++)if(r.names[t].test(e))return!0;return!1},r.humanize=n(7824),Object.keys(e).forEach((t=>{r[t]=e[t]})),r.instances=[],r.names=[],r.skips=[],r.formatters={},r.selectColor=t,r.enable(r.load()),r}},7719:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reconstructPacket=t.deconstructPacket=void 0;const r=n(2986);function o(e,t){if(!e)return e;if(r.isBinary(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}if(Array.isArray(e)){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=o(e[r],t);return n}if("object"==typeof e&&!(e instanceof Date)){const n={};for(const r in e)e.hasOwnProperty(r)&&(n[r]=o(e[r],t));return n}return e}function a(e,t){if(!e)return e;if(e&&e._placeholder)return t[e.num];if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=a(e[n],t);else if("object"==typeof e)for(const n in e)e.hasOwnProperty(n)&&(e[n]=a(e[n],t));return e}t.deconstructPacket=function(e){const t=[],n=e.data,r=e;return r.data=o(n,t),r.attachments=t.length,{packet:r,buffers:t}},t.reconstructPacket=function(e,t){return e.data=a(e.data,t),e.attachments=void 0,e}},5485:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Decoder=t.Encoder=t.PacketType=t.protocol=void 0;const r=n(8767),o=n(7719),a=n(2986),i=n(1618)("socket.io-parser");var s;t.protocol=5,function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(s=t.PacketType||(t.PacketType={})),t.Encoder=class{encode(e){return i("encoding packet %j",e),e.type!==s.EVENT&&e.type!==s.ACK||!a.hasBinary(e)?[this.encodeAsString(e)]:(e.type=e.type===s.EVENT?s.BINARY_EVENT:s.BINARY_ACK,this.encodeAsBinary(e))}encodeAsString(e){let t=""+e.type;return e.type!==s.BINARY_EVENT&&e.type!==s.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data)),i("encoded %j as %s",e,t),t}encodeAsBinary(e){const t=o.deconstructPacket(e),n=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(n),r}};class l extends r{constructor(){super()}add(e){let t;if("string"==typeof e)t=this.decodeString(e),t.type===s.BINARY_EVENT||t.type===s.BINARY_ACK?(this.reconstructor=new c(t),0===t.attachments&&super.emit("decoded",t)):super.emit("decoded",t);else{if(!a.isBinary(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emit("decoded",t))}}decodeString(e){let t=0;const n={type:Number(e.charAt(0))};if(void 0===s[n.type])throw new Error("unknown packet type "+n.type);if(n.type===s.BINARY_EVENT||n.type===s.BINARY_ACK){const r=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);const o=e.substring(r,t);if(o!=Number(o)||"-"!==e.charAt(t))throw new Error("Illegal attachments");n.attachments=Number(o)}if("/"===e.charAt(t+1)){const r=t+1;for(;++t&&","!==e.charAt(t)&&t!==e.length;);n.nsp=e.substring(r,t)}else n.nsp="/";const r=e.charAt(t+1);if(""!==r&&Number(r)==r){const r=t+1;for(;++t;){const n=e.charAt(t);if(null==n||Number(n)!=n){--t;break}if(t===e.length)break}n.id=Number(e.substring(r,t+1))}if(e.charAt(++t)){const r=function(e){try{return JSON.parse(e)}catch(e){return!1}}(e.substr(t));if(!l.isPayloadValid(n.type,r))throw new Error("invalid payload");n.data=r}return i("decoded %s as %j",e,n),n}static isPayloadValid(e,t){switch(e){case s.CONNECT:return"object"==typeof t;case s.DISCONNECT:return void 0===t;case s.CONNECT_ERROR:return"string"==typeof t||"object"==typeof t;case s.EVENT:case s.BINARY_EVENT:return Array.isArray(t)&&"string"==typeof t[0];case s.ACK:case s.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}t.Decoder=l;class c{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const e=o.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}},2986:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hasBinary=t.isBinary=void 0;const n="function"==typeof ArrayBuffer,r=Object.prototype.toString,o="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===r.call(Blob),a="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===r.call(File);function i(e){return n&&(e instanceof ArrayBuffer||(e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer)(e))||o&&e instanceof Blob||a&&e instanceof File}t.isBinary=i,t.hasBinary=function e(t,n){if(!t||"object"!=typeof t)return!1;if(Array.isArray(t)){for(let n=0,r=t.length;n<r;n++)if(e(t[n]))return!0;return!1}if(i(t))return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return e(t.toJSON(),!0);for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e(t[n]))return!0;return!1}},1618:(e,t,n)=>{t.log=function(...e){return"object"==typeof console&&console.log&&console.log(...e)},t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(o=r))})),t.splice(o,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=n(5224)(t);const{formatters:r}=e.exports;r.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},5224:(e,t,n)=>{e.exports=function(e){function t(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return r.colors[Math.abs(t)%r.colors.length]}function r(e){let n;function i(...e){if(!i.enabled)return;const t=i,o=Number(new Date),a=o-(n||o);t.diff=a,t.prev=n,t.curr=o,n=o,e[0]=r.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,o)=>{if("%%"===n)return n;s++;const a=r.formatters[o];if("function"==typeof a){const r=e[s];n=a.call(t,r),e.splice(s,1),s--}return n})),r.formatArgs.call(t,e),(t.log||r.log).apply(t,e)}return i.namespace=e,i.enabled=r.enabled(e),i.useColors=r.useColors(),i.color=t(e),i.destroy=o,i.extend=a,"function"==typeof r.init&&r.init(i),r.instances.push(i),i}function o(){const e=r.instances.indexOf(this);return-1!==e&&(r.instances.splice(e,1),!0)}function a(e,t){const n=r(this.namespace+(void 0===t?":":t)+e);return n.log=this.log,n}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return r.debug=r,r.default=r,r.coerce=function(e){return e instanceof Error?e.stack||e.message:e},r.disable=function(){const e=[...r.names.map(i),...r.skips.map(i).map((e=>"-"+e))].join(",");return r.enable(""),e},r.enable=function(e){let t;r.save(e),r.names=[],r.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),o=n.length;for(t=0;t<o;t++)n[t]&&("-"===(e=n[t].replace(/\*/g,".*?"))[0]?r.skips.push(new RegExp("^"+e.substr(1)+"$")):r.names.push(new RegExp("^"+e+"$")));for(t=0;t<r.instances.length;t++){const e=r.instances[t];e.enabled=r.enabled(e.namespace)}},r.enabled=function(e){if("*"===e[e.length-1])return!0;let t,n;for(t=0,n=r.skips.length;t<n;t++)if(r.skips[t].test(e))return!1;for(t=0,n=r.names.length;t<n;t++)if(r.names[t].test(e))return!0;return!1},r.humanize=n(7824),Object.keys(e).forEach((t=>{r[t]=e[t]})),r.instances=[],r.names=[],r.skips=[],r.formatters={},r.selectColor=t,r.enable(r.load()),r}},291:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.astar=void 0,function(e){var t;!function(e){e[e.WALL=0]="WALL",e[e.OPEN=1]="OPEN"}(t=e.GraphNodeType||(e.GraphNodeType={}));var n=function(){function e(e){this.elements=e;for(var t,n,o=[],a=e.length,i=0;i<a;++i){n=(t=e[i]).length,o[i]=new Array(n);for(var s=0;s<n;++s)o[i][s]=new r(i,s,t[s])}this.nodes=o}return e.prototype.toString=function(){for(var e,t,n,r,o="\n",a=this.nodes,i=0,s=a.length;i<s;){for(e="",n=0,r=(t=a[i++]).length;n<r;)e+=t[n++].type+" ";o=o+e+"\n"}return o},e}();e.Graph=n;var r=function(){function e(e,t,n){this.data={},this.x=e,this.y=t,this.pos={x:e,y:t},this.type=n}return e.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},e.prototype.isWall=function(){return this.type==t.WALL},e}();e.GraphNode=r;var o=function(){function e(e){this.content=[],this.scoreFunction=e}return e.prototype.push=function(e){this.content.push(e),this.sinkDown(this.content.length-1)},e.prototype.pop=function(){var e=this.content[0],t=this.content.pop();return this.content.length>0&&(this.content[0]=t,this.bubbleUp(0)),e},e.prototype.remove=function(e){var t=this.content.indexOf(e),n=this.content.pop();t!==this.content.length-1&&(this.content[t]=n,this.scoreFunction(n)<this.scoreFunction(e)?this.sinkDown(t):this.bubbleUp(t))},e.prototype.size=function(){return this.content.length},e.prototype.rescoreElement=function(e){this.sinkDown(this.content.indexOf(e))},e.prototype.sinkDown=function(e){for(var t=this.content[e];e>0;){var n=(e+1>>1)-1,r=this.content[n];if(!(this.scoreFunction(t)<this.scoreFunction(r)))break;this.content[n]=t,this.content[e]=r,e=n}},e.prototype.bubbleUp=function(e){for(var t=this.content.length,n=this.content[e],r=this.scoreFunction(n);;){var o=e+1<<1,a=o-1,i=null;if(a<t){var s=this.content[a],l=this.scoreFunction(s);l<r&&(i=a)}if(o<t){var c=this.content[o];this.scoreFunction(c)<(null===i?r:l)&&(i=o)}if(null===i)break;this.content[e]=this.content[i],this.content[i]=n,e=i}},e}();e.BinaryHeap=o;var a=function(){function e(e,t,n){this.grid=[];for(var r=0,o=e.length;r<o;r++){this.grid[r]=[];for(var a=0,i=e[r].length;a<i;a++){var s=e[r][a].isSolid()?99999999:1;this.grid[r][a]={org:e[r][a],f:0,g:0,h:0,cost:s,visited:!1,closed:!1,pos:{x:r,y:a},parent:null}}}if(void 0!==t)for(var l=0;l<t.length;l++)this.grid[t[l].x][t[l].y].cost=99999999}return e.prototype.heap=function(){return new o((function(e){return e.f}))},e.prototype._find=function(e){for(var t=0;t<this.grid.length;t++)for(var n=0;n<this.grid[t].length;n++)if(this.grid[t][n].org==e)return this.grid[t][n]},e.prototype._search=function(t,n,r,o){o=o||this.manhattan,r=!!r;var a,i,s=this.heap();if(a=void 0!==t.x&&void 0!==t.y?this.grid[t.x][t.y]:this._find(t),i=void 0!==n.x&&void 0!==n.y?this.grid[n.x][n.y]:this._find(n),0==e.NO_CHECK_START_POINT&&a.cost<=0)return[];for(s.push(a);s.size()>0;){var l=s.pop();if(l===i){for(var c=l,u=[];c.parent;)u.push(c),c=c.parent;return u.reverse()}l.closed=!0;for(var h=this.neighbors(l,r),p=0,d=h.length;p<d;p++){var f=h[p];if(!(f.closed||f.cost<=0)){var m=l.g+f.cost,y=f.visited;(!y||m<f.g)&&(f.visited=!0,f.parent=l,f.h=f.h||o(f.pos,i.pos),f.g=m,f.f=f.g+f.h,y?s.rescoreElement(f):s.push(f))}}}return[]},e.search=function(t,n,r,o,a,i){return new e(t,o)._search(n,r,a,i)},e.prototype.manhattan=function(e,t){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)},e.prototype.neighbors=function(e,t){var n=this.grid,r=[],o=e.pos.x,a=e.pos.y;return n[o-1]&&n[o-1][a]&&r.push(n[o-1][a]),n[o+1]&&n[o+1][a]&&r.push(n[o+1][a]),n[o]&&n[o][a-1]&&r.push(n[o][a-1]),n[o]&&n[o][a+1]&&r.push(n[o][a+1]),t&&(n[o-1]&&n[o-1][a-1]&&r.push(n[o-1][a-1]),n[o+1]&&n[o+1][a-1]&&r.push(n[o+1][a-1]),n[o-1]&&n[o-1][a+1]&&r.push(n[o-1][a+1]),n[o+1]&&n[o+1][a+1]&&r.push(n[o+1][a+1])),r},e.NO_CHECK_START_POINT=!1,e}();e.AStar=a}(t.astar||(t.astar={}))},6779:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Drawable=void 0;t.Drawable=function(){this.drawableY=0,this.draw=function(){}}},6750:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Barrel=void 0;var a=n(1272),i=n(2967),s=n(2621),l=function(e){function t(t,n,r,o){var a=e.call(this,t,n,r,o)||this;return a.kill=function(){a.dead=!0,s.GenericParticle.spawnCluster(a.level,a.x+.5,a.y+.5,"#9badb7")},a.killNoBones=function(){a.kill()},a.draw=function(){a.dead||i.Game.drawObj(a.tileX,a.tileY,1,2,a.x-a.drawX,a.y-1-a.drawY,1,2,a.level.shadeColor,a.shadeAmount())},a.drawTopLayer=function(){a.drawableY=a.y-a.drawY,a.drawX+=-.5*a.drawX,a.drawY+=-.5*a.drawY},a.level=t,a.health=1,a.tileX=1,a.tileY=0,a.hasShadow=!1,a.pushable=!0,a}return o(t,e),t}(a.Enemy);t.Barrel=l},2725:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.ChargeEnemy=t.ChargeEnemyState=void 0;var a,i=n(1272),s=n(2967),l=n(8084),c=n(1978),u=n(9143),h=n(5654),p=n(2621);!function(e){e[e.IDLE=0]="IDLE",e[e.ALERTED=1]="ALERTED",e[e.CHARGING=2]="CHARGING"}(a=t.ChargeEnemyState||(t.ChargeEnemyState={}));var d=function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,o)||this;return i.hit=function(){return.5},i.canMoveOver=function(e,t){for(var n=0,r=i.level.enemies;n<r.length;n++){var o=r[n];if(o!==i&&e===o.x&&t===o.y)return!1}var a=i.level.levelArray[e][t];return!(a.isSolid()||a instanceof u.Door||a instanceof h.BottomDoor)},i.tick=function(){if(!i.dead){if(i.skipNextTurns>0)return void i.skipNextTurns--;if(i.ticks++,i.seenPlayer||i.level.softVis[i.x][i.y]<1)if(i.seenPlayer=!0,i.state===a.IDLE){var e=!1,t=0,n=0;if(i.x===i.game.players[i.game.localPlayerID].x){n=i.y<i.game.players[i.game.localPlayerID].y?1:-1;for(var r=i.y;r!==i.game.players[i.game.localPlayerID].y;r+=n)i.canMoveOver(i.x,r)||(e=!0)}else if(i.y===i.game.players[i.game.localPlayerID].y){t=i.x<i.game.players[i.game.localPlayerID].x?1:-1;for(var o=i.x;o!==i.game.players[i.game.localPlayerID].x;o+=t)i.canMoveOver(o,i.y)||(e=!0)}if((0!==t||0!==n)&&!e)for(i.state=a.ALERTED,i.targetX=i.x,i.targetY=i.y;i.canMoveOver(i.targetX+t,i.targetY+n);)i.targetX+=t,i.targetY+=n,(i.targetX===i.game.players[i.game.localPlayerID].x&&i.targetY===i.game.players[i.game.localPlayerID].y||i.targetX===i.game.players[i.game.localPlayerID].x-1&&i.targetY===i.game.players[i.game.localPlayerID].y||i.targetX===i.game.players[i.game.localPlayerID].x+1&&i.targetY===i.game.players[i.game.localPlayerID].y||i.targetX===i.game.players[i.game.localPlayerID].x&&i.targetY===i.game.players[i.game.localPlayerID].y-1||i.targetX===i.game.players[i.game.localPlayerID].x&&i.targetY===i.game.players[i.game.localPlayerID].y+1)&&i.level.projectiles.push(new l.HitWarning(i.game,i.targetX,i.targetY))}else i.state===a.ALERTED?(i.state=a.CHARGING,(i.y===i.game.players[i.game.localPlayerID].y&&(i.x<i.game.players[i.game.localPlayerID].x&&i.game.players[i.game.localPlayerID].x<=i.targetX||i.targetX<=i.game.players[i.game.localPlayerID].x&&i.game.players[i.game.localPlayerID].x<i.x)||i.x===i.game.players[i.game.localPlayerID].x&&(i.y<i.game.players[i.game.localPlayerID].y&&i.game.players[i.game.localPlayerID].y<=i.targetY||i.targetY<=i.game.players[i.game.localPlayerID].y&&i.game.players[i.game.localPlayerID].y<i.y))&&i.game.players[i.game.localPlayerID].hurt(.5),i.drawX=i.targetX-i.x,i.drawY=i.targetY-i.y,i.x=i.targetX,i.y=i.targetY):i.state===a.CHARGING&&(i.state=a.IDLE)}},i.draw=function(){i.dead||(i.frame+=.1,i.frame>=4&&(i.frame=0),(i.state===a.CHARGING&&Math.abs(i.drawX)>.1||Math.abs(i.drawY)>.1)&&(p.GenericParticle.spawnCluster(i.level,i.x-i.drawX+.5,i.y-i.drawY+.5,"black"),p.GenericParticle.spawnCluster(i.level,i.x-i.drawX+.5,i.y-i.drawY+.5,"white")),i.hasShadow&&s.Game.drawMob(0,0,1,1,i.x-i.drawX,i.y-i.drawY,1,1,i.level.shadeColor,i.shadeAmount()),s.Game.drawMob(i.tileX,i.tileY,1,2,i.x-i.drawX,i.y-1.5-i.drawY+(4===i.tileX?.1875:0),1,2,i.level.shadeColor,i.shadeAmount()))},i.dropLoot=function(){i.level.items.push(new c.Coin(i.level,i.x,i.y))},i.ticks=0,i.frame=0,i.health=1,i.maxHealth=1,i.tileX=17,i.tileY=8,i.seenPlayer=!0,i.deathParticleColor="#ffffff",i.state=a.IDLE,i}return o(t,e),t}(i.Enemy);t.ChargeEnemy=d},516:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Chest=void 0;var a=n(2967),i=n(1785),s=n(6309),l=n(8573),c=n(1272),u=n(7975),h=n(2621),p=n(1978),d=n(5958),f=function(e){function t(t,n,r,o,c){var f=e.call(this,t,n,r,o)||this;return f.kill=function(){switch(f.level===f.game.level&&d.Sound.chest(),f.dead=!0,h.GenericParticle.spawnCluster(f.level,f.x+.5,f.y+.5,"#fbf236"),a.Game.randTable([1,1,1,2,2,3],f.rand)){case 1:f.level.items.push(new p.Coin(f.level,f.x,f.y));break;case 2:f.level.items.push(new s.Heart(f.level,f.x,f.y));break;case 3:f.level.items.push(new u.GreenGem(f.level,f.x,f.y));break;case 3:f.level.items.push(new i.Key(f.level,f.x,f.y));break;case 4:f.level.items.push(new l.Armor(f.level,f.x,f.y))}},f.killNoBones=function(){f.kill()},f.draw=function(){f.dead||a.Game.drawObj(f.tileX,f.tileY,1,2,f.x-f.drawX,f.y-1-f.drawY,1,2,f.level.shadeColor,f.shadeAmount())},f.drawTopLayer=function(){f.drawableY=f.y},f.tileX=4,f.tileY=0,f.health=1,f.rand=c,f}return o(t,e),t}(c.Enemy);t.Chest=f},8365:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.CoalResource=void 0;var a=n(8576),i=n(2621),s=n(9809),l=n(5958),c=function(e){function t(t,n,r,o){var a=e.call(this,t,n,r,o)||this;return a.hurtCallback=function(){i.GenericParticle.spawnCluster(a.level,a.x+.5,a.y+.5,"#ffffff"),a.level===a.game.level&&l.Sound.mine()},a.kill=function(){a.level===a.game.level&&l.Sound.breakRock(),a.dead=!0,a.level.items.push(new s.Coal(a.level,a.x,a.y))},a.killNoBones=function(){a.kill()},a.drawTopLayer=function(){a.drawableY=a.y},a.tileX=12,a.tileY=0,a.health=1,a}return o(t,e),t}(a.Resource);t.CoalResource=c},6061:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Crate=void 0;var a=n(1272),i=n(2967),s=n(2621),l=function(e){function t(t,n,r,o){var a=e.call(this,t,n,r,o)||this;return a.kill=function(){a.dead=!0,s.GenericParticle.spawnCluster(a.level,a.x+.5,a.y+.5,"#d9a066")},a.killNoBones=function(){a.kill()},a.draw=function(){a.dead||i.Game.drawObj(a.tileX,a.tileY,1,2,a.x-a.drawX,a.y-1-a.drawY,1,2,a.level.shadeColor,a.shadeAmount())},a.drawTopLayer=function(){a.drawableY=a.y-a.drawY,a.drawX+=-.5*a.drawX,a.drawY+=-.5*a.drawY},a.level=t,a.health=1,a.maxHealth=1,a.tileX=0,a.tileY=0,a.hasShadow=!1,a.pushable=!0,a}return o(t,e),t}(a.Enemy);t.Crate=l},9379:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.EmeraldResource=void 0;var a=n(7975),i=n(8576),s=n(2621),l=n(5958),c=function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,o)||this;return i.hurtCallback=function(){s.GenericParticle.spawnCluster(i.level,i.x+.5,i.y+.5,"#fbf236"),i.level===i.game.level&&l.Sound.mine()},i.kill=function(){i.level===i.game.level&&l.Sound.breakRock(),i.dead=!0,i.level.items.push(new a.GreenGem(i.level,i.x,i.y))},i.killNoBones=function(){i.kill()},i.drawTopLayer=function(){i.drawableY=i.y},i.tileX=14,i.tileY=0,i.health=3,i}return o(t,e),t}(i.Resource);t.EmeraldResource=c},1272:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Enemy=t.EnemyDirection=void 0;var a,i=n(2967),s=n(5269),l=n(5440),c=n(9626),u=n(2621),h=n(3338),p=n(6779);!function(e){e[e.DOWN=0]="DOWN",e[e.UP=1]="UP",e[e.RIGHT=2]="RIGHT",e[e.LEFT=3]="LEFT"}(a=t.EnemyDirection||(t.EnemyDirection={}));var d=function(e){function t(t,n,r,o){var p=e.call(this)||this;return p.tryMove=function(e,t){for(var n=0,r=p.level.enemies;n<r.length;n++){var o=r[n];if(o!==p&&o.x===e&&o.y===t)return}for(var a in p.game.players)if(p.game.players[a].x===e&&p.game.players[a].y===t)return;p.level.levelArray[e][t].isSolid()||(p.level.levelArray[e][t].onCollideEnemy(p),p.x=e,p.y=t)},p.hit=function(){return 0},p.hurtCallback=function(){},p.hurt=function(e,t){p.healthBar.hurt(),p.health-=t,p.health<=0?p.kill():p.hurtCallback()},p.interact=function(e){},p.dropLoot=function(){},p.kill=function(){if(p.level.levelArray[p.x][p.y]instanceof c.Floor){var e=new s.Bones(p.level,p.x,p.y);e.skin=p.level.levelArray[p.x][p.y].skin,p.level.levelArray[p.x][p.y]=e}p.dead=!0,u.GenericParticle.spawnCluster(p.level,p.x+.5,p.y+.5,p.deathParticleColor),p.level.particles.push(new l.DeathParticle(p.x,p.y)),p.dropLoot()},p.killNoBones=function(){p.dead=!0,u.GenericParticle.spawnCluster(p.level,p.x+.5,p.y+.5,p.deathParticleColor),p.level.particles.push(new l.DeathParticle(p.x,p.y))},p.shadeAmount=function(){return p.level.softVis[p.x][p.y]},p.doneMoving=function(){return Math.abs(p.drawX)<.01&&Math.abs(p.drawY)<.01},p.nearestPlayer=function(){var e=138291380921,t=e,n=null;for(var r in p.game.players)if(p.game.levels[p.game.players[r].levelID]===p.level){var o=Math.max(Math.abs(p.x-p.game.players[r].x),Math.abs(p.y-p.game.players[r].y));o<t&&(t=o,n=p.game.players[r])}return t!==e&&[t,n]},p.seesPlayer=function(){return Math.abs(p.x-p.game.players[p.game.localPlayerID].x)<=4&&Math.abs(p.y-p.game.players[p.game.localPlayerID].y)<=4},p.facePlayer=function(){var e=p.game.players[p.game.localPlayerID].x-p.x,t=p.game.players[p.game.localPlayerID].y-p.y;Math.abs(e)===Math.abs(t)||(Math.abs(e)>Math.abs(t)?(e>0&&(p.direction=a.RIGHT),e<0&&(p.direction=a.LEFT)):(t>0&&(p.direction=a.DOWN),t<0&&(p.direction=a.UP)))},p.draw=function(){p.dead||(p.hasShadow&&i.Game.drawMob(0,0,1,1,p.x-p.drawX,p.y-p.drawY,1,1,p.level.shadeColor,p.shadeAmount()),i.Game.drawMob(p.tileX,p.tileY+2*p.direction,1,2,p.x-p.drawX,p.y-1.5-p.drawY,1,2,p.level.shadeColor,p.shadeAmount()))},p.tick=function(){},p.drawTopLayer=function(){p.drawableY=p.y-p.drawY,p.healthBar.draw(p.health,p.maxHealth,p.x,p.y,!0),p.drawX+=-.5*p.drawX,p.drawY+=-.5*p.drawY},p.level=t,p.x=r,p.y=o,p.w=1,p.h=1,p.game=n,p.drawX=0,p.drawY=0,p.health=1,p.maxHealth=1,p.tileX=0,p.tileY=0,p.hasShadow=!0,p.skipNextTurns=0,p.direction=a.DOWN,p.destroyable=!0,p.pushable=!1,p.chainPushable=!0,p.interactable=!1,p.deathParticleColor="#ff00ff",p.healthBar=new h.HealthBar,p}return o(t,e),t}(p.Drawable);t.Enemy=d},5377:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.GoldResource=void 0;var a=n(8576),i=n(2621),s=n(9825),l=n(5958),c=function(e){function t(t,n,r,o){var a=e.call(this,t,n,r,o)||this;return a.hurtCallback=function(){a.level===a.game.level&&l.Sound.mine()},a.kill=function(){a.level===a.game.level&&l.Sound.breakRock(),a.dead=!0,a.level.items.push(new s.Gold(a.level,a.x,a.y)),i.GenericParticle.spawnCluster(a.level,a.x+.5,a.y+.5,"#fbf236")},a.killNoBones=function(){a.kill()},a.drawTopLayer=function(){a.drawableY=a.y},a.tileX=13,a.tileY=0,a.health=2,a}return o(t,e),t}(a.Resource);t.GoldResource=c},3441:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.KnightEnemy=void 0;var a=n(1272),i=n(2967),s=n(291),l=n(8084),c=n(3280),u=n(1978),h=n(2920),p=function(e){function t(t,n,r,o,p,d){var f=e.call(this,t,n,r,o)||this;if(f.hurt=function(e,t){e&&(f.targetPlayer=e),f.healthBar.hurt(),f.health-=t,f.health<=0?f.kill():f.hurtCallback()},f.hit=function(){return 1},f.tick=function(){if(!f.dead){if(f.skipNextTurns>0)return void f.skipNextTurns--;if(!f.seenPlayer){var e=f.nearestPlayer();if(!1!==e){var t=e[0],n=e[1];t<4&&(f.seenPlayer=!0,f.targetPlayer=n)}}if(f.seenPlayer&&f.level.playerTicked===f.targetPlayer)if(f.ticks++,f.tileX=9,f.tileY=8,f.ticks%2==0){f.tileX=4,f.tileY=0;for(var r=f.x,o=f.y,i=Array(),u=0,h=f.level.enemies;u<h.length;u++){var p=h[u];p!==f&&i.push({x:p.x,y:p.y})}for(var d=f.x-1;d<=f.x+1;d++)for(var m=f.y-1;m<=f.y+1;m++)f.level.levelArray[d][m]instanceof c.SpikeTrap&&f.level.levelArray[d][m].on&&i.push({x:d,y:m});if(f.moves=s.astar.AStar.search(f.level.levelArray,f,f.targetPlayer,i),f.moves.length>0){var y=!1;for(var v in f.game.players)f.game.levels[f.game.players[v].levelID]===f.level&&f.game.players[v].x===f.moves[0].pos.x&&f.game.players[v].y===f.moves[0].pos.y&&(f.game.players[v].hurt(f.hit()),f.drawX=.5*(f.x-f.game.players[v].x),f.drawY=.5*(f.y-f.game.players[v].y),f.game.players[v]===f.game.players[f.game.localPlayerID]&&f.game.shakeScreen(10*f.drawX,10*f.drawY),y=!0);y||(f.tryMove(f.moves[0].pos.x,f.moves[0].pos.y),f.drawX=f.x-r,f.drawY=f.y-o,f.x>r?f.direction=a.EnemyDirection.RIGHT:f.x<r?f.direction=a.EnemyDirection.LEFT:f.y>o?f.direction=a.EnemyDirection.DOWN:f.y<o&&(f.direction=a.EnemyDirection.UP))}}else f.level.projectiles.push(new l.HitWarning(f.game,f.x-1,f.y)),f.level.projectiles.push(new l.HitWarning(f.game,f.x+1,f.y)),f.level.projectiles.push(new l.HitWarning(f.game,f.x,f.y-1)),f.level.projectiles.push(new l.HitWarning(f.game,f.x,f.y+1))}},f.draw=function(){f.dead||(f.frame+=.1,f.frame>=4&&(f.frame=0),f.hasShadow&&i.Game.drawMob(0,0,1,1,f.x-f.drawX,f.y-f.drawY,1,1,f.level.shadeColor,f.shadeAmount()),i.Game.drawMob(f.tileX+(4===f.tileX?0:Math.floor(f.frame)),f.tileY+2*f.direction,1,2,f.x-f.drawX,f.y-1.5-f.drawY+(4===f.tileX?.1875:0),1,2,f.level.shadeColor,f.shadeAmount()))},f.dropLoot=function(){f.drop.level=f.level,f.drop.x=f.x,f.drop.y=f.y,f.level.items.push(f.drop)},f.moves=new Array,f.ticks=0,f.frame=0,f.health=2,f.maxHealth=2,f.tileX=9,f.tileY=8,f.seenPlayer=!1,f.deathParticleColor="#ffffff",f.rand=p,d)f.drop=d;else{var m=p();f.drop=m<.005?new h.DualDagger(f.level,0,0):new u.Coin(f.level,0,0)}return f}return o(t,e),t}(a.Enemy);t.KnightEnemy=p},9670:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.PottedPlant=void 0;var a=n(1272),i=n(2967),s=n(2621),l=function(e){function t(t,n,r,o){var a=e.call(this,t,n,r,o)||this;return a.kill=function(){a.dead=!0,s.GenericParticle.spawnCluster(a.level,a.x+.5,a.y+.5,"#ce736a")},a.killNoBones=function(){a.kill()},a.draw=function(){a.dead||(a.drawX+=-.5*a.drawX,a.drawY+=-.5*a.drawY,i.Game.drawObj(a.tileX,a.tileY,1,2,a.x-a.drawX,a.y-1-a.drawY,1,2,a.level.shadeColor,a.shadeAmount()))},a.drawTopLayer=function(){a.drawableY=a.y},a.level=t,a.health=1,a.tileX=3,a.tileY=0,a.hasShadow=!1,a.chainPushable=!1,a}return o(t,e),t}(a.Enemy);t.PottedPlant=l},8576:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Resource=void 0;var a=n(2967),i=function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,o)||this;return i.kill=function(){i.dead=!0},i.killNoBones=function(){i.kill()},i.draw=function(){i.dead||a.Game.drawObj(i.tileX,i.tileY,1,2,i.x-i.drawX,i.y-1-i.drawY,1,2,i.level.shadeColor,i.shadeAmount())},i.drawTopLayer=function(){i.drawableY=i.y},i.tileX=12,i.tileY=0,i.health=1,i.chainPushable=!1,i}return o(t,e),t}(n(1272).Enemy);t.Resource=i},8498:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.SkullEnemy=void 0;var a=n(1272),i=n(2967),s=n(8084),l=n(2621),c=n(1978),u=n(5043),h=n(3806),p=function(e){function t(t,n,r,o,p,d){var f=e.call(this,t,n,r,o)||this;if(f.REGEN_TICKS=5,f.hit=function(){return 1},f.hurt=function(e,t){e&&(f.targetPlayer=e),f.ticksSinceFirstHit=0,f.health-=t,f.healthBar.hurt(),f.health<=0?f.kill():l.GenericParticle.spawnCluster(f.level,f.x+.5,f.y+.5,f.deathParticleColor)},f.tick=function(){if(!f.dead){if(f.skipNextTurns>0)return void f.skipNextTurns--;if(f.health<=1)f.ticksSinceFirstHit++,f.ticksSinceFirstHit>=f.REGEN_TICKS&&(f.health=2);else{if(!f.seenPlayer){var e=f.nearestPlayer();if(!1!==e){var t=e[0],n=e[1];t<=4&&(f.targetPlayer=n,f.seenPlayer=!0)}}if(f.seenPlayer&&f.level.playerTicked===f.targetPlayer){var r=f.x,o=f.y;f.targetPlayer.x>f.x&&f.dx++,f.targetPlayer.x<f.x&&f.dx--,f.targetPlayer.y>f.y&&f.dy++,f.targetPlayer.y<f.y&&f.dy--;var i=f.x,l=f.y;for(var c in Math.abs(f.dx)>Math.abs(f.dy)||f.dx===f.dy&&Math.abs(f.targetPlayer.x-f.x)>=Math.abs(f.targetPlayer.y-f.y)?f.dx>0?(i++,f.dx--):f.dx<0&&(i--,f.dx++):f.dy>0?(l++,f.dy--):f.dy<0&&(l--,f.dy++),f.game.players)f.game.levels[f.game.players[c].levelID]===f.level&&f.game.players[c].x===i&&f.game.players[c].y===l&&(f.game.players[c].hurt(f.hit()),f.dx=0,f.dy=0,f.drawX=.5*(f.x-f.game.players[c].x),f.drawY=.5*(f.y-f.game.players[c].y),f.game.players[c]==f.game.players[c]&&f.game.shakeScreen(10*f.drawX,10*f.drawY));f.tryMove(i,l),f.x===r&&f.y===o&&(f.dx=0,f.dy=0),f.drawX=f.x-r,f.drawY=f.y-o,f.x>r?f.direction=a.EnemyDirection.RIGHT:f.x<r?f.direction=a.EnemyDirection.LEFT:f.y>o?f.direction=a.EnemyDirection.DOWN:f.y<o&&(f.direction=a.EnemyDirection.UP),f.level.projectiles.push(new s.HitWarning(f.game,f.x-1,f.y)),f.level.projectiles.push(new s.HitWarning(f.game,f.x+1,f.y)),f.level.projectiles.push(new s.HitWarning(f.game,f.x,f.y-1)),f.level.projectiles.push(new s.HitWarning(f.game,f.x,f.y+1))}}}},f.draw=function(){f.dead||(f.tileX=5,f.tileY=8,f.health<=1&&(f.tileX=3,f.tileY=0,f.ticksSinceFirstHit>=3&&(f.flashingFrame+=.1,Math.floor(f.flashingFrame)%2==0&&(f.tileX=2))),f.frame+=.1,f.frame>=4&&(f.frame=0),f.hasShadow&&i.Game.drawMob(0,0,1,1,f.x-f.drawX,f.y-f.drawY,1,1,f.level.shadeColor,f.shadeAmount()),i.Game.drawMob(f.tileX+(5===f.tileX?Math.floor(f.frame):0),f.tileY+2*f.direction,1,2,f.x-f.drawX,f.y-1.5-f.drawY,1,2,f.level.shadeColor,f.shadeAmount()))},f.dropLoot=function(){f.drop.level=f.level,f.drop.x=f.x,f.drop.y=f.y,f.level.items.push(f.drop)},f.ticks=0,f.frame=0,f.health=2,f.maxHealth=2,f.tileX=5,f.tileY=8,f.seenPlayer=!1,f.ticksSinceFirstHit=0,f.flashingFrame=0,f.dx=0,f.dy=0,f.deathParticleColor="#ffffff",d)f.drop=d;else{var m=p();f.drop=m<.005?new h.Spear(f.level,0,0):m<.04?new u.RedGem(f.level,0,0):new c.Coin(f.level,0,0)}return f}return o(t,e),t}(a.Enemy);t.SkullEnemy=p},1241:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Spawner=void 0;var a=n(1272),i=n(2967),s=n(8498),l=n(209),c=n(8414),u=n(3441),h=n(5397),p=function(e){function t(t,n,r,o,a){var p=e.call(this,t,n,r,o)||this;return p.hit=function(){return 1},p.tick=function(){if(!p.dead){if(p.skipNextTurns>0)return void p.skipNextTurns--;if(p.tileX=6,!p.seenPlayer){var e=p.nearestPlayer();if(!1!==e){var t=e[0];e[1],t<=12&&(p.seenPlayer=!0)}}if(p.seenPlayer&&p.ticks%8==0){p.tileX=7;var n=i.Game.randTable([[-1,-1],[0,-1],[1,-1],[-1,0],[1,0],[-1,1],[0,1],[1,1]],p.rand),r=p.x+n[0],o=p.y+n[1],a=p.x+2*n[0],c=p.y+2*n[1],d=void 0;switch(p.enemySpawnType){case 1:d=new u.KnightEnemy(p.level,p.game,r,o,p.rand);break;case 2:d=new s.SkullEnemy(p.level,p.game,r,o,p.rand);break;case 3:d=new h.WizardEnemy(p.level,p.game,r,o,p.rand)}p.level.projectiles.push(new l.EnemySpawnAnimation(p.level,d,r,o,a,c))}p.ticks++}},p.dropLoot=function(){p.level.items.push(new c.BlueGem(p.level,p.x,p.y))},p.ticks=0,p.health=4,p.maxHealth=4,p.tileX=6,p.tileY=4,p.seenPlayer=!0,p.enemySpawnType=i.Game.randTable([1,1,1,2,2,2,2,3],a),p.deathParticleColor="#ffffff",p.rand=a,p}return o(t,e),t}(a.Enemy);t.Spawner=p},6945:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.VendingMachine=void 0;var a=n(2967),i=n(1272),s=n(1978),l=n(7975),c=n(988),u=n(1656),h=n(8573),p=n(6309),d=n(3806),f=n(9825),m=n(8414),y="white",v=function(e){function t(t,n,r,o,i,v){var g=e.call(this,t,n,r,o)||this;if(g.open=!1,g.openTime=0,g.isInf=!1,g.quantity=1,g.buyAnimAmount=0,g.interact=function(e){(g.isInf||g.quantity>0)&&(g.open&&(g.playerOpened.openVendingMachine=null),g.open=!0,g.playerOpened=e,g.openTime=Date.now(),g.playerOpened.openVendingMachine&&g.playerOpened.openVendingMachine!==g&&g.playerOpened.openVendingMachine.close(),g.playerOpened.openVendingMachine=g)},g.close=function(){g.open=!1,g.playerOpened.openVendingMachine=null},g.space=function(){if(g.open){for(var e=0,t=g.costItems;e<t.length;e++){var n=t[e];if(!g.playerOpened.inventory.hasItemCount(n))return}for(var r=0,o=g.costItems;r<o.length;r++){var i=o[r];g.playerOpened.inventory.subtractItemCount(i)}var s=[g.x-1,g.x+1,g.x],l=[g.y,g.y,g.y+1],c=0;do{c=a.Game.rand(0,s.length-1,g.rand)}while(s[c]===g.playerOpened.x&&l[c]===g.playerOpened.y);var u=new g.item.constructor;u=u.constructor(g.level,s[c],l[c]),g.level.items.push(u),g.isInf||(g.quantity--,g.quantity<=0&&g.close()),g.buyAnimAmount=.99,g.playerOpened===g.game.players[g.game.localPlayerID]&&g.game.shakeScreen(0,4)}},g.draw=function(){var e=19;g.isInf||0!==g.quantity||(e=20),a.Game.drawObj(e,0,1,2,g.x,g.y-1,1,2,g.level.shadeColor,g.shadeAmount())},g.drawTopLayer=function(){if(g.drawableY=g.y-g.drawY,g.open&&g.playerOpened===g.game.players[g.game.localPlayerID]){var e=Math.min(18,18*(Date.now()-g.openTime)/150),t=-2,n=(g.costItems.length+2)*(e+4+t)-t,r=e+4+t-t,o=(g.x+.5)*c.GameConstants.TILESIZE,i=(g.y-1.5)*c.GameConstants.TILESIZE;a.Game.ctx.fillStyle=y,a.Game.ctx.fillRect(Math.round(o-.5*n)-1,Math.round(i-.5*r)-1,Math.round(n+2),Math.round(r+2));for(var s=0;s<g.costItems.length+2;s++)a.Game.ctx.fillStyle="#292c36",a.Game.ctx.fillRect(Math.round(o-.5*n+s*(e+4+t)),Math.round(i-.5*r),Math.round(e+4),Math.round(e+4)),s!==g.costItems.length&&(a.Game.ctx.fillStyle="#5a595b",a.Game.ctx.fillRect(Math.round(o-.5*n+s*(e+4+t)+2),Math.round(i-.5*r+2),Math.round(e),Math.round(e)));if(Date.now()-g.openTime>=150)for(var l=0;l<g.costItems.length+2;l++){var u=Math.round(o-.5*n+l*(e+4+t)+2+Math.floor(.5*e)-.5*c.GameConstants.TILESIZE),h=Math.round(i-.5*r+2+Math.floor(.5*e)-.5*c.GameConstants.TILESIZE),p=u/c.GameConstants.TILESIZE,d=h/c.GameConstants.TILESIZE;if(l<g.costItems.length){var f=1;g.playerOpened.inventory.hasItemCount(g.costItems[l])||(f=.15),g.costItems[l].drawIcon(p,d,f)}else l===g.costItems.length?a.Game.drawFX(0,1,1,1,p,d,1,1):l===g.costItems.length+1&&g.item.drawIcon(p,d)}g.buyAnimAmount*=g.buyAnimAmount,a.Game.ctx.globalAlpha=g.buyAnimAmount,a.Game.ctx.fillStyle=y,a.Game.ctx.fillRect(Math.round(o-.5*n)-1,Math.round(i-.5*r)-1,Math.round(n+2),Math.round(r+2)),a.Game.ctx.globalAlpha=1}},g.rand=v,g.destroyable=!1,g.pushable=!1,g.chainPushable=!1,g.interactable=!0,g.item=i,g.item instanceof u.Shotgun)(_=new m.BlueGem(t,0,0)).stackCount=a.Game.randTable([5,5,6,7],g.rand),g.costItems=[_];else if(g.item instanceof p.Heart){var w=new s.Coin(t,0,0);w.stackCount=10,g.costItems=[w],g.isInf=!0}else if(g.item instanceof d.Spear)(_=new l.GreenGem(t,0,0)).stackCount=a.Game.randTable([5,5,6,7],g.rand),g.costItems=[_];else if(g.item instanceof h.Armor){var _;(_=new f.Gold(t,0,0)).stackCount=a.Game.randTable([5,5,6,7],g.rand),g.costItems=[_]}return g}return o(t,e),t}(i.Enemy);t.VendingMachine=v},5397:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.WizardEnemy=void 0;var a,i=n(1272),s=n(2967),l=n(9626),c=n(5269),u=n(5440),h=n(4568),p=n(5363),d=n(1978),f=n(8414);!function(e){e[e.idle=0]="idle",e[e.attack=1]="attack",e[e.justAttacked=2]="justAttacked",e[e.teleport=3]="teleport"}(a||(a={}));var m=function(e){function t(t,n,r,o,i,m){var y=e.call(this,t,n,r,o)||this;return y.ATTACK_RADIUS=5,y.hit=function(){return 1},y.withinAttackingRangeOfPlayer=function(){var e=!1;for(var t in y.game.players)Math.pow(y.x-y.game.players[t].x,2)+Math.pow(y.y-y.game.players[t].y,2)<=Math.pow(y.ATTACK_RADIUS,2)&&(e=!0);return e},y.shuffle=function(e){var t,n,r;for(r=e.length-1;r>0;r--)t=Math.floor(y.rand()*(r+1)),n=e[r],e[r]=e[t],e[t]=n;return e},y.tick=function(){if(!y.dead){if(y.skipNextTurns>0)return void y.skipNextTurns--;if(!y.seenPlayer){var e=y.nearestPlayer();if(!1!==e){var t=e[0];e[1],t<=4&&(y.seenPlayer=!0)}}if(y.seenPlayer)switch(y.state){case a.attack:y.tileX=7,y.level.levelArray[y.x-1][y.y].isSolid()||(y.level.projectiles.push(new p.WizardFireball(y,y.x-1,y.y)),y.level.levelArray[y.x-2][y.y].isSolid()||y.level.projectiles.push(new p.WizardFireball(y,y.x-2,y.y))),y.level.levelArray[y.x+1][y.y].isSolid()||(y.level.projectiles.push(new p.WizardFireball(y,y.x+1,y.y)),y.level.levelArray[y.x+2][y.y].isSolid()||y.level.projectiles.push(new p.WizardFireball(y,y.x+2,y.y))),y.level.levelArray[y.x][y.y-1].isSolid()||(y.level.projectiles.push(new p.WizardFireball(y,y.x,y.y-1)),y.level.levelArray[y.x][y.y-2].isSolid()||y.level.projectiles.push(new p.WizardFireball(y,y.x,y.y-2))),y.level.levelArray[y.x][y.y+1].isSolid()||(y.level.projectiles.push(new p.WizardFireball(y,y.x,y.y+1)),y.level.levelArray[y.x][y.y+2].isSolid()||y.level.projectiles.push(new p.WizardFireball(y,y.x,y.y+2))),y.state=a.justAttacked;break;case a.justAttacked:y.tileX=6,y.state=a.idle;break;case a.teleport:var n=y.x,r=y.y,o=1e5,i=void 0,l=y.shuffle(y.level.getEmptyTiles()),c=s.Game.randTable([2,2,3,3,3,3,3],y.rand),u=[];for(var d in y.game.players)u.push(d);for(var f=s.Game.randTable(u,y.rand),m=0,v=l;m<v.length;m++){var g=v[m],w=Math.abs(g.x-y.game.players[f].x)+Math.abs(g.y-y.game.players[f].y);Math.abs(w-c)<Math.abs(o-c)&&(o=w,i=g)}y.tryMove(i.x,i.y),y.drawX=y.x-n,y.drawY=y.y-r,y.frame=0,y.level.particles.push(new h.WizardTeleportParticle(n,r)),y.withinAttackingRangeOfPlayer()?y.state=a.attack:y.state=a.idle;break;case a.idle:y.state=a.teleport}}},y.draw=function(){y.dead||(y.hasShadow&&s.Game.drawMob(0,0,1,1,y.x-y.drawX,y.y-y.drawY,1,1,y.level.shadeColor,y.shadeAmount()),y.frame>=0?(s.Game.drawMob(Math.floor(y.frame)+6,2,1,2,y.x,y.y-1.5,1,2,y.level.shadeColor,y.shadeAmount()),y.frame+=.4,y.frame>11&&(y.frame=-1)):s.Game.drawMob(y.tileX,y.tileY,1,2,y.x-y.drawX,y.y-1.5-y.drawY,1,2,y.level.shadeColor,y.shadeAmount()))},y.kill=function(){if(y.level.levelArray[y.x][y.y]instanceof l.Floor){var e=new c.Bones(y.level,y.x,y.y);e.skin=y.level.levelArray[y.x][y.y].skin,y.level.levelArray[y.x][y.y]=e}y.dead=!0,y.level.particles.push(new u.DeathParticle(y.x,y.y)),y.dropLoot()},y.dropLoot=function(){y.drop.level=y.level,y.drop.x=y.x,y.drop.y=y.y,y.level.items.push(y.drop)},y.ticks=0,y.health=1,y.tileX=6,y.tileY=0,y.frame=0,y.state=a.attack,y.seenPlayer=!1,y.deathParticleColor="#ffffff",y.rand=i,m?y.drop=m:y.rand()<.02?y.drop=new f.BlueGem(y.level,y.x,y.y):y.drop=new d.Coin(y.level,y.x,y.y),y}return o(t,e),t}(i.Enemy);t.WizardEnemy=m},2967:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Game=t.LevelState=void 0;var r,o=n(988),a=n(663),i=n(5958),s=n(5742),l=n(569),c=n(5654),u=n(8835),h=n(9382),p=n(6882),d=n(751),f=n(9784);!function(e){e[e.IN_LEVEL=0]="IN_LEVEL",e[e.TRANSITIONING=1]="TRANSITIONING",e[e.TRANSITIONING_LADDER=2]="TRANSITIONING_LADDER"}(r=t.LevelState||(t.LevelState={}));var m=function(e){this.message=e,this.timestamp=Date.now()},y=function(){function e(){var t=this;this.keyDownListener=function(e){if(t.chatOpen)if(1===e.length)t.chatBox=t.chatBox.substring(0,t.chatBoxCursor)+e+t.chatBox.substring(t.chatBoxCursor,t.chatBox.length),t.chatBoxCursor+=1;else switch(e){case"Backspace":t.chatBox=t.chatBox.substring(0,t.chatBoxCursor-1)+t.chatBox.substring(t.chatBoxCursor,t.chatBox.length),t.chatBoxCursor=Math.max(0,t.chatBoxCursor-1);break;case"Delete":t.chatBox=t.chatBox.substring(0,t.chatBoxCursor)+t.chatBox.substring(t.chatBoxCursor+1,t.chatBox.length);break;case"ArrowLeft":t.chatBoxCursor=Math.max(0,t.chatBoxCursor-1);break;case"ArrowRight":t.chatBoxCursor=Math.min(t.chatBox.length,t.chatBoxCursor+1);break;case"Enter":t.chatBox.length>0&&t.socket.emit("chat message",t.chatBox),t.chatBox="",t.chatBoxCursor=0,t.chatOpen=!1;break;case"Escape":t.chatOpen=!1}else switch(e.toUpperCase()){case"C":t.chatOpen=!0;break;case"A":case"ARROWLEFT":t.players[t.localPlayerID].inputHandler(u.InputEnum.LEFT);break;case"D":case"ARROWRIGHT":t.players[t.localPlayerID].inputHandler(u.InputEnum.RIGHT);break;case"W":case"ARROWUP":t.players[t.localPlayerID].inputHandler(u.InputEnum.UP);break;case"S":case"ARROWDOWN":t.players[t.localPlayerID].inputHandler(u.InputEnum.DOWN);break;case" ":t.players[t.localPlayerID].inputHandler(u.InputEnum.SPACE);break;case"I":t.players[t.localPlayerID].inputHandler(u.InputEnum.I);break;case"Q":t.players[t.localPlayerID].inputHandler(u.InputEnum.Q)}},this.changeLevel=function(e,n){return t.players[t.localPlayerID]===e&&(t.level=n),n.enterLevel(e),t.levels.indexOf(n)},this.changeLevelThroughLadder=function(e,n){return n instanceof h.DownLadder&&n.generate(),t.players[t.localPlayerID]===e?(t.levelState=r.TRANSITIONING_LADDER,t.transitionStartTime=Date.now(),t.transitioningLadder=n):t.level.enterLevelThroughLadder(e,n.linkedLadder),t.levels.indexOf(n.linkedLadder.level)},this.changeLevelThroughDoor=function(e,n,a){return t.players[t.localPlayerID]===e?(t.levelState=r.TRANSITIONING,t.transitionStartTime=Date.now(),t.transitionX=t.players[t.localPlayerID].x,t.transitionY=t.players[t.localPlayerID].y,t.prevLevel=t.level,t.level=n.level,n.level.enterLevelThroughDoor(e,n,a),t.transitionX=(t.players[t.localPlayerID].x-t.transitionX)*o.GameConstants.TILESIZE,t.transitionY=(t.players[t.localPlayerID].y-t.transitionY)*o.GameConstants.TILESIZE,t.upwardTransition=!1,t.sideTransition=!1,t.sideTransitionDirection=a,n instanceof p.SideDoor?t.sideTransition=!0:n instanceof c.BottomDoor&&(t.upwardTransition=!0)):n.level.enterLevelThroughDoor(e,n,a),t.levels.indexOf(n.level)},this.run=function(){t.update(),t.draw()},this.update=function(){for(var e in u.Input.checkIsTapHold(),0!==u.Input.lastPressTime&&Date.now()-u.Input.lastPressTime>o.GameConstants.KEY_REPEAT_TIME&&u.Input.onKeydown({repeat:!1,code:u.Input.lastPressKeyCode}),t.levelState===r.TRANSITIONING&&Date.now()-t.transitionStartTime>=s.LevelConstants.LEVEL_TRANSITION_TIME&&(t.levelState=r.IN_LEVEL),t.levelState===r.TRANSITIONING_LADDER&&Date.now()-t.transitionStartTime>=s.LevelConstants.LEVEL_TRANSITION_TIME_LADDER&&(t.levelState=r.IN_LEVEL),t.players)if(t.players[e].update(),t.levels[t.players[e].levelID].update(),t.players[e].dead)for(var n in t.players)t.players[n].dead=!0},this.lerp=function(e,t,n){return(1-n)*e+n*t},this.onResize=function(){var t=Math.floor(window.innerWidth/o.GameConstants.DEFAULTWIDTH),n=Math.floor(window.innerHeight/o.GameConstants.DEFAULTHEIGHT);e.scale=Math.min(t,n),0===e.scale&&(t=window.innerWidth/o.GameConstants.DEFAULTWIDTH,n=window.innerHeight/o.GameConstants.DEFAULTHEIGHT),e.scale=Math.min(t,n),s.LevelConstants.SCREEN_W=Math.floor(window.innerWidth/e.scale/o.GameConstants.TILESIZE),s.LevelConstants.SCREEN_H=Math.floor(window.innerHeight/e.scale/o.GameConstants.TILESIZE),o.GameConstants.WIDTH=s.LevelConstants.SCREEN_W*o.GameConstants.TILESIZE,o.GameConstants.HEIGHT=s.LevelConstants.SCREEN_H*o.GameConstants.TILESIZE,e.ctx.canvas.setAttribute("width",""+o.GameConstants.WIDTH),e.ctx.canvas.setAttribute("height",""+o.GameConstants.HEIGHT),e.ctx.canvas.setAttribute("style","width: "+o.GameConstants.WIDTH*e.scale+"px; height: "+o.GameConstants.HEIGHT*e.scale+"px;\n    display: block;\n    margin: 0 auto;\n  \n    image-rendering: optimizeSpeed; /* Older versions of FF          */\n    image-rendering: -moz-crisp-edges; /* FF 6.0+                       */\n    image-rendering: -webkit-optimize-contrast; /* Safari                        */\n    image-rendering: -o-crisp-edges; /* OS X & Windows Opera (12.02+) */\n    image-rendering: pixelated; /* Awesome future-browsers       */\n  \n    -ms-interpolation-mode: nearest-neighbor;")},this.shakeScreen=function(e,n){t.screenShakeX=e,t.screenShakeY=n},this.draw=function(){if(e.ctx.globalAlpha=1,e.ctx.fillStyle=t.level.shadeColor,e.ctx.fillRect(0,0,o.GameConstants.WIDTH,o.GameConstants.HEIGHT),t.levelState===r.TRANSITIONING){var n=Math.floor(t.lerp((Date.now()-t.transitionStartTime)/s.LevelConstants.LEVEL_TRANSITION_TIME,0,-t.transitionX)),a=Math.floor(t.lerp((Date.now()-t.transitionStartTime)/s.LevelConstants.LEVEL_TRANSITION_TIME,0,-t.transitionY)),i=n-t.transitionX,l=a-t.transitionY,c=(t.players[t.localPlayerID].x-t.players[t.localPlayerID].drawX+.5)*o.GameConstants.TILESIZE,u=(t.players[t.localPlayerID].y-t.players[t.localPlayerID].drawY+.5)*o.GameConstants.TILESIZE;e.ctx.translate(-Math.round(c+i-.5*o.GameConstants.WIDTH),-Math.round(u+l-.5*o.GameConstants.HEIGHT));var h=Math.floor(t.lerp((Date.now()-t.transitionStartTime)/s.LevelConstants.LEVEL_TRANSITION_TIME,0,o.GameConstants.TILESIZE)),p=i,d=l;t.sideTransition?t.sideTransitionDirection>0?(n+=h,p+=h+o.GameConstants.TILESIZE):(n-=h,p-=h+o.GameConstants.TILESIZE):t.upwardTransition?(a-=h,d-=h+o.GameConstants.TILESIZE):(a+=h,d+=h+o.GameConstants.TILESIZE);var f=Math.floor(7*(Date.now()-t.transitionStartTime)/s.LevelConstants.LEVEL_TRANSITION_TIME);for(var m in e.ctx.translate(n,a),t.prevLevel.draw(),t.prevLevel.drawEntitiesBehindPlayer(),t.players)t.prevLevel===t.levels[t.players[m].levelID]&&t.players[m]!==t.players[t.localPlayerID]&&t.players[m].draw();t.prevLevel.drawEntitiesInFrontOfPlayer();for(var y=t.prevLevel.roomX-1;y<=t.prevLevel.roomX+t.prevLevel.width;y++)for(var v=t.prevLevel.roomY-1;v<=t.prevLevel.roomY+t.prevLevel.height;v++)e.drawFX(7-f,10,1,1,y,v,1,1);for(var m in e.ctx.translate(-n,-a),e.ctx.translate(p,d),t.level.draw(),t.level.drawEntitiesBehindPlayer(),t.players)t.level===t.levels[t.players[m].levelID]&&t.players[m]!==t.players[t.localPlayerID]&&t.players[m].draw();for(t.level.drawEntitiesInFrontOfPlayer(),y=t.level.roomX-1;y<=t.level.roomX+t.level.width;y++)for(v=t.level.roomY-1;v<=t.level.roomY+t.level.height;v++)e.drawFX(f,10,1,1,y,v,1,1);for(var m in e.ctx.translate(-p,-d),e.ctx.translate(i,l),t.players[t.localPlayerID].draw(),e.ctx.translate(-i,-l),e.ctx.translate(p,d),t.level.drawShade(),t.level.drawOverShade(),e.ctx.translate(-p,-d),e.ctx.translate(Math.round(c+i-.5*o.GameConstants.WIDTH),Math.round(u+l-.5*o.GameConstants.HEIGHT)),t.players[t.localPlayerID].drawGUI(),t.players)t.players[m].updateDrawXY()}else if(t.levelState===r.TRANSITIONING_LADDER){if(c=(t.players[t.localPlayerID].x-t.players[t.localPlayerID].drawX+.5)*o.GameConstants.TILESIZE,u=(t.players[t.localPlayerID].y-t.players[t.localPlayerID].drawY+.5)*o.GameConstants.TILESIZE,e.ctx.translate(-Math.round(c-.5*o.GameConstants.WIDTH),-Math.round(u-.5*o.GameConstants.HEIGHT)),(f=Math.floor(20*(Date.now()-t.transitionStartTime)/s.LevelConstants.LEVEL_TRANSITION_TIME_LADDER))<7){for(var m in t.level.draw(),t.level.drawEntitiesBehindPlayer(),t.players)t.level===t.levels[t.players[m].levelID]&&t.players[m].draw();for(t.level.drawEntitiesInFrontOfPlayer(),t.level.drawShade(),t.level.drawOverShade(),y=t.level.roomX-1;y<=t.level.roomX+t.level.width;y++)for(v=t.level.roomY-1;v<=t.level.roomY+t.level.height;v++)e.drawFX(7-f,10,1,1,y,v,1,1)}else if(f>=13){for(var m in t.transitioningLadder&&(t.prevLevel=t.level,t.level.exitLevel(),t.level=t.transitioningLadder.linkedLadder.level,t.level.enterLevelThroughLadder(t.players[t.localPlayerID],t.transitioningLadder.linkedLadder),t.transitioningLadder=null),t.level.draw(),t.level.drawEntitiesBehindPlayer(),t.players)t.level===t.levels[t.players[m].levelID]&&t.players[m].draw();for(t.level.drawEntitiesInFrontOfPlayer(),t.level.drawShade(),t.level.drawOverShade(),y=t.level.roomX-1;y<=t.level.roomX+t.level.width;y++)for(v=t.level.roomY-1;v<=t.level.roomY+t.level.height;v++)e.drawFX(f-13,10,1,1,y,v,1,1)}for(var m in e.ctx.translate(Math.round(c-.5*o.GameConstants.WIDTH),Math.round(u-.5*o.GameConstants.HEIGHT)),t.players[t.localPlayerID].drawGUI(),t.players)t.players[m].updateDrawXY()}else{t.screenShakeX*=-.8,t.screenShakeY*=-.8;var g=t.players[t.localPlayerID].drawX,w=t.players[t.localPlayerID].drawY;for(var m in e.ctx.translate(-Math.round((t.players[t.localPlayerID].x-g+.5)*o.GameConstants.TILESIZE-.5*o.GameConstants.WIDTH-t.screenShakeX),-Math.round((t.players[t.localPlayerID].y-w+.5)*o.GameConstants.TILESIZE-.5*o.GameConstants.HEIGHT-t.screenShakeY)),t.level.draw(),t.level.drawEntitiesBehindPlayer(),t.players)t.level===t.levels[t.players[m].levelID]&&t.players[m].draw();for(var m in t.level.drawEntitiesInFrontOfPlayer(),t.level.drawShade(),t.level.drawOverShade(),t.players[t.localPlayerID].drawTopLayer(),e.ctx.translate(Math.round((t.players[t.localPlayerID].x-g+.5)*o.GameConstants.TILESIZE-.5*o.GameConstants.WIDTH-t.screenShakeX),Math.round((t.players[t.localPlayerID].y-w+.5)*o.GameConstants.TILESIZE-.5*o.GameConstants.HEIGHT-t.screenShakeY)),t.level.drawTopLayer(),t.players[t.localPlayerID].drawGUI(),t.players)t.players[m].updateDrawXY()}var _=o.GameConstants.HEIGHT-e.letter_height-14;if(t.chatOpen){e.ctx.fillStyle="black",e.ctx.globalAlpha=.5,e.ctx.fillRect(0,0,o.GameConstants.WIDTH,o.GameConstants.HEIGHT),e.ctx.globalAlpha=1,e.ctx.fillStyle="white",e.fillText(t.chatBox,10,_);var C=e.measureText(t.chatBox.substring(0,t.chatBoxCursor)).width;e.ctx.fillRect(10+C,_,1,e.letter_height)}for(m=0;m<t.chat.length;m++){e.ctx.fillStyle="white",v=_-(t.chat.length-1-m)*(e.letter_height+1),t.chatOpen&&(v-=e.letter_height+1);var b=Date.now()-t.chat[m].timestamp;t.chatOpen?e.ctx.globalAlpha=1:b<=o.GameConstants.CHAT_APPEAR_TIME?e.ctx.globalAlpha=.5:b<=o.GameConstants.CHAT_APPEAR_TIME+o.GameConstants.CHAT_FADE_TIME?e.ctx.globalAlpha=.5*(1-(b-o.GameConstants.CHAT_APPEAR_TIME)/o.GameConstants.CHAT_FADE_TIME):e.ctx.globalAlpha=0,e.fillText(t.chat[m].message,10,v)}e.ctx.globalAlpha=.1,e.ctx.fillStyle=s.LevelConstants.LEVEL_TEXT_COLOR,e.ctx.font=o.GameConstants.SCRIPT_FONT_SIZE+"px Script",e.ctx.textBaseline="top",e.fillText(o.GameConstants.VERSION,o.GameConstants.WIDTH-e.measureText(o.GameConstants.VERSION).width-1,1),e.ctx.globalAlpha=1},this.drawSoftVis1x1=function(n,r,a,i,s,l,c,u,h){void 0===e.shImg&&(e.shImg=document.createElement("canvas"),e.shCtx=e.shImg.getContext("2d"),e.shImg.width=2*o.GameConstants.TILESIZE,e.shImg.height=2*o.GameConstants.TILESIZE),e.shCtx.clearRect(0,0,e.shImg.width,e.shImg.height),e.shCtx.globalCompositeOperation="source-over",e.shCtx.drawImage(n,Math.round(r*o.GameConstants.TILESIZE),Math.round(a*o.GameConstants.TILESIZE),Math.round(i*o.GameConstants.TILESIZE),Math.round(s*o.GameConstants.TILESIZE),0,0,o.GameConstants.TILESIZE,o.GameConstants.TILESIZE),e.shCtx.globalCompositeOperation="multiply",e.shCtx.fillStyle="black";for(var p=0;p<1;p+=.25)for(var d=0;d<1;d+=.25)e.shCtx.globalAlpha=(1-p)*(1-d)*.25*(t.level.softVis[u][h]+t.level.softVis[u-1][h]+t.level.softVis[u-1][h-1]+t.level.softVis[u][h-1])+p*(1-d)*.25*(t.level.softVis[u+1][h]+t.level.softVis[u][h]+t.level.softVis[u][h-1]+t.level.softVis[u+1][h-1])+(1-p)*d*.25*(t.level.softVis[u][h+1]+t.level.softVis[u-1][h+1]+t.level.softVis[u-1][h]+t.level.softVis[u][h])+p*d*.25*(t.level.softVis[u+1][h+1]+t.level.softVis[u][h+1]+t.level.softVis[u][h]+t.level.softVis[u+1][h]),e.shCtx.fillRect(p*o.GameConstants.TILESIZE,d*o.GameConstants.TILESIZE,.25*o.GameConstants.TILESIZE,.25*o.GameConstants.TILESIZE);e.shCtx.globalAlpha=1,e.shCtx.globalCompositeOperation="destination-in",e.shCtx.drawImage(n,Math.round(r*o.GameConstants.TILESIZE),Math.round(a*o.GameConstants.TILESIZE),Math.round(i*o.GameConstants.TILESIZE),Math.round(s*o.GameConstants.TILESIZE),0,0,o.GameConstants.TILESIZE,o.GameConstants.TILESIZE),e.ctx.drawImage(e.shImg,Math.round(l*o.GameConstants.TILESIZE),Math.round(c*o.GameConstants.TILESIZE))},window.addEventListener("load",(function(){t.socket=d.io(f.ServerAddress.address,{transports:["websocket"]}),t.socket.on("welcome",(function(e,n){console.log("welcome"),t.localPlayerID=n,t.players={},t.players[t.localPlayerID]=new a.Player(t,0,0,!0),t.levels=Array(),t.levelgen=new l.LevelGenerator,t.levelgen.setSeed(e),t.levelgen.generate(t,0),t.level=t.levels[0],t.level.enterLevel(t.players[t.localPlayerID]),t.screenShakeX=0,t.screenShakeY=0,t.levelState=r.IN_LEVEL,setInterval(t.run,1e3/o.GameConstants.FPS),t.onResize(),window.addEventListener("resize",t.onResize)})),t.socket.on("input",(function(e,n){switch(e in t.players||(t.players[e]=new a.Player(t,0,0,!1),t.levels[0].enterLevel(t.players[e])),n){case u.InputEnum.I:t.players[e].iListener();break;case u.InputEnum.Q:t.players[e].qListener();break;case u.InputEnum.LEFT:t.players[e].leftListener(!1);break;case u.InputEnum.RIGHT:t.players[e].rightListener(!1);break;case u.InputEnum.UP:t.players[e].upListener(!1);break;case u.InputEnum.DOWN:t.players[e].downListener(!1);break;case u.InputEnum.SPACE:t.players[e].spaceListener()}})),t.socket.on("chat message",(function(e){t.chat.push(new m(e))})),t.socket.on("player connected",(function(e){for(var n in t.players)t.players[n]=new a.Player(t,0,0,!1),t.levels[0].enterLevel(t.players[n]);t.players[e]=new a.Player(t,0,0,!1),t.levels[0].enterLevel(t.players[e]),t.level=t.levels[0]})),t.socket.on("player disconnected",(function(e){delete t.players[e]}));var n=document.getElementById("gameCanvas");e.ctx=n.getContext("2d",{alpha:!1}),t.chat=[],t.chatBox="",t.chatBoxCursor=0,t.chatOpen=!1,e.ctx.font=o.GameConstants.SCRIPT_FONT_SIZE+"px Script",e.ctx.textBaseline="top",e.tileset=new Image,e.tileset.src="res/tileset.png",e.objset=new Image,e.objset.src="res/objset.png",e.mobset=new Image,e.mobset.src="res/mobset.png",e.itemset=new Image,e.itemset.src="res/itemset.png",e.fxset=new Image,e.fxset.src="res/fxset.png",e.shopset=new Image,e.shopset.src="res/shopset.png",e.tilesetShadow=new Image,e.tilesetShadow.src="res/tilesetShadow.png",e.objsetShadow=new Image,e.objsetShadow.src="res/objsetShadow.png",e.mobsetShadow=new Image,e.mobsetShadow.src="res/mobsetShadow.png",e.fontsheet=new Image,e.fontsheet.src="res/font.png",e.scale=1,i.Sound.loadSounds(),i.Sound.playMusic(),document.addEventListener("touchstart",(function(e){e.target==n&&e.preventDefault()}),!1),document.addEventListener("touchend",(function(e){e.target==n&&e.preventDefault()}),!1),document.addEventListener("touchmove",(function(e){e.target==n&&e.preventDefault()}),!1),document.addEventListener("touchstart",u.Input.handleTouchStart,{passive:!1}),document.addEventListener("touchmove",u.Input.handleTouchMove,{passive:!1}),document.addEventListener("touchend",u.Input.handleTouchEnd,{passive:!1}),u.Input.keyDownListener=function(e){t.keyDownListener(e)}}))}return e.text_rendering_canvas=null,e.letters="abcdefghijklmnopqrstuvwxyz1234567890,.!?:'()%-",e.letter_widths=[4,4,4,4,3,3,4,4,1,4,4,3,5,5,4,4,4,4,4,3,4,5,5,5,5,3,3,4,4,4,4,4,4,4,4,4,2,1,1,4,1,1,2,2,5,3],e.letter_height=6,e.letter_positions=[],e.rand=function(e,t,n){return void 0===n&&(n=Math.random),t<e?e:Math.floor(n()*(t-e+1)+e)},e.randTable=function(t,n){return void 0===n&&(n=Math.random),t[e.rand(0,t.length-1,n)]},e.measureText=function(t){for(var n=0,r=0,o=t.toLowerCase();r<o.length;r++){var a=o[r];if(" "===a)n+=4;else for(var i=0;i<e.letters.length;i++)e.letters[i]===a&&(n+=e.letter_widths[i]+1)}return{width:n,height:e.letter_height}},e.fillText=function(t,n,r,o){if(n=Math.floor(n),r=Math.floor(r),0===e.letter_positions.length)for(var a=0;a<e.letter_widths.length;a++)0===a?e.letter_positions[0]=0:e.letter_positions[a]=e.letter_positions[a-1]+e.letter_widths[a-1]+2;else{var i=e.measureText(t);if(i.width>0){e.text_rendering_canvas||(e.text_rendering_canvas=document.createElement("canvas")),e.text_rendering_canvas.width=i.width,e.text_rendering_canvas.height=i.height;for(var s=e.text_rendering_canvas.getContext("2d"),l=0,c=0,u=t.toLowerCase();c<u.length;c++){var h=u[c];if(" "===h)l+=4;else for(a=0;a<e.letters.length;a++)e.letters[a]===h&&(s.drawImage(e.fontsheet,e.letter_positions[a]+1,0,e.letter_widths[a],e.letter_height,l,0,e.letter_widths[a],e.letter_height),l+=e.letter_widths[a]+1)}s.fillStyle=e.ctx.fillStyle,s.globalCompositeOperation="source-in",s.fillRect(0,0,e.text_rendering_canvas.width,e.text_rendering_canvas.height),e.ctx.drawImage(e.text_rendering_canvas,n,r)}}},e.drawHelper=function(t,n,r,a,i,s,l,c,u,h,p){void 0===h&&(h="black"),void 0===p&&(p=0),p>0?(void 0===e.shImg&&(e.shImg=document.createElement("canvas"),e.shCtx=e.shImg.getContext("2d"),e.shImg.width=2*o.GameConstants.TILESIZE,e.shImg.height=2*o.GameConstants.TILESIZE),e.shCtx.clearRect(0,0,e.shImg.width,e.shImg.height),e.shCtx.globalCompositeOperation="source-over",e.shCtx.drawImage(t,Math.round(n*o.GameConstants.TILESIZE),Math.round(r*o.GameConstants.TILESIZE),Math.round(a*o.GameConstants.TILESIZE),Math.round(i*o.GameConstants.TILESIZE),0,0,Math.round(c*o.GameConstants.TILESIZE),Math.round(u*o.GameConstants.TILESIZE)),e.shCtx.globalAlpha=p,e.shCtx.fillStyle=h,e.shCtx.fillRect(0,0,e.shImg.width,e.shImg.height),e.shCtx.globalAlpha=1,e.shCtx.globalCompositeOperation="destination-in",e.shCtx.drawImage(t,Math.round(n*o.GameConstants.TILESIZE),Math.round(r*o.GameConstants.TILESIZE),Math.round(a*o.GameConstants.TILESIZE),Math.round(i*o.GameConstants.TILESIZE),0,0,Math.round(c*o.GameConstants.TILESIZE),Math.round(u*o.GameConstants.TILESIZE)),e.ctx.drawImage(e.shImg,Math.round(s*o.GameConstants.TILESIZE),Math.round(l*o.GameConstants.TILESIZE))):e.ctx.drawImage(t,Math.round(n*o.GameConstants.TILESIZE),Math.round(r*o.GameConstants.TILESIZE),Math.round(a*o.GameConstants.TILESIZE),Math.round(i*o.GameConstants.TILESIZE),Math.round(s*o.GameConstants.TILESIZE),Math.round(l*o.GameConstants.TILESIZE),Math.round(c*o.GameConstants.TILESIZE),Math.round(u*o.GameConstants.TILESIZE))},e.drawTile=function(t,n,r,a,i,s,l,c,u,h){void 0===u&&(u="black"),void 0===h&&(h=0),e.ctx.drawImage(e.tileset,Math.round(t*o.GameConstants.TILESIZE),Math.round(n*o.GameConstants.TILESIZE),Math.round(r*o.GameConstants.TILESIZE),Math.round(a*o.GameConstants.TILESIZE),Math.round(i*o.GameConstants.TILESIZE),Math.round(s*o.GameConstants.TILESIZE),Math.round(l*o.GameConstants.TILESIZE),Math.round(c*o.GameConstants.TILESIZE)),e.ctx.globalAlpha=h,e.ctx.fillStyle=u,e.ctx.fillRect(Math.round(i*o.GameConstants.TILESIZE),Math.round(s*o.GameConstants.TILESIZE),Math.round(l*o.GameConstants.TILESIZE),Math.round(c*o.GameConstants.TILESIZE)),e.ctx.globalAlpha=1},e.drawObj=function(t,n,r,o,a,i,s,l,c,u){void 0===c&&(c="black"),void 0===u&&(u=0),e.drawHelper(e.objset,t,n,r,o,a,i,s,l,c,u)},e.drawMob=function(t,n,r,o,a,i,s,l,c,u){void 0===c&&(c="black"),void 0===u&&(u=0),e.drawHelper(e.mobset,t,n,r,o,a,i,s,l,c,u)},e.drawShop=function(t,n,r,a,i,s,l,c){e.ctx.drawImage(e.shopset,Math.round(t*o.GameConstants.TILESIZE),Math.round(n*o.GameConstants.TILESIZE),Math.round(r*o.GameConstants.TILESIZE),Math.round(a*o.GameConstants.TILESIZE),Math.round(i*o.GameConstants.TILESIZE),Math.round(s*o.GameConstants.TILESIZE),Math.round(l*o.GameConstants.TILESIZE),Math.round(c*o.GameConstants.TILESIZE))},e.drawItem=function(t,n,r,o,a,i,s,l,c,u){void 0===c&&(c="black"),void 0===u&&(u=0),e.drawHelper(e.itemset,t,n,r,o,a,i,s,l,c,u)},e.drawFX=function(t,n,r,o,a,i,s,l,c,u){void 0===c&&(c="black"),void 0===u&&(u=0),e.drawHelper(e.fxset,t,n,r,o,a,i,s,l,c,u)},e}();t.Game=y,new y},988:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GameConstants=void 0;var r=n(5742),o=function(){function e(){}return e.VERSION="v0.5.7",e.FPS=60,e.TILESIZE=16,e.SCALE=2,e.SWIPE_THRESH=Math.pow(50,2),e.KEY_REPEAT_TIME=300,e.CHAT_APPEAR_TIME=1e4,e.CHAT_FADE_TIME=1e3,e.DEFAULTWIDTH=8.5*e.TILESIZE,e.DEFAULTHEIGHT=8.5*e.TILESIZE,e.WIDTH=r.LevelConstants.SCREEN_W*e.TILESIZE,e.HEIGHT=r.LevelConstants.SCREEN_H*e.TILESIZE,e.scrolling=!0,e.SCRIPT_FONT_SIZE=16,e.FONT_SIZE=10,e.BIG_FONT_SIZE=20,e.RED="#ac3232",e.GREEN="#6abe30",e.ARMOR_GREY="#9badb7",e.OUTLINE="#222034",e.HIT_ENEMY_TEXT_COLOR="#76428a",e.HEALTH_BUFF_COLOR="#d77bba",e.MISS_COLOR="#639bff",e}();t.GameConstants=o},3338:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HealthBar=void 0;var r=n(2967),o=n(5742);t.HealthBar=function(){var e=this;this.hurt=function(){e.hurtTimer=Date.now()},this.draw=function(t,n,a,i,s){var l=Date.now()-e.hurtTimer;if(l<=o.LevelConstants.HEALTH_BAR_TOTALTIME)for(var c=Math.floor(t),u=Math.ceil(t-c),h=Math.round(Math.min(9,Math.min(.05*(o.LevelConstants.HEALTH_BAR_TOTALTIME-l),.05*l))),p=Math.round(16*Math.min(.5,Math.min(.003*(o.LevelConstants.HEALTH_BAR_TOTALTIME-l),.003*l)))/16,d=.5+-(h*(n-1)+8)/16/2,f=0;f<Math.ceil(.5*n);f++){var m;m=s?f<c?0:f<c+u?.5:1:1.5;var y=h*f/16+d;r.Game.drawFX(m,8,.5,.5,a+y,i-1-p/2,.5,p),y+=9/16;var v=n-f-1;if(v!==f){var g;g=s?v<c?0:v<c+u?.5:1:1.5;var w=h*v/16+d;r.Game.drawFX(g,8,.5,.5,a+w,i-1-p/2,.5,p),w+=9/16}}},this.hurtTimer=0}},8835:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Input=t.InputEnum=void 0;var r,o=n(988),a=n(2967);(r=t.InputEnum||(t.InputEnum={}))[r.I=0]="I",r[r.M=1]="M",r[r.M_UP=2]="M_UP",r[r.Q=3]="Q",r[r.LEFT=4]="LEFT",r[r.RIGHT=5]="RIGHT",r[r.UP=6]="UP",r[r.DOWN=7]="DOWN",r[r.SPACE=8]="SPACE",t.Input={_pressed:{},isTapHold:!1,tapStartTime:null,IS_TAP_HOLD_THRESH:100,keyDownListener:function(e){},iListener:function(){},mListener:function(){},mUpListener:function(){},qListener:function(){},leftListener:function(){},rightListener:function(){},upListener:function(){},downListener:function(){},aListener:function(){t.Input.leftListener()},dListener:function(){t.Input.rightListener()},wListener:function(){t.Input.upListener()},sListener:function(){t.Input.downListener()},spaceListener:function(){},leftSwipeListener:function(){},rightSwipeListener:function(){},upSwipeListener:function(){},downSwipeListener:function(){},tapListener:function(){},mouseLeftClickListeners:[],mouseLeftClickListener:function(e,n){for(var r=0;r<t.Input.mouseLeftClickListeners.length;r++)t.Input.mouseLeftClickListeners[r](e,n)},mouseX:0,mouseY:0,lastPressTime:0,lastPressKeyCode:"",SPACE:"Space",LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown",W:"KeyW",A:"KeyA",S:"KeyS",D:"KeyD",M:"KeyM",N:"KeyN",I:"KeyI",Q:"KeyQ",isDown:function(e){return this._pressed[e]},onKeydown:function(e){if(e.key&&t.Input.keyDownListener(e.key),e.cancelable&&e.preventDefault(),!e.repeat)switch(t.Input.lastPressTime=Date.now(),t.Input.lastPressKeyCode=e.code,t.Input._pressed[e.code]=!0,e.code){case t.Input.LEFT:t.Input.leftListener();break;case t.Input.A:t.Input.aListener();break;case t.Input.RIGHT:t.Input.rightListener();break;case t.Input.D:t.Input.dListener();break;case t.Input.UP:t.Input.upListener();break;case t.Input.W:t.Input.wListener();break;case t.Input.DOWN:t.Input.downListener();break;case t.Input.S:t.Input.sListener();break;case t.Input.SPACE:t.Input.spaceListener();break;case t.Input.M:t.Input.mListener();break;case t.Input.I:t.Input.iListener();break;case t.Input.Q:t.Input.qListener()}},onKeyup:function(e){delete this._pressed[e.code],e.code===this.lastPressKeyCode&&(this.lastPressTime=0,this.lastPressKeyCode=0),e.code===t.Input.M&&t.Input.mUpListener()},mouseClickListener:function(e){if(0===e.button){var n=window.document.getElementById("gameCanvas").getBoundingClientRect(),r=e.clientX-n.left,o=e.clientY-n.top;t.Input.mouseLeftClickListener(Math.floor(r/a.Game.scale),Math.floor(o/a.Game.scale))}},updateMousePos:function(e){var n=window.document.getElementById("gameCanvas").getBoundingClientRect(),r=e.clientX-n.left,o=e.clientY-n.top;t.Input.mouseX=Math.floor(r/a.Game.scale),t.Input.mouseY=Math.floor(o/a.Game.scale)},getTouches:function(e){return e.touches||e.originalEvent.touches},xDown:null,yDown:null,currentX:0,currentY:0,swiped:!1,handleTouchStart:function(e){e.preventDefault();var n=t.Input.getTouches(e)[0];t.Input.xDown=n.clientX,t.Input.yDown=n.clientY,t.Input.currentX=n.clientX,t.Input.currentY=n.clientY,t.Input.tapStartTime=Date.now(),t.Input.updateMousePos({clientX:t.Input.currentX,clientY:t.Input.currentY}),t.Input.swiped=!1},handleTouchMove:function(e){if(e.preventDefault(),t.Input.currentX=e.touches[0].clientX,t.Input.currentY=e.touches[0].clientY,t.Input.updateMousePos({clientX:t.Input.currentX,clientY:t.Input.currentY}),!t.Input.swiped){var n=t.Input.xDown-t.Input.currentX,r=t.Input.yDown-t.Input.currentY;Math.pow(n,2)+Math.pow(r,2)>=o.GameConstants.SWIPE_THRESH&&(Math.abs(n)>Math.abs(r)?(n>0?t.Input.leftSwipeListener():t.Input.rightSwipeListener(),t.Input.swiped=!0):(r>0?t.Input.upSwipeListener():t.Input.downSwipeListener(),t.Input.swiped=!0))}},handleTouchEnd:function(e){e.preventDefault(),t.Input.isTapHold||t.Input.swiped||t.Input.tapListener(),t.Input.isTapHold=!1,t.Input.tapStartTime=null,t.Input.swiped||(t.Input.mouseClickListener({button:0,clientX:t.Input.currentX,clientY:t.Input.currentY}),t.Input.updateMousePos({clientX:0,clientY:0}))},checkIsTapHold:function(){null!==t.Input.tapStartTime&&Date.now()>=t.Input.tapStartTime+t.Input.IS_TAP_HOLD_THRESH&&(t.Input.isTapHold=!0)}},window.addEventListener("keyup",(function(e){t.Input.onKeyup(e)}),!1),window.addEventListener("keydown",(function(e){t.Input.onKeydown(e)}),!1),window.document.getElementById("gameCanvas").addEventListener("click",(function(e){return t.Input.mouseClickListener(e)}),!1),window.document.getElementById("gameCanvas").addEventListener("mousemove",(function(e){return t.Input.updateMousePos(e)}))},7531:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Inventory=void 0;var r=n(5742),o=n(2967),a=n(988),i=n(8499),s=n(8573),l=n(1978),c=n(2091),u=n(6330),h=n(1802),p=n(5895),d="#5a595b",f="#292c36",m="#85a8e6";t.Inventory=function(e,t){var n=this;this.rows=2,this.cols=5,this.selX=0,this.selY=0,this.open=function(){n.isOpen=!n.isOpen,n.isOpen&&(n.openTime=Date.now())},this.close=function(){n.isOpen=!1},this.left=function(){n.selX--,n.selX<0&&(n.selX=0)},this.right=function(){n.selX++,n.selX>n.cols-1&&(n.selX=n.cols-1)},this.up=function(){n.selY--,n.selY<0&&(n.selY=0)},this.down=function(){n.selY++,n.selY>n.rows-1&&(n.selY=n.rows-1)},this.space=function(){var e=n.selX+n.selY*n.cols;if(n.items[e]instanceof h.Usable&&(n.items[e].onUse(n.player),n.items.splice(e,1)),n.items[e]instanceof i.Equippable){var t=n.items[e];if(t.toggleEquip(),t instanceof c.Weapon&&(t.equipped?n.weapon=t:n.weapon=null),t.equipped)for(var r=0,o=n.items;r<o.length;r++){var a=o[r];a instanceof i.Equippable&&a!==t&&!t.coEquippable(a)&&(a.equipped=!1)}n.equipped=n.items.filter((function(e){return e instanceof i.Equippable&&e.equipped}))}},this.drop=function(){var e=n.selX+n.selY*n.cols;e<n.items.length&&(n.items[e]instanceof i.Equippable&&(n.items[e].equipped=!1),n.items[e].level=n.game.levels[n.player.levelID],n.items[e].x=n.player.x,n.items[e].y=n.player.y,n.items[e].pickedUp=!1,n.equipAnimAmount[e]=0,n.equipped=n.items.filter((function(e){return e instanceof i.Equippable&&e.equipped})),n.game.levels[n.player.levelID].items.push(n.items[e]),n.items.splice(e,1))},this.hasItem=function(e){for(var t=0,r=n.items;t<r.length;t++){var o=r[t];if(o instanceof e)return o}return null},this.hasItemCount=function(e){if(e instanceof l.Coin)return n.coinCount()>=e.stackCount;for(var t=0,r=n.items;t<r.length;t++){var o=r[t];if(o.constructor===e.constructor&&o.stackCount>=e.stackCount)return!0}return!1},this.subtractItemCount=function(e){if(e instanceof l.Coin)n.subtractCoins(e.stackCount);else for(var t=0,r=n.items;t<r.length;t++){var o=r[t];o.constructor===e.constructor&&(o.stackCount-=e.stackCount,o.stackCount<=0&&n.items.splice(n.items.indexOf(o),1))}},this.coinCount=function(){return n.coins},this.subtractCoins=function(e){n.coins-=e,n.coins<0&&(n.coins=0)},this.addCoins=function(e){n.coins+=e},this.isFull=function(){return n.items.length>=n.rows*n.cols},this.addItem=function(e){if(e instanceof l.Coin)return n.coins+=1,!0;if(e.stackable)for(var t=0,r=n.items;t<r.length;t++){var o=r[t];if(o.constructor===e.constructor)return o.stackCount++,!0}return!n.isFull()&&(n.items.push(e),!0)},this.removeItem=function(e){var t=n.items.indexOf(e);-1!==t&&n.items.splice(t,1)},this.getArmor=function(){for(var e=0,t=n.equipped;e<t.length;e++){var r=t[e];if(r instanceof s.Armor)return r}return null},this.hasWeapon=function(){return null!==n.weapon},this.getWeapon=function(){return n.weapon},this.tick=function(){for(var e=0,t=n.items;e<t.length;e++)t[e].tickInInventory()},this.textWrap=function(e,t,n,r){for(var a=e.split(" "),i="";a.length>0;)o.Game.measureText(i+a[0]).width>r?(o.Game.fillText(i,t,n),i="",n+=8):(""!==i&&(i+=" "),i+=a[0],a.splice(0,1));return" "!==i&&(o.Game.fillText(i,t,n),n+=8),n},this.drawCoins=function(){var e=r.LevelConstants.SCREEN_W-1,t=r.LevelConstants.SCREEN_H-1;o.Game.drawItem(19,0,1,2,e,t-1,1,2);var i=""+n.coins,s=4-o.Game.measureText(i).width;o.Game.ctx.fillStyle="black";for(var l=-1;l<=1;l++)for(var c=-1;c<=1;c++)o.Game.ctx.fillStyle=a.GameConstants.OUTLINE,o.Game.fillText(i,e*a.GameConstants.TILESIZE+s+l,t*a.GameConstants.TILESIZE-1+c);o.Game.ctx.fillStyle="white",o.Game.fillText(i,e*a.GameConstants.TILESIZE+s,t*a.GameConstants.TILESIZE-1)},this.draw=function(){if(n.drawCoins(),n.isOpen){for(var e=0;e<n.equipAnimAmount.length;e++)n.items[e]instanceof i.Equippable?n.items[e].equipped?n.equipAnimAmount[e]+=.2*(1-n.equipAnimAmount[e]):n.equipAnimAmount[e]+=.2*(0-n.equipAnimAmount[e]):n.equipAnimAmount[e]=0;o.Game.ctx.fillStyle="rgb(0, 0, 0, 0.8)",o.Game.ctx.fillRect(0,0,a.GameConstants.WIDTH,a.GameConstants.HEIGHT),n.items=n.items.filter((function(e){return!e.dead})),o.Game.ctx.globalAlpha=1;var t=Math.min(18,18*(Date.now()-n.openTime)/100),r=-2,s=3+Math.round(.5*Math.sin(.01*Date.now())+.5),l=n.cols*(t+4+r)-r,c=n.rows*(t+4+r)-r;o.Game.ctx.fillStyle="white",o.Game.ctx.fillRect(Math.round(.5*a.GameConstants.WIDTH-.5*l)-1,Math.round(.5*a.GameConstants.HEIGHT-.5*c)-1,Math.round(l+2),Math.round(c+2)),o.Game.ctx.fillRect(Math.round(.5*a.GameConstants.WIDTH-.5*l+n.selX*(t+4+r))-s-1,Math.round(.5*a.GameConstants.HEIGHT-.5*c+n.selY*(t+4+r))-s-1,Math.round(t+4+2*s)+2,Math.round(t+4+2*s)+2);for(var u=0;u<n.cols;u++)for(var p=0;p<n.rows;p++){o.Game.ctx.fillStyle=f,o.Game.ctx.fillRect(Math.round(.5*a.GameConstants.WIDTH-.5*l+u*(t+4+r)),Math.round(.5*a.GameConstants.HEIGHT-.5*c+p*(t+4+r)),Math.round(t+4),Math.round(t+4)),o.Game.ctx.fillStyle=d,o.Game.ctx.fillRect(Math.round(.5*a.GameConstants.WIDTH-.5*l+u*(t+4+r)+2),Math.round(.5*a.GameConstants.HEIGHT-.5*c+p*(t+4+r)+2),Math.round(t),Math.round(t));var y=u+p*n.cols;o.Game.ctx.fillStyle=m;var v=t*(1-n.equipAnimAmount[y]);o.Game.ctx.fillRect(Math.round(.5*a.GameConstants.WIDTH-.5*l+u*(t+4+r)+2),Math.round(.5*a.GameConstants.HEIGHT-.5*c+p*(t+4+r)+2+v),Math.round(t),Math.round(t-v))}if(Date.now()-n.openTime>=100){for(var g=0;g<n.items.length;g++){u=g%n.cols,p=Math.floor(g/n.cols);var w=Math.round(.5*a.GameConstants.WIDTH-.5*l+u*(t+4+r)+2+Math.floor(.5*t)-.5*a.GameConstants.TILESIZE),_=Math.round(.5*a.GameConstants.HEIGHT-.5*c+p*(t+4+r)+2+Math.floor(.5*t)-.5*a.GameConstants.TILESIZE),C=w/a.GameConstants.TILESIZE,b=_/a.GameConstants.TILESIZE;n.items[g].drawIcon(C,b)}o.Game.ctx.fillStyle=f,o.Game.ctx.fillRect(Math.round(.5*a.GameConstants.WIDTH-.5*l+n.selX*(t+4+r))-s,Math.round(.5*a.GameConstants.HEIGHT-.5*c+n.selY*(t+4+r))-s,Math.round(t+4+2*s),Math.round(t+4+2*s)),o.Game.ctx.fillStyle=d,o.Game.ctx.fillRect(Math.round(.5*a.GameConstants.WIDTH-.5*l+n.selX*(t+4+r)+2-s),Math.round(.5*a.GameConstants.HEIGHT-.5*c+n.selY*(t+4+r)+2-s),Math.round(t+2*s),Math.round(t+2*s));var E=n.selX+n.selY*n.cols;o.Game.ctx.fillStyle=m,v=(t+2*s)*(1-n.equipAnimAmount[E]),o.Game.ctx.fillRect(Math.round(.5*a.GameConstants.WIDTH-.5*l+n.selX*(t+4+r)+2-s),Math.round(.5*a.GameConstants.HEIGHT-.5*c+n.selY*(t+4+r)+2-s+v),Math.round(t+2*s),Math.round(t+2*s-v));var I=Math.round(.5*a.GameConstants.WIDTH-.5*l+n.selX*(t+4+r)+2+Math.floor(.5*t)-.5*a.GameConstants.TILESIZE),T=Math.round(.5*a.GameConstants.HEIGHT-.5*c+n.selY*(t+4+r)+2+Math.floor(.5*t)-.5*a.GameConstants.TILESIZE),x=I/a.GameConstants.TILESIZE,O=T/a.GameConstants.TILESIZE;E<n.items.length&&n.items[E].drawIcon(x,O)}var S=n.selX+n.selY*n.cols;if(S<n.items.length){o.Game.ctx.fillStyle="white";var A="";n.items[S]instanceof i.Equippable&&(A="[SPACE] to equip",n.items[S].equipped&&(A="[SPACE] to unequip")),n.items[S]instanceof h.Usable&&(A="[SPACE] to use"),o.Game.ctx.fillStyle="white";var k=o.Game.measureText(A).width;o.Game.fillText(A,.5*(a.GameConstants.WIDTH-k),5);for(var P=n.items[S].getDescription().split("\n"),G=Math.round(.5*a.GameConstants.HEIGHT-.5*c+n.rows*(t+4+r)+2+2),L=0;L<P.length;L++)G=n.textWrap(P[L],5,G,a.GameConstants.WIDTH-10)}}},this.game=e,this.player=t,this.items=new Array,this.equipped=new Array,this.equipAnimAmount=[];for(var y=0;y<this.rows*this.cols;y++)this.equipAnimAmount[y]=0;this.coins=0,this.openTime=Date.now(),this.weapon=null;var v=function(e){e instanceof c.Weapon&&(e.setWielder(n.player),e.toggleEquip(),n.weapon=e),n.addItem(e)};v(new u.Dagger({game:this.game},0,0)),v(new p.Torch({game:this.game},0,0))}},8573:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Armor=void 0;var a=n(2967),i=n(5742),s=function(e){function t(n,r,o){var s=e.call(this,n,r,o)||this;return s.RECHARGE_TURNS=15,s.coEquippable=function(e){return!(e instanceof t)},s.getDescription=function(){return"ENCHANTED ARMOR\nA magic suit of armor. Absorbs one hit and regenerates after "+s.RECHARGE_TURNS+" turns."},s.tickInInventory=function(){s.rechargeTurnCounter>0&&(s.rechargeTurnCounter--,0===s.rechargeTurnCounter&&(s.rechargeTurnCounter=-1,s.health=1))},s.hurt=function(e){s.health<=0||(s.health-=e,s.rechargeTurnCounter=s.RECHARGE_TURNS+1)},s.drawGUI=function(e){-1===s.rechargeTurnCounter?a.Game.drawFX(5,2,1,1,e,i.LevelConstants.SCREEN_H-1,1,1):1-s.rechargeTurnCounter/s.RECHARGE_TURNS<.5?a.Game.drawFX(7,2,1,1,e,i.LevelConstants.SCREEN_H-1,1,1):a.Game.drawFX(8,2,1,1,e,i.LevelConstants.SCREEN_H-1,1,1)},s.health=1,s.rechargeTurnCounter=-1,s.tileX=5,s.tileY=0,s}return o(t,e),t}(n(8499).Equippable);t.Armor=s},8414:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.BlueGem=void 0;var a=function(e){function t(t,n,r){var o=e.call(this,t,n,r)||this;return o.getDescription=function(){return"SAPPHIRE"},o.tileX=13,o.tileY=0,o.stackable=!0,o}return o(t,e),t}(n(5234).Item);t.BlueGem=a},1173:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Candle=void 0;var a=n(8499),i=n(5895),s=n(282),l=function(e){function t(n,r,o){var a=e.call(this,n,r,o)||this;return a.coEquippable=function(e){return!(e instanceof t||e instanceof i.Torch||e instanceof s.Lantern)},a.toggleEquip=function(){a.equipped=!a.equipped,a.equipped?a.level.game.players[a.level.game.localPlayerID].sightRadius=9:a.level.game.players[a.level.game.localPlayerID].sightRadius=a.level.game.players[a.level.game.localPlayerID].defaultSightRadius},a.getDescription=function(){return"CANDLE"},a.tileX=27,a.tileY=0,a}return o(t,e),t}(a.Equippable);t.Candle=l},9809:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Coal=void 0;var a=function(e){function t(t,n,r){var o=e.call(this,t,n,r)||this;return o.getDescription=function(){return"COAL\nA lump of coal."},o.tileX=17,o.tileY=0,o.stackable=!0,o}return o(t,e),t}(n(5234).Item);t.Coal=a},1978:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Coin=void 0;var a=n(5234),i=n(5958),s=function(e){function t(t,n,r){var o=e.call(this,t,n,r)||this;return o.pickupSound=function(){o.level===o.level.game.level&&i.Sound.pickupCoin()},o.tileX=19,o.tileY=0,o.stackable=!0,o}return o(t,e),t}(a.Item);t.Coin=s},8499:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Equippable=void 0;var a=n(5234),i=n(2967),s=function(e){function t(t,n,r){var o=e.call(this,t,n,r)||this;return o.coEquippable=function(e){return!0},o.toggleEquip=function(){o.equipped=!o.equipped},o.drawEquipped=function(e,t){i.Game.drawItem(o.tileX,o.tileY,1,2,e,t-1,o.w,o.h)},o.equipped=!1,o}return o(t,e),t}(a.Item);t.Equippable=s},9825:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Gold=void 0;var a=function(e){function t(t,n,r){var o=e.call(this,t,n,r)||this;return o.getDescription=function(){return"GOLD\nA nugget of gold."},o.tileX=18,o.tileY=0,o.stackable=!0,o}return o(t,e),t}(n(5234).Item);t.Gold=a},1348:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.GoldenKey=void 0;var a=function(e){function t(t,n,r){var o=e.call(this,t,n,r)||this;return o.getDescription=function(){return"GOLD KEY\nA heavy gold key."},o.tileX=6,o.tileY=0,o}return o(t,e),t}(n(8499).Equippable);t.GoldenKey=a},7975:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.GreenGem=void 0;var a=function(e){function t(t,n,r){var o=e.call(this,t,n,r)||this;return o.getDescription=function(){return"EMERALD"},o.tileX=11,o.tileY=0,o.stackable=!0,o}return o(t,e),t}(n(5234).Item);t.GreenGem=a},6309:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Heart=void 0;var a=n(5958),i=function(e){function t(t,n,r){var o=e.call(this,t,n,r)||this;return o.onUse=function(e){e.health=Math.min(e.maxHealth,e.health+1),o.level.game.levels[e.levelID]===o.level.game.level&&a.Sound.heal(),o.level.items=o.level.items.filter((function(e){return e!==o}))},o.getDescription=function(){return"HEALTH POTION\nRestores 1 heart"},o.tileX=8,o.tileY=0,o.offsetY=0,o}return o(t,e),t}(n(1802).Usable);t.Heart=i},5234:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Item=void 0;var a=n(2967),i=n(988),s=n(5958),l=function(e){function t(t,n,r){var o=e.call(this)||this;return o.tick=function(){},o.tickInInventory=function(){},o.getDescription=function(){return""},o.pickupSound=function(){o.level===o.level.game.level&&s.Sound.genericPickup()},o.onPickup=function(e){o.pickedUp||(o.pickedUp=e.inventory.addItem(o),o.pickedUp&&o.pickupSound())},o.shadeAmount=function(){return o.level.softVis[o.x][o.y]},o.draw=function(){o.pickedUp||(o.scaleFactor<1?o.scaleFactor+=.04:o.scaleFactor=1,a.Game.drawItem(0,0,1,1,o.x,o.y,1,1),o.frame+=2*Math.PI/60,a.Game.drawItem(o.tileX,o.tileY,1,2,o.x+o.w*(-.5*o.scaleFactor+.5),o.y+.07*Math.sin(o.frame)-1+o.offsetY+o.h*(-.5*o.scaleFactor+.5),o.w*o.scaleFactor,o.h*o.scaleFactor,o.level.shadeColor,o.shadeAmount()))},o.drawTopLayer=function(){o.pickedUp&&(o.y-=.125,o.alpha-=.03,o.y<-1&&(o.level.items=o.level.items.filter((function(e){return e!==o}))),a.Game.ctx.globalAlpha=Math.max(0,o.alpha),a.Game.drawItem(o.tileX,o.tileY,1,2,o.x,o.y-1,o.w,o.h),a.Game.ctx.globalAlpha=1)},o.drawIcon=function(e,t,n){void 0===n&&(n=1),a.Game.ctx.globalAlpha=n,a.Game.drawItem(o.tileX,o.tileY,1,2,e,t-1,o.w,o.h),a.Game.ctx.globalAlpha=1;var r=o.stackCount<=1?"":""+o.stackCount,s=16-a.Game.measureText(r).width;a.Game.ctx.fillStyle="black";for(var l=-1;l<=1;l++)for(var c=-1;c<=1;c++)a.Game.ctx.fillStyle=i.GameConstants.OUTLINE,a.Game.fillText(r,e*i.GameConstants.TILESIZE+s+l,t*i.GameConstants.TILESIZE+10+c);a.Game.ctx.fillStyle="white",a.Game.fillText(r,e*i.GameConstants.TILESIZE+s,t*i.GameConstants.TILESIZE+10)},o.level=t,o.x=n,o.y=r,o.drawableY=r,o.w=1,o.h=2,o.tileX=0,o.tileY=0,o.frame=0,o.dead=!1,o.stackable=!1,o.stackCount=1,o.pickedUp=!1,o.alpha=1,o.scaleFactor=.2,o.offsetY=-.25,o}return o(t,e),t}(n(6779).Drawable);t.Item=l},1785:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Key=void 0;var a=function(e){function t(t,n,r){var o=e.call(this,t,n,r)||this;return o.getDescription=function(){return"KEY\nAn iron key."},o.tileX=1,o.tileY=0,o}return o(t,e),t}(n(8499).Equippable);t.Key=a},282:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Lantern=void 0;var a=n(8499),i=n(1173),s=n(5895),l=function(e){function t(n,r,o){var a=e.call(this,n,r,o)||this;return a.coEquippable=function(e){return!(e instanceof i.Candle||e instanceof s.Torch||e instanceof t)},a.toggleEquip=function(){a.equipped=!a.equipped,a.equipped?a.level.game.players[a.level.game.localPlayerID].sightRadius=20:a.level.game.players[a.level.game.localPlayerID].sightRadius=a.level.game.players[a.level.game.localPlayerID].defaultSightRadius},a.getDescription=function(){return"LANTERN"},a.tileX=29,a.tileY=0,a}return o(t,e),t}(a.Equippable);t.Lantern=l},5043:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.RedGem=void 0;var a=function(e){function t(t,n,r){var o=e.call(this,t,n,r)||this;return o.getDescription=function(){return"RUBY"},o.tileX=12,o.tileY=0,o.stackable=!0,o}return o(t,e),t}(n(5234).Item);t.RedGem=a},5895:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Torch=void 0;var a=n(8499),i=n(1173),s=n(282),l=function(e){function t(n,r,o){var a=e.call(this,n,r,o)||this;return a.coEquippable=function(e){return!(e instanceof i.Candle||e instanceof t||e instanceof s.Lantern)},a.toggleEquip=function(){a.equipped=!a.equipped,a.equipped?a.level.game.players[a.level.game.localPlayerID].sightRadius=12:a.level.game.players[a.level.game.localPlayerID].sightRadius=a.level.game.players[a.level.game.localPlayerID].defaultSightRadius},a.getDescription=function(){return"TORCH"},a.tileX=28,a.tileY=0,a}return o(t,e),t}(a.Equippable);t.Torch=l},1802:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Usable=void 0;var a=n(5234),i=n(5958),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onUse=function(e){e.health=Math.min(e.maxHealth,e.health+1),e.game.levels[e.levelID]===e.game.level&&i.Sound.heal()},t}return o(t,e),t}(a.Item);t.Usable=s},3161:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level=t.TurnState=t.RoomType=void 0;var r,o,a=n(312),i=n(5742),s=n(9626),l=n(2967),c=n(9143),u=n(5654),h=n(9732),p=n(1384),d=n(3441),f=n(1272),m=n(516),y=n(1348),v=n(953),g=n(5525),w=n(988),_=n(5397),C=n(8498),b=n(6750),E=n(6061),I=n(8573),T=n(3280),x=n(8341),O=n(5990),S=n(9670),A=n(7149),k=n(850),P=n(8084),G=n(6563),L=n(9382),D=n(8365),M=n(5377),R=n(9379),F=n(1902),j=n(1241),N=n(6945),X=n(3400),Y=n(2725),H=n(1656),B=n(6309),W=n(3806),U=n(6882);!function(e){e[e.DUNGEON=0]="DUNGEON",e[e.BIGDUNGEON=1]="BIGDUNGEON",e[e.TREASURE=2]="TREASURE",e[e.FOUNTAIN=3]="FOUNTAIN",e[e.COFFIN=4]="COFFIN",e[e.GRASS=5]="GRASS",e[e.PUZZLE=6]="PUZZLE",e[e.KEYROOM=7]="KEYROOM",e[e.CHESSBOARD=8]="CHESSBOARD",e[e.MAZE=9]="MAZE",e[e.CORRIDOR=10]="CORRIDOR",e[e.SPIKECORRIDOR=11]="SPIKECORRIDOR",e[e.UPLADDER=12]="UPLADDER",e[e.DOWNLADDER=13]="DOWNLADDER",e[e.SHOP=14]="SHOP",e[e.BIGCAVE=15]="BIGCAVE",e[e.CAVE=16]="CAVE",e[e.SPAWNER=17]="SPAWNER",e[e.ROPEHOLE=18]="ROPEHOLE",e[e.ROPECAVE=19]="ROPECAVE"}(r=t.RoomType||(t.RoomType={})),function(e){e[e.playerTurn=0]="playerTurn",e[e.computerTurn=1]="computerTurn"}(o=t.TurnState||(t.TurnState={}));var Z=function(){function e(e,t,n,h,d,m,v,g,_){var C=this;void 0===_&&(_=Math.random),this.shadeColor="black",this.tileInside=function(e,t){return C.pointInside(e,t,C.roomX,C.roomY,C.width,C.height)},this.generateDungeon=function(e){C.skin=p.SkinType.DUNGEON;var t=l.Game.rand(1,36,e);C.buildEmptyRoom(),t<30&&C.addWallBlocks(e),t<26&&C.addFingers(e),t%4==0&&C.addChasms(e),C.fixWalls(),C.addTorches(l.Game.randTable([0,0,0,1,1,2,2,3,4],e),e),t%3==0&&C.addPlants(l.Game.randTable([0,0,0,0,0,1,1,2,2,3,4],e),e),t>15&&C.addSpikeTraps(l.Game.randTable([0,0,0,1,1,2,5],e),e);var n=C.getEmptyTiles().length,r=Math.ceil(n*(.25*C.depth+.5)*l.Game.randTable([.01,.05,.05,.06,.07,.1],e));C.addEnemies(r,e),r>0?C.addObstacles(r/l.Game.rand(1,2,e),e):C.addObstacles(l.Game.randTable([0,0,1,1,2,3,5],e),e)},this.generateBigDungeon=function(e){C.skin=p.SkinType.DUNGEON,C.buildEmptyRoom(),1===l.Game.rand(1,4,e)&&C.addChasms(e),C.fixWalls(),C.addTorches(l.Game.randTable([0,0,0,1,1,2,2,3,4],e),e),1===l.Game.rand(1,4,e)&&C.addPlants(l.Game.randTable([0,0,0,0,0,1,1,2,2,3,4],e),e),1===l.Game.rand(1,3,e)&&C.addSpikeTraps(l.Game.randTable([3,5,7,8],e),e);var t=C.getEmptyTiles().length,n=Math.ceil(t*(.5*C.depth+.5)*l.Game.randTable([.05,.05,.06,.07,.1],e));C.addEnemies(n,e),n>0?C.addObstacles(n/l.Game.rand(1,2,e),e):C.addObstacles(l.Game.randTable([0,0,1,1,2,3,5],e),e)},this.generateSpawner=function(e){C.skin=p.SkinType.DUNGEON,C.buildEmptyRoom(),C.fixWalls(),C.addTorches(l.Game.randTable([0,0,0,1,1,2,2,3,4],e),e),C.enemies.push(new j.Spawner(C,C.game,Math.floor(C.roomX+C.width/2),Math.floor(C.roomY+C.height/2),e))},this.generateKeyRoom=function(e){C.skin=p.SkinType.DUNGEON,C.buildEmptyRoom(),C.fixWalls(),C.addTorches(l.Game.randTable([0,0,0,1,1,2,2,3,4],e),e),C.items.push(new y.GoldenKey(C,Math.floor(C.roomX+C.width/2),Math.floor(C.roomY+C.height/2)))},this.generateFountain=function(e){C.skin=p.SkinType.DUNGEON,C.buildEmptyRoom(),C.fixWalls(),C.addTorches(l.Game.randTable([0,0,0,1,1,2,2,3,4],e),e);for(var t=Math.floor(C.roomX+C.width/2),n=Math.floor(C.roomY+C.height/2),r=t-1;r<=t+1;r++)for(var o=n-1;o<=n+1;o++)C.levelArray[r][o]=new x.FountainTile(C,r,o,r-(t-1),o-(n-1));C.addPlants(l.Game.randTable([0,0,1,2],e),e)},this.placeCoffin=function(e,t){C.levelArray[e][t]=new O.CoffinTile(C,e,t,0),C.levelArray[e][t+1]=new O.CoffinTile(C,e,t+1,1)},this.generateCoffin=function(e){C.skin=p.SkinType.DUNGEON,C.buildEmptyRoom(),C.fixWalls(),C.addTorches(l.Game.randTable([0,0,0,1,1,2,2,3,4],e),e),C.placeCoffin(Math.floor(C.roomX+C.width/2-2),Math.floor(C.roomY+C.height/2)),C.placeCoffin(Math.floor(C.roomX+C.width/2),Math.floor(C.roomY+C.height/2)),C.placeCoffin(Math.floor(C.roomX+C.width/2)+2,Math.floor(C.roomY+C.height/2))},this.generatePuzzle=function(e){var t;C.skin=p.SkinType.DUNGEON,C.buildEmptyRoom();for(var n=C.roomX;n<C.roomX+C.width;n++){var r=C.roomY+Math.floor(C.height/2);n===C.roomX+Math.floor(C.width/2)?(t=new A.InsideLevelDoor(C,C.game,n,r+1),C.levelArray[n][r+1]=t):C.levelArray[n][r]=new a.Wall(C,n,r,0)}var o=l.Game.rand(C.roomX,C.roomX+C.width-1,e),i=l.Game.rand(C.roomY+Math.floor(C.height/2)+3,C.roomY+C.height-2,e);C.levelArray[o][i]=new k.Button(C,o,i,t);for(var s=C.getEmptyMiddleTiles().filter((function(e){return e.x>=C.roomX+1&&e.x<=C.roomX+C.width-2&&e.y>=C.roomY+Math.floor(C.height/2)+3&&e.y<=C.roomY+C.height-2})),c=l.Game.randTable([1,2,2,3,4],e),u=0;u<c;u++){var h=s.splice(l.Game.rand(0,s.length-1,e),1)[0];C.enemies.push(new E.Crate(C,C.game,h.x,h.y))}C.fixWalls(),C.addPlants(l.Game.randTable([0,0,0,0,0,1,1,2,2,3,4],e),e)},this.generateSpikeCorridor=function(e){C.skin=p.SkinType.DUNGEON,C.buildEmptyRoom();for(var t=C.roomX;t<C.roomX+C.width;t++)for(var n=C.roomY+1;n<C.roomY+C.height-1;n++)C.levelArray[t][n]=new T.SpikeTrap(C,t,n,l.Game.rand(0,3,e));C.fixWalls(),C.addTorches(l.Game.randTable([0,0,0,1,1,2,2,3,4],e),e)},this.generateTreasure=function(e){C.skin=p.SkinType.DUNGEON,C.buildEmptyRoom(),C.addWallBlocks(e),C.fixWalls(),C.addTorches(l.Game.randTable([0,1,1,2,2,3,4],e),e),C.addChests(l.Game.randTable([3,4,4,4,4,4,4,5,5,5,6],e),e),C.addPlants(l.Game.randTable([0,1,2,4,5,6],e),e)},this.generateChessboard=function(e){C.skin=p.SkinType.DUNGEON,C.buildEmptyRoom(),C.fixWalls()},this.generateCave=function(e){C.skin=p.SkinType.CAVE;var t=l.Game.rand(1,36,e);C.buildEmptyRoom(),t<30&&C.addWallBlocks(e),t<26&&C.addFingers(e),t%4==0&&C.addChasms(e),C.fixWalls(),t>15&&C.addSpikeTraps(l.Game.randTable([0,0,0,1,1,2,5],e),e);var n=C.getEmptyTiles().length,r=Math.ceil(n*(.2*C.depth+.5)*l.Game.randTable([.03,.04,.06,.07,.08],e));C.addEnemies(r,e),C.addResources(l.Game.randTable([1,2,2,3,4,4,5,6,6,7,7,7,8,8,9,10,11,12],e),e)},this.generateUpLadder=function(e){C.skin=p.SkinType.DUNGEON,C.buildEmptyRoom(),C.fixWalls(),C.addTorches(l.Game.randTable([0,0,0,1,1,2,2],e),e);var t=Math.floor(C.roomX+C.width/2),n=Math.floor(C.roomY+C.height/2);C.upLadder=new G.UpLadder(C,C.game,t,n),C.levelArray[t][n]=C.upLadder},this.generateDownLadder=function(e){C.skin=p.SkinType.DUNGEON,C.buildEmptyRoom(),C.fixWalls(),C.addTorches(l.Game.randTable([0,0,0,1,1,2,2],e),e);var t=Math.floor(C.roomX+C.width/2),n=Math.floor(C.roomY+C.height/2);C.levelArray[t][n]=new L.DownLadder(C,C.game,t,n)},this.generateRopeHole=function(e){C.skin=p.SkinType.DUNGEON,C.buildEmptyRoom(),C.fixWalls(),C.addTorches(l.Game.randTable([0,0,0,1,1,2,2],e),e);var t=Math.floor(C.roomX+C.width/2),n=Math.floor(C.roomY+C.height/2),r=new L.DownLadder(C,C.game,t,n);r.isRope=!0,C.levelArray[t][n]=r},this.generateRopeCave=function(e){C.skin=p.SkinType.CAVE,C.buildEmptyRoom(),C.fixWalls();var t=Math.floor(C.roomX+C.width/2),n=Math.floor(C.roomY+C.height/2);C.upLadder=new G.UpLadder(C,C.game,t,n),C.upLadder.isRope=!0,C.levelArray[t][n]=C.upLadder},this.generateShop=function(e){C.skin=p.SkinType.DUNGEON,C.buildEmptyRoom(),C.fixWalls(),C.addTorches(2,e);var t=Math.floor(C.roomX+C.width/2),n=Math.floor(C.roomY+C.height/2);C.enemies.push(new N.VendingMachine(C,C.game,t-2,n-1,new H.Shotgun(C,0,0),e)),C.enemies.push(new N.VendingMachine(C,C.game,t+2,n-1,new B.Heart(C,0,0),e)),C.enemies.push(new N.VendingMachine(C,C.game,t-2,n+2,new I.Armor(C,0,0),e)),C.enemies.push(new N.VendingMachine(C,C.game,t+2,n+2,new W.Spear(C,0,0),e))},this.addDoor=function(e,t){var n;switch(e){case 0:n=new c.Door(C,C.game,C.roomX,C.roomY,t);break;case 1:n=new c.Door(C,C.game,C.roomX+Math.floor(C.width/2),C.roomY,t);break;case 2:n=new c.Door(C,C.game,C.roomX+C.width-1,C.roomY,t);break;case 3:C.levelArray[C.roomX][C.roomY+C.height]=new s.Floor(C,C.roomX,C.roomY+C.height),n=new u.BottomDoor(C,C.game,C.roomX,C.roomY+C.height,t);break;case 4:C.levelArray[C.roomX+Math.floor(C.width/2)][C.roomY+C.height]=new s.Floor(C,C.roomX+Math.floor(C.width/2),C.roomY+C.height),n=new u.BottomDoor(C,C.game,C.roomX+Math.floor(C.width/2),C.roomY+C.height,t);break;case 5:C.levelArray[C.roomX+C.width-1][C.roomY+C.height]=new s.Floor(C,C.roomX+C.width-1,C.roomY+C.height),n=new u.BottomDoor(C,C.game,C.roomX+C.width-1,C.roomY+C.height,t);break;case 6:C.levelArray[C.roomX][C.roomY+1]instanceof a.Wall&&(C.levelArray[C.roomX][C.roomY+2]=new s.Floor(C,C.roomX,C.roomY+2)),C.levelArray[C.roomX][C.roomY+1]=new s.Floor(C,C.roomX,C.roomY+1),n=new U.SideDoor(C,C.game,C.roomX-1,C.roomY+1,t);break;case 7:C.levelArray[C.roomX][C.roomY+Math.floor(C.height/2)]instanceof a.Wall&&(C.levelArray[C.roomX][C.roomY+Math.floor(C.height/2)+1]=new s.Floor(C,C.roomX,C.roomY+Math.floor(C.height/2)+1)),C.levelArray[C.roomX][C.roomY+Math.floor(C.height/2)]=new s.Floor(C,C.roomX,C.roomY+Math.floor(C.height/2)),n=new U.SideDoor(C,C.game,C.roomX-1,C.roomY+Math.floor(C.height/2),t);break;case 8:C.levelArray[C.roomX][C.roomY+C.height-1]=new s.Floor(C,C.roomX,C.roomY+C.height-1),n=new U.SideDoor(C,C.game,C.roomX-1,C.roomY+C.height-1,t);break;case 9:C.levelArray[C.roomX+C.width-1][C.roomY+1]instanceof a.Wall&&(C.levelArray[C.roomX+C.width-1][C.roomY+2]=new s.Floor(C,C.roomX+C.width-1,C.roomY+2)),C.levelArray[C.roomX+C.width-1][C.roomY+1]=new s.Floor(C,C.roomX+C.width-1,C.roomY+1),n=new U.SideDoor(C,C.game,C.roomX+C.width,C.roomY+1,t);break;case 10:C.levelArray[C.roomX+C.width-1][C.roomY+Math.floor(C.height/2)]instanceof a.Wall&&(C.levelArray[C.roomX+C.width-1][C.roomY+Math.floor(C.height/2)+1]=new s.Floor(C,C.roomX+C.width-1,C.roomY+Math.floor(C.height/2)+1)),C.levelArray[C.roomX+C.width-1][C.roomY+Math.floor(C.height/2)]=new s.Floor(C,C.roomX+C.width-1,C.roomY+Math.floor(C.height/2)),n=new U.SideDoor(C,C.game,C.roomX+C.width,C.roomY+Math.floor(C.height/2),t);break;case 11:C.levelArray[C.roomX+C.width-1][C.roomY+C.height-1]=new s.Floor(C,C.roomX+C.width-1,C.roomY+C.height-1),n=new U.SideDoor(C,C.game,C.roomX+C.width,C.roomY+C.height-1,t)}return C.doors.push(n),null==C.levelArray[n.x]&&(console.log("UNDEFINED at "+n.x+" levelArray.length was "+C.levelArray.length),console.log("location "+e),console.log(C.roomX,C.roomY),console.log(C.width,C.height)),C.levelArray[n.x][n.y]=n,n},this.exitLevel=function(){C.particles.splice(0,C.particles.length)},this.updateLevelTextColor=function(){i.LevelConstants.LEVEL_TEXT_COLOR="white"},this.enterLevel=function(e){C.updateLevelTextColor(),e.moveSnap(C.roomX+Math.floor(C.width/2),C.roomY+C.height-1),C.updateLighting(),C.entered=!0,C.message=C.name},this.enterLevelThroughDoor=function(e,t,n){C.updateLevelTextColor(),t instanceof c.Door?(t.opened=!0,e.moveNoSmooth(t.x,t.y+1)):t instanceof u.BottomDoor?e.moveNoSmooth(t.x,t.y-1):t instanceof U.SideDoor&&e.moveNoSmooth(t.x+n,t.y),C.updateLighting(),C.entered=!0,C.message=C.name},this.enterLevelThroughLadder=function(e,t){C.updateLevelTextColor(),e.moveSnap(t.x,t.y+1),C.updateLighting(),C.entered=!0,C.message=C.name},this.getEmptyMiddleTiles=function(){for(var e=[],t=C.roomX;t<C.roomX+C.width;t++)for(var n=C.roomY+2;n<C.roomY+C.height-1;n++)C.levelArray[t][n].isSolid()||C.levelArray[t][n]instanceof T.SpikeTrap||e.push(C.levelArray[t][n]);for(var r=function(t){e=e.filter((function(e){return e.x!==t.x||e.y!==t.y}))},o=0,a=C.enemies;o<a.length;o++)r(a[o]);return e},this.getEmptyTiles=function(){for(var e=[],t=C.roomX;t<C.roomX+C.width;t++)for(var n=C.roomY+1;n<C.roomY+C.height;n++)C.levelArray[t][n].isSolid()||C.levelArray[t][n]instanceof T.SpikeTrap||e.push(C.levelArray[t][n]);for(var r=function(t){e=e.filter((function(e){return e.x!==t.x||e.y!==t.y}))},o=0,a=C.enemies;o<a.length;o++)r(a[o]);return e},this.getTile=function(e,t){for(var n=0,r=C.levelArray;n<r.length;n++)for(var o=0,a=r[n];o<a.length;o++){var i=a[o];if(null!==i&&i.x===e&&i.y===t)return i}return null},this.fadeLighting=function(){for(var e=0;e<C.levelArray.length;e++)for(var t=0;t<C.levelArray[0].length;t++)Math.abs(C.softVis[e][t]-C.vis[e][t])>=.02&&(C.softVis[e][t]<C.vis[e][t]?C.softVis[e][t]+=.02:C.softVis[e][t]>C.vis[e][t]&&(C.softVis[e][t]-=.02))},this.updateLighting=function(){for(var e=[],t=0;t<C.levelArray.length;t++){e[t]=[];for(var n=0;n<C.levelArray[0].length;n++)e[t][n]=C.vis[t][n],C.vis[t][n]=1}for(var r=0;r<360;r+=i.LevelConstants.LIGHTING_ANGLE_STEP)C.castShadowsAtAngle(r,C.game.players[C.game.localPlayerID].x+.5,C.game.players[C.game.localPlayerID].y+.5,C.game.players[C.game.localPlayerID].sightRadius-C.depth);for(var o=0,a=C.lightSources;o<a.length;o++){var s=a[o];for(r=0;r<360;r+=i.LevelConstants.LIGHTING_ANGLE_STEP)C.castShadowsAtAngle(r,s.x,s.y,s.r)}i.LevelConstants.SMOOTH_LIGHTING&&(C.vis=C.blur3x3(C.vis,[[1,2,1],[2,8,2],[1,2,1]]))},this.castShadowsAtAngle=function(e,t,n,r){for(var o=Math.cos(e*Math.PI/180),i=Math.sin(e*Math.PI/180),s=0;s<r;s++){if(Math.floor(t)<0||Math.floor(t)>=C.levelArray.length||Math.floor(n)<0||Math.floor(n)>=C.levelArray[0].length)return;var l=C.levelArray[Math.floor(t)][Math.floor(n)];if(l.isOpaque()||l instanceof a.Wall&&1===l.type)return;C.vis[Math.floor(t)][Math.floor(n)]=Math.min(C.vis[Math.floor(t)][Math.floor(n)],Math.min(s/r,1)),t+=o,n+=i}},this.blur3x3=function(e,t){for(var n=[],r=0;r<e.length;r++){n[r]=[];for(var o=0;o<e[0].length;o++)if(0!==e[r][o]){for(var a=0,i=0,s=-1;s<=1;s++)for(var l=-1;l<=1;l++)r+s>=0&&r+s<e.length&&o+l>=0&&o+l<e[0].length&&(a+=e[r+s][o+l]*t[s+1][l+1],i+=t[s+1][l+1]);n[r][o]=a/i}else n[r][o]=0}return n},this.catchUp=function(){C.turn===o.computerTurn&&C.computerTurn()},this.tick=function(e){C.enemies=C.enemies.filter((function(e){return!e.dead})),C.updateLighting();for(var t=0,n=C.projectiles;t<n.length;t++){var r=n[t];r instanceof P.HitWarning&&e!==C.game.players[C.game.localPlayerID]||r.tick()}for(var a=0;a<C.levelArray.length;a++)for(var i=0;i<C.levelArray[0].length;i++)C.levelArray[a][i].tick();C.turn=o.computerTurn,C.playerTurnTime=Date.now(),C.playerTicked=e},this.update=function(){C.turn==o.computerTurn&&Date.now()-C.playerTurnTime>=i.LevelConstants.COMPUTER_TURN_DELAY&&C.computerTurn()},this.computerTurn=function(){for(var e=0,t=C.enemies;e<t.length;e++)(h=t[e]).tick();for(var n=0,r=C.items;n<r.length;n++)(l=r[n]).tick();for(var a=0,i=C.projectiles;a<i.length;a++){var s=i[a];for(var l in C.levelArray[s.x][s.y].isSolid()&&(s.dead=!0),C.game.players)C.game.levels[C.game.players[l].levelID]===C&&s.x===C.game.players[l].x&&s.y===C.game.players[l].y&&s.hitPlayer(C.game.players[l]);for(var c=0,u=C.enemies;c<u.length;c++){var h=u[c];s.x===h.x&&s.y===h.y&&s.hitEnemy(h)}}for(var p=0;p<C.levelArray.length;p++)for(var d=0;d<C.levelArray[0].length;d++)C.levelArray[p][d].tickEnd();C.playerTicked.finishTick(),C.turn=o.playerTurn},this.draw=function(){P.HitWarning.updateFrame(),C.fadeLighting();for(var e=C.roomX-1;e<C.roomX+C.width+1;e++)for(var t=C.roomY-1;t<C.roomY+C.height+1;t++)C.softVis[e][t]<1&&C.levelArray[e][t].draw()},this.drawEntitiesBehindPlayer=function(){for(var e=0;e<C.levelArray.length;e++)for(var t=0;t<C.levelArray[0].length;t++)C.softVis[e][t]<1&&C.levelArray[e][t].drawUnderPlayer();C.projectiles=C.projectiles.filter((function(e){return!e.dead})),C.particles=C.particles.filter((function(e){return!e.dead}));var n=new Array;(n=n.concat(C.enemies,C.projectiles,C.particles,C.items)).sort((function(e,t){return e.drawableY-t.drawableY==0?e instanceof f.Enemy?1:t instanceof f.Enemy?-1:0:e.drawableY-t.drawableY}));for(var r=0,o=n;r<o.length;r++){var a=o[r];a.drawableY<=C.game.players[C.game.localPlayerID].y&&a.draw()}},this.drawEntitiesInFrontOfPlayer=function(){for(var e=0;e<C.levelArray.length;e++)for(var t=0;t<C.levelArray[0].length;t++)C.softVis[e][t]<1&&C.levelArray[e][t].drawAbovePlayer();var n=new Array;(n=n.concat(C.enemies,C.projectiles,C.particles,C.items)).sort((function(e,t){return e.drawableY-t.drawableY==0?e instanceof f.Enemy?1:t instanceof f.Enemy?-1:0:e.drawableY-t.drawableY}));for(var r=0,o=n;r<o.length;r++){var a=o[r];a.drawableY>C.game.players[C.game.localPlayerID].y&&a.draw()}for(var i=0,s=C.items;i<s.length;i++)s[i].drawTopLayer()},this.drawShade=function(){var e=Math.max(0,Math.min(.8,2*C.depth/C.game.players[C.game.localPlayerID].sightRadius));l.Game.ctx.globalAlpha=e,l.Game.ctx.fillStyle=C.shadeColor,l.Game.ctx.fillRect((C.roomX-i.LevelConstants.SCREEN_W)*w.GameConstants.TILESIZE,(C.roomY-i.LevelConstants.SCREEN_H)*w.GameConstants.TILESIZE,(C.width+2*i.LevelConstants.SCREEN_W)*w.GameConstants.TILESIZE,(C.height+2*i.LevelConstants.SCREEN_H)*w.GameConstants.TILESIZE),l.Game.ctx.globalAlpha=1,l.Game.ctx.globalCompositeOperation="source-over"},this.drawOverShade=function(){for(var e=0,t=C.enemies;e<t.length;e++)t[e].drawTopLayer();for(var n=0,r=C.projectiles;n<r.length;n++)r[n].drawTopLayer();for(var o=0;o<C.levelArray.length;o++)for(var a=0;a<C.levelArray[0].length;a++)C.levelArray[o][a].drawAboveShading()},this.drawTopLayer=function(){var e=l.Game.ctx.font;l.Game.ctx.font=w.GameConstants.SCRIPT_FONT_SIZE+"px Script",l.Game.ctx.fillStyle=i.LevelConstants.LEVEL_TEXT_COLOR,l.Game.fillText(C.message,w.GameConstants.WIDTH/2-l.Game.measureText(C.name).width/2,5),l.Game.ctx.font=e},this.game=e,this.x=t,this.y=n,this.width=h,this.height=d,this.type=m,this.depth=v,this.group=g,this.entered=!1,this.turn=o.playerTurn,this.playerTurnTime=Date.now(),this.items=Array(),this.projectiles=Array(),this.particles=Array(),this.doors=Array(),this.enemies=Array(),this.lightSources=Array(),this.levelArray=[];for(var b=0;b<h+6;b++)this.levelArray[b]=[];this.vis=[],this.softVis=[];for(var S=0;S<h+6;S++){this.vis[S]=[],this.softVis[S]=[];for(var D=0;D<d+6;D++)this.vis[S][D]=1,this.softVis[S][D]=1}switch(this.roomX=2,this.roomY=2,this.upLadder=null,this.name="",this.type){case r.DUNGEON:this.generateDungeon(_);break;case r.BIGDUNGEON:this.generateBigDungeon(_);break;case r.FOUNTAIN:this.generateFountain(_);break;case r.COFFIN:this.generateCoffin(_);break;case r.PUZZLE:this.generatePuzzle(_);break;case r.SPIKECORRIDOR:this.generateSpikeCorridor(_);break;case r.TREASURE:this.generateTreasure(_);break;case r.CHESSBOARD:this.generateChessboard(_);break;case r.KEYROOM:this.generateKeyRoom(_);break;case r.GRASS:this.generateDungeon(_);break;case r.BIGCAVE:this.generateCave(_);case r.CAVE:this.generateCave(_);break;case r.UPLADDER:this.generateUpLadder(_),this.name="FLOOR "+-this.depth;break;case r.DOWNLADDER:this.generateDownLadder(_),this.name="FLOOR "+-this.depth;break;case r.ROPEHOLE:this.generateRopeHole(_);break;case r.ROPECAVE:this.generateRopeCave(_);break;case r.SHOP:this.generateShop(_);break;case r.SPAWNER:this.generateSpawner(_)}}return e.prototype.pointInside=function(e,t,n,r,o,a){return!(e<n||e>=n+o||t<r||t>=r+a)},e.prototype.fixWalls=function(){for(var e=this.roomX;e<this.roomX+this.width;e++)this.levelArray[e][this.roomY+1]=new s.Floor(this,e,this.roomY+1),this.levelArray[e][this.roomY+this.height-1]=new s.Floor(this,e,this.roomY+this.height-1);for(e=0;e<this.levelArray.length;e++)for(var t=0;t<this.levelArray[0].length;t++)this.levelArray[e][t]instanceof a.Wall&&(this.levelArray[e][t+1]instanceof s.Floor||this.levelArray[e][t+1]instanceof v.SpawnFloor)&&(this.levelArray[e][t+2]instanceof s.Floor||this.levelArray[e][t+2]instanceof v.SpawnFloor?this.levelArray[e][t+1]=new h.WallSide(this,e,t+1):this.levelArray[e][t-1]instanceof a.Wall?this.levelArray[e][t]=new h.WallSide(this,e,t):this.levelArray[e][t]=new s.Floor(this,e,t))},e.prototype.buildEmptyRoom=function(){for(var e=0;e<this.width+6;e++)for(var t=0;t<this.height+6;t++)this.levelArray[e][t]=new a.Wall(this,e,t,1);for(e=0;e<this.width+6;e++)for(t=0;t<this.height+6;t++)this.pointInside(e,t,this.roomX,this.roomY,this.width,this.height)&&(this.levelArray[e][t]=new s.Floor(this,e,t));for(e=0;e<this.width+6;e++)for(t=0;t<this.height+6;t++)this.pointInside(e,t,this.roomX-1,this.roomY-1,this.width+2,this.height+2)&&(this.pointInside(e,t,this.roomX,this.roomY,this.width,this.height)||(this.levelArray[e][t]=new a.Wall(this,e,t,0)))},e.prototype.addWallBlocks=function(e){for(var t=l.Game.randTable([0,1,1,2,2,2,2,3,3],e),n=0;n<t;n++)for(var r=Math.min(l.Game.randTable([2,2,2,2,2,2,3,3,3,4,5,6,7,9],e),this.width-2),o=Math.min(r+l.Game.rand(-1,1,e),this.height-3),i=l.Game.rand(this.roomX+1,this.roomX+this.width-r-2,e),s=l.Game.rand(this.roomY+2,this.roomY+this.height-o-2,e),c=i;c<i+r;c++)for(var u=s;u<s+o;u++)this.levelArray[c][u]=new a.Wall(this,c,u,0)},e.prototype.addFingers=function(e){var t=l.Game.randTable([0,1,1,2,2,3,4,5],e);l.Game.rand(1,13,e)>this.width&&(t+=.3*this.width);for(var n=0;n<t;n++){var r=0,o=0,i=0,c=0;if(0===l.Game.rand(0,1,e))if(i=l.Game.rand(1,this.width-1,e),c=1,0===l.Game.rand(0,1,e)){r=this.roomX,o=l.Game.rand(this.roomY+2,this.roomY+this.height-c-2,e);for(var u=r;u<r+i+1;u++)for(var h=o-2;h<o+c+2;h++)this.levelArray[u][h]=new s.Floor(this,u,h);for(u=r;u<r+i;u++)for(h=o;h<o+c;h++)this.levelArray[u][h]=new a.Wall(this,u,h,0)}else{for(r=this.roomX+this.width-i,o=l.Game.rand(this.roomY+2,this.roomY+this.height-c-2,e),u=r-1;u<r+i;u++)for(h=o-2;h<o+c+2;h++)this.levelArray[u][h]=new s.Floor(this,u,h);for(u=r;u<r+i;u++)for(h=o;h<o+c;h++)this.levelArray[u][h]=new a.Wall(this,u,h,0)}else if(i=1,c=l.Game.rand(1,this.height-4,e),0===l.Game.rand(0,1,e)){for(o=this.roomY+2,u=(r=l.Game.rand(this.roomX+2,this.roomX+this.width-3,e))-1;u<r+i+1;u++)for(h=o+1;h<o+c+2;h++)this.levelArray[u][h]=new s.Floor(this,u,h);for(u=r;u<r+i;u++)for(h=o;h<o+c;h++)this.levelArray[u][h]=new a.Wall(this,u,h,0)}else{for(o=this.roomY+this.height-c-1,u=(r=l.Game.rand(this.roomX+2,this.roomX+this.width-3,e))-1;u<r+i+1;u++)for(h=o-2;h<o+c;h++)this.levelArray[u][h]=new s.Floor(this,u,h);for(u=r;u<r+i;u++)for(h=o;h<o+c;h++)this.levelArray[u][h]=new a.Wall(this,u,h,0)}}},e.prototype.addTorches=function(e,t){for(var n=[],r=0;r<this.levelArray.length;r++)for(var o=0;o<this.levelArray[0].length;o++)this.levelArray[r][o]instanceof h.WallSide&&n.push(this.levelArray[r][o]);for(var a=0;a<e;a++){var i,s,c;if(0==n.length)return;s=(i=n.splice(l.Game.rand(0,n.length-1,t),1)[0]).x,c=i.y,this.levelArray[s][c]=new X.WallSideTorch(this,s,c)}},e.prototype.addChasms=function(e){var t=l.Game.rand(2,4,e),n=l.Game.rand(2,4,e),r=this.roomX+1,o=this.roomX+this.width-t-1,a=this.roomY+2,i=this.roomY+this.height-n-1;if(!(o<r||i<a))for(var c=l.Game.rand(r,o,e),u=l.Game.rand(a,i,e),h=c-1;h<c+t+1;h++)for(var p=u-1;p<u+n+1;p++)this.levelArray[h][p]=h===c-1||h===c+t||p===u-1||p===u+n?new s.Floor(this,h,p):new F.Chasm(this,h,p,h===c,h===c+t-1,p===u,p===u+n-1)},e.prototype.addChests=function(e,t){for(var n=this.getEmptyMiddleTiles(),r=0;r<e;r++){var o,a,i;if(0==n.length)return;a=(o=n.splice(l.Game.rand(0,n.length-1,t),1)[0]).x,i=o.y,this.enemies.push(new m.Chest(this,this.game,a,i,t))}},e.prototype.addSpikeTraps=function(e,t){for(var n=this.getEmptyMiddleTiles(),r=0;r<e;r++){var o=n.splice(l.Game.rand(0,n.length-1,t),1)[0];if(0==n.length)return;var a=o.x,i=o.y;this.levelArray[a][i]=new T.SpikeTrap(this,a,i)}},e.prototype.addSpikes=function(e,t){for(var n=this.getEmptyMiddleTiles(),r=0;r<e;r++){var o=n.splice(l.Game.rand(0,n.length-1,t),1)[0];if(0==n.length)return;var a=o.x,i=o.y;this.levelArray[a][i]=new g.Spike(this,a,i)}},e.prototype.addEnemies=function(e,t){for(var n=this.getEmptyMiddleTiles(),r=0;r<e;r++){var o=n.splice(l.Game.rand(0,n.length-1,t),1)[0];if(0==n.length)return;var a=o.x,i=o.y;if(0!==this.depth)switch(Math.min(this.depth,l.Game.randTable([1,1,1,2,2,2,3,3,4,4],t))){case 1:this.enemies.push(new d.KnightEnemy(this,this.game,a,i,t));break;case 2:var s=new C.SkullEnemy(this,this.game,a,i,t);s.skipNextTurns=1,this.enemies.push(s);break;case 3:this.enemies.push(new _.WizardEnemy(this,this.game,a,i,t));break;case 4:this.enemies.push(new j.Spawner(this,this.game,a,i,t));break;case 5:this.enemies.push(new Y.ChargeEnemy(this,this.game,a,i))}}},e.prototype.addObstacles=function(e,t){for(var n=this.getEmptyMiddleTiles(),r=0;r<e;r++){var o=n.splice(l.Game.rand(0,n.length-1,t),1)[0];if(0==n.length)return;var a=o.x,i=o.y;switch(l.Game.randTable([1,1,2],t)){case 1:this.enemies.push(new E.Crate(this,this.game,a,i));break;case 2:this.enemies.push(new b.Barrel(this,this.game,a,i))}}},e.prototype.addPlants=function(e,t){for(var n=this.getEmptyMiddleTiles(),r=0;r<e;r++){var o=n.splice(l.Game.rand(0,n.length-1,t),1)[0];if(0==n.length)return;var a=o.x,i=o.y;this.enemies.push(new S.PottedPlant(this,this.game,a,i))}},e.prototype.addResources=function(e,t){for(var n=this.getEmptyMiddleTiles(),r=0;r<e;r++){var o=n.splice(l.Game.rand(0,n.length-1,t),1)[0];if(0==n.length)return;var a=o.x,i=o.y,s=t();s<=(10-Math.pow(this.depth,3))/10?this.enemies.push(new D.CoalResource(this,this.game,a,i)):s<=(10-Math.pow(this.depth-2,3))/10?this.enemies.push(new M.GoldResource(this,this.game,a,i)):this.enemies.push(new R.EmeraldResource(this,this.game,a,i))}},e}();t.Level=Z},5742:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LevelConstants=void 0;var n=function(){function e(){}return e.SCREEN_W=1,e.SCREEN_H=1,e.COMPUTER_TURN_DELAY=250,e.TURN_TIME=1e3,e.LEVEL_TRANSITION_TIME=300,e.LEVEL_TRANSITION_TIME_LADDER=1e3,e.ROOM_COUNT=15,e.HEALTH_BAR_FADEIN=100,e.HEALTH_BAR_FADEOUT=100,e.HEALTH_BAR_TOTALTIME=2500,e.SHADED_TILE_CUTOFF=1,e.SMOOTH_LIGHTING=!1,e.MIN_VISIBILITY=2,e.LIGHTING_ANGLE_STEP=5,e.LEVEL_TEXT_COLOR="white",e}();t.LevelConstants=n},569:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LevelGenerator=void 0;var r=n(2967),o=n(3161),a=n(792),i=[3,3,4,4,5,5,5,6,6,6,7,7,7,8,8,8,13],s=function(e,t,n){this.type=e,this.difficulty=t,this.children=n},l=function(){var e=this;this.collides=function(t){return!(e.x>t.x+t.w||e.x+e.w<t.x||e.y>=t.y+t.h||e.y+e.h<=t.y)},this.getPoints=function(){return[{x:e.x,y:e.y},{x:Math.floor(e.x+e.w/2),y:e.y},{x:e.x+e.w-1,y:e.y},{x:e.x,y:e.y+e.h},{x:Math.floor(e.x+e.w/2),y:e.y+e.h},{x:e.x+e.w-1,y:e.y+e.h},{x:e.x-1,y:e.y+1},{x:e.x-1,y:Math.floor(e.y+e.h/2)},{x:e.x-1,y:e.y+e.h-1},{x:e.x+e.w,y:e.y+1},{x:e.x+e.w,y:Math.floor(e.y+e.h/2)},{x:e.x+e.w,y:e.y+e.h-1}]},this.getDoors=function(){return e.doors},this.generateAroundPoint=function(t,n,r,o,a){e.x=0,e.y=0,o?(e.w=o,e.h=a):(e.w=i[Math.floor(t()*i.length)],e.h=i[Math.floor(t()*i.length)]);var s;s=0===r||1===r||2===r?3+Math.floor(3*t()):3===r||4===r||5===r?Math.floor(3*t()):6===r||7===r||8===r?9+Math.floor(3*t()):6+Math.floor(3*t());var l=e.getPoints()[s];return e.x+=n.x-l.x,e.y+=n.y-l.y,s},this.x=0,this.y=0,this.w=0,this.h=0,this.doneAdding=!1,this.doors=[null,null,null,null,null,null]};t.LevelGenerator=function(){var e=this;this.rooms=[],this.levels=[],this.upLadder=null,this.noCollisions=function(t){for(var n=0,r=e.rooms;n<r.length;n++){var o=r[n];if(t.collides(o))return!1}return!0},this.pickType=function(t,n){var a=o.RoomType.DUNGEON;switch(r.Game.rand(1,9,n)){case 1:a=o.RoomType.FOUNTAIN,(t.h<=5||t.w>9&&t.h>9)&&(a=e.pickType(t,n));break;case 2:a=o.RoomType.COFFIN,t.w<=5&&(a=e.pickType(t,n));break;case 3:a=o.RoomType.TREASURE;break;case 4:case 5:a=o.RoomType.GRASS}return a},this.shuffle=function(e,t){var n,r,o;for(o=e.length-1;o>0;o--)n=Math.floor(t()*(o+1)),r=e[o],e[o]=e[n],e[n]=r;return e},this.addRooms=function(t,n,a,i){var s,c=e.shuffle([0,1,2,3,4,5,6,7,8,9,10,11],i);n&&(s=n.getPoints());for(var u=0;u<c.length;u++)for(var h=c[u],p=0;p<20;p++){var d=new l;d.x=0,d.y=0;var f=r.Game.rand(1,12,i);if(n)switch(t.type){case o.RoomType.ROPECAVE:case o.RoomType.ROPEHOLE:f=d.generateAroundPoint(i,s[h],h,3,4);break;case o.RoomType.DUNGEON:f=d.generateAroundPoint(i,s[h],h,r.Game.randTable([5,5,5,5,5,6,6,6,6,6,7,7,7,7,9,9,10],i),r.Game.randTable([5,5,5,5,5,6,6,6,6,6,7,7,7,7,9,9,10],i));break;case o.RoomType.BIGDUNGEON:f=d.generateAroundPoint(i,s[h],h,r.Game.randTable([10,11,12,13],i),r.Game.randTable([10,11,12,13],i));break;case o.RoomType.BIGCAVE:f=d.generateAroundPoint(i,s[h],h,15,15);break;case o.RoomType.UPLADDER:case o.RoomType.DOWNLADDER:f=d.generateAroundPoint(i,s[h],h,5,5);break;case o.RoomType.SPAWNER:f=d.generateAroundPoint(i,s[h],h,r.Game.randTable([9,10,11],i),r.Game.randTable([9,10,11],i));break;case o.RoomType.PUZZLE:case o.RoomType.COFFIN:case o.RoomType.FOUNTAIN:f=d.generateAroundPoint(i,s[h],h,11,11);break;case o.RoomType.SPIKECORRIDOR:f=d.generateAroundPoint(i,s[h],h,r.Game.randTable([3,5],i),r.Game.randTable([9,10,11],i));break;default:f=d.generateAroundPoint(i,s[h],h)}else d.x=-2,d.y=-2,d.w=7,d.h=7,t.type===o.RoomType.UPLADDER?(d.w=5,d.h=5):t.type===o.RoomType.ROPECAVE&&(d.w=3,d.h=4);if(e.noCollisions(d)){var m=new o.Level(e.game,d.x,d.y,d.w,d.h,t.type,t.difficulty,e.group,i);if(m.upLadder&&(e.upLadder=m.upLadder),e.levels.push(m),a){var y=m.addDoor(f,null);y.linkedDoor=a.addDoor(h,y),d.doors[f]=y}e.rooms.push(d);for(var v=0,g=t.children;v<g.length;v++){var w=g[v];if(!e.addRooms(w,d,m,i))return!1}return!0}}return!1},this.setSeed=function(t){e.seed=a.Random.xmur3(t)},this.generate=function(t,n,r){void 0===r&&(r=!1);var i,l=a.Random.sfc32(e.seed(),e.seed(),e.seed(),e.seed()),c=n;i=r?new s(o.RoomType.ROPECAVE,c,[new s(o.RoomType.BIGCAVE,c,[new s(o.RoomType.CAVE,c,[new s(o.RoomType.CAVE,c,[])]),new s(o.RoomType.CAVE,c,[]),new s(o.RoomType.CAVE,c,[])])]):0==c?new s(o.RoomType.SHOP,c,[new s(o.RoomType.DOWNLADDER,c,[])]):new s(o.RoomType.UPLADDER,c,[new s(o.RoomType.DUNGEON,c,[new s(o.RoomType.DUNGEON,c,[new s(o.RoomType.DUNGEON,c,[new s(o.RoomType.TREASURE,c,[])])])]),new s(o.RoomType.DUNGEON,c,[new s(o.RoomType.DUNGEON,c,[new s(o.RoomType.DUNGEON,c,[new s(o.RoomType.TREASURE,c,[])])])]),new s(o.RoomType.DUNGEON,c,[new s(o.RoomType.DUNGEON,c,[new s(o.RoomType.DUNGEON,c,[new s(o.RoomType.DOWNLADDER,c,[])])])]),new s(o.RoomType.ROPEHOLE,c,[])]),e.game=t,e.game.levels.length>0?e.group=e.game.levels[e.game.levels.length-1].group+1:e.group=0;var u=!1;do{e.rooms.splice(0),e.levels.splice(0),u=e.addRooms(i,null,null,l)}while(!u);if(e.game.levels=e.game.levels.concat(e.levels),0!=c)return e.upLadder}}},5752:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LightSource=void 0;t.LightSource=function(e,t,n){this.x=e,this.y=t,this.r=n}},9232:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Map=void 0;var r=n(2967),o=n(988),a=n(3161);t.Map=function(e){var t=this;this.draw=function(){t.game.levels[0],r.Game.ctx.globalAlpha=.5,r.Game.ctx.fillStyle="white",r.Game.ctx.fillRect(0,0,o.GameConstants.WIDTH,o.GameConstants.HEIGHT),r.Game.ctx.translate(.5*o.GameConstants.WIDTH,.5*o.GameConstants.HEIGHT),r.Game.ctx.globalAlpha=1;for(var e=0,n=t.game.levels;e<n.length;e++){var i=n[e];if(t.game.level.group===i.group){r.Game.ctx.fillStyle="black",i.type===a.RoomType.UPLADDER&&(r.Game.ctx.fillStyle="#101460"),i.type===a.RoomType.DOWNLADDER&&(r.Game.ctx.fillStyle="#601410"),i.entered||(r.Game.ctx.fillStyle="#606060"),r.Game.ctx.fillRect(i.x,i.y+1,i.width,i.height-1);for(var s=0,l=i.doors;s<l.length;s++){var c=l[s];r.Game.ctx.fillStyle="black",i.entered||(r.Game.ctx.fillStyle="#606060"),r.Game.ctx.fillRect(i.x-i.roomX+c.x,i.y-i.roomY+c.y,1,1)}}}for(var u in r.Game.ctx.fillStyle=o.GameConstants.RED,t.game.players)t.game.levels[t.game.players[u].levelID].group===t.game.level.group&&r.Game.ctx.fillRect(t.game.levels[t.game.players[u].levelID].x-t.game.levels[t.game.players[u].levelID].roomX+t.game.players[u].x,t.game.levels[t.game.players[u].levelID].y-t.game.levels[t.game.players[u].levelID].roomY+t.game.players[u].y,1,1);r.Game.ctx.setTransform(1,0,0,1,0,0)},this.game=e}},5440:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.DeathParticle=void 0;var a=n(2967),i=n(988),s=function(e){function t(t,n){var r=e.call(this)||this;return r.draw=function(){var e=Math.max(0,3*(r.frame-3)/i.GameConstants.TILESIZE),t=Math.round(r.frame);2==t||4==t||6==t?a.Game.drawMob(2,0,1,2,r.x,r.y-e,1,2):a.Game.drawFX(Math.round(r.frame),4,1,2,r.x,r.y-e,1,2),r.frame+=.3,r.frame>10&&(r.dead=!0)},r.x=t,r.y=n-1.5,r.dead=!1,r.frame=0,r}return o(t,e),t}(n(1670).Particle);t.DeathParticle=s},2621:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.GenericParticle=void 0;var a=n(1670),i=n(2967),s=n(988),l=function(e){function t(t,n,r,o,a,l,c,u,h,p,d,f,m,y){var v=e.call(this)||this;return v.render=function(){var e=s.GameConstants.TILESIZE,t=v.s*v.alpha*.5,n=i.Game.ctx.fillStyle;i.Game.ctx.fillStyle=v.color,i.Game.ctx.beginPath(),i.Game.ctx.arc(Math.round(v.x*e),Math.round((v.y-v.z)*e),Math.round(t*e),0,2*Math.PI,!1),i.Game.ctx.fill(),i.Game.ctx.fillStyle=n},v.draw=function(){v.targetX?v.x+=.1*(v.targetX-v.x):v.x+=v.dx,v.targetY?v.y+=.1*(v.targetY-v.y):v.y+=v.dy,v.targetZ?v.z+=.1*(v.targetZ-v.z):v.z+=v.dz,v.dx*=.97,v.dy*=.97,v.z<=0&&(v.z=0,v.dz*=-.8),v.dz-=.01,v.alpha<.2?v.alpha-=.007:v.alpha-=.02,v.alpha<=.1&&(v.dead=!0),v.expirationTimer--,v.expirationTimer<=0&&(v.dead=!0),v.dead||v.render()},v.level=t,v.x=n,v.y=r,v.z=o,v.s=a,v.dx=l,v.dy=c,v.dz=u,v.color=h,v.alpha=1,void 0!==p&&(v.delay=p),v.targetX=f,v.targetY=m,v.targetZ=y,v.expirationTimer=1e6,void 0!==d&&(v.expirationTimer=d),v}return o(t,e),t.shotgun=function(e,n,r,o,a,i){for(var s=0;s<4;s++)e.particles.push(new t(e,n,r,0,.5*Math.random()+.3,0,0,0,i,0,1e7,o+Math.random()-.5,a+Math.random()-.5,0))},t.spawnCluster=function(e,n,r,o){for(var a=0;a<4;a++)e.particles.push(new t(e,n+.05*Math.random()-.025,r+.05*Math.random()-.025,.5*Math.random(),.0625*(a+8),.025*(2*Math.random()-1),.025*(2*Math.random()-1),.2*(Math.random()-1),o,0))},t}(a.Particle);t.GenericParticle=l},1670:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Particle=void 0;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t}(n(6779).Drawable);t.Particle=a},5554:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.SlashParticle=void 0;var a=n(2967),i=function(e){function t(t,n){var r=e.call(this)||this;return r.draw=function(){a.Game.drawFX(Math.round(r.frame),13,1,1,r.x,r.y,1,1),r.frame+=.5,r.frame>9&&(r.dead=!0)},r.x=t,r.y=n-.25,r.dead=!1,r.frame=0,r}return o(t,e),t}(n(1670).Particle);t.SlashParticle=i},4568:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.WizardTeleportParticle=void 0;var a=n(1670),i=n(2967),s=function(e){function t(t,n){var r=e.call(this)||this;return r.draw=function(){i.Game.drawFX(Math.floor(r.frame),3,1,1,r.x,r.y-r.z,1,1),r.z+=r.dz,r.dz*=.9,r.frame+=.25,r.frame>6&&(r.dead=!0)},r.x=t,r.y=n,r.dead=!1,r.frame=0,r.z=0,r.dz=.1,r}return o(t,e),t}(a.Particle);t.WizardTeleportParticle=s},663:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Player=void 0;var r,o=n(8835),a=n(988),i=n(2967),s=n(9143),l=n(5654),c=n(9039),u=n(7531),h=n(8791),p=n(5958),d=n(5742),f=n(9232),m=n(5554),y=n(3338),v=n(6882);!function(e){e[e.DOWN=0]="DOWN",e[e.UP=1]="UP",e[e.RIGHT=2]="RIGHT",e[e.LEFT=3]="LEFT"}(r||(r={}));t.Player=function(e,t,n,g){var w=this;this.inputHandler=function(e){switch(e){case o.InputEnum.I:case o.InputEnum.Q:w.game.socket.emit("input",w.game.localPlayerID,e);break;case o.InputEnum.LEFT:case o.InputEnum.RIGHT:case o.InputEnum.UP:case o.InputEnum.DOWN:w.ignoreDirectionInput()||w.game.socket.emit("input",w.game.localPlayerID,e);break;case o.InputEnum.SPACE:w.game.socket.emit("input",w.game.localPlayerID,e)}},this.tapListener=function(){w.inventory.open()},this.iListener=function(){w.inventory.open()},this.qListener=function(){w.inventory.isOpen&&w.inventory.drop()},this.ignoreDirectionInput=function(){return!w.inventory.isOpen&&(w.dead||w.game.levelState!==i.LevelState.IN_LEVEL)},this.leftListener=function(e){return w.inventory.isOpen?(w.inventory.left(),!0):!(w.dead||e&&w.game.levelState!==i.LevelState.IN_LEVEL||(w.left(),0))},this.rightListener=function(e){return w.inventory.isOpen?(w.inventory.right(),!0):!(w.dead||e&&w.game.levelState!==i.LevelState.IN_LEVEL||(w.right(),0))},this.upListener=function(e){return w.inventory.isOpen?(w.inventory.up(),!0):!(w.dead||e&&w.game.levelState!==i.LevelState.IN_LEVEL||(w.up(),0))},this.downListener=function(e){return w.inventory.isOpen?(w.inventory.down(),!0):!(w.dead||e&&w.game.levelState!==i.LevelState.IN_LEVEL||(w.down(),0))},this.spaceListener=function(){w.inventory.isOpen?w.inventory.space():w.openVendingMachine&&w.openVendingMachine.space()},this.left=function(){w.tryMove(w.x-1,w.y),w.direction=r.LEFT},this.right=function(){w.tryMove(w.x+1,w.y),w.direction=r.RIGHT},this.up=function(){w.tryMove(w.x,w.y-1),w.direction=r.UP},this.down=function(){w.tryMove(w.x,w.y+1),w.direction=r.DOWN},this.hit=function(){return 1},this.tryCollide=function(e,t,n){return!(t>=e.x+e.w||t+w.w<=e.x||n>=e.y+e.h||n+w.h<=e.y)},this.tryMove=function(e,t){if(w.game.levels[w.levelID].catchUp(),!w.dead&&(!w.inventory.hasWeapon()||w.inventory.getWeapon().weaponMove(e,t))){for(var n=0,r=w.game.levels[w.levelID].enemies;n<r.length;n++){var o=r[n];if(w.tryCollide(o,e,t))if(o.pushable){for(var a=e-w.x,i=t-w.y,u=e+a,d=t+i,f=!1,y=!1,g=[];;){f=!0;for(var _=0,C=w.game.levels[w.levelID].enemies;_<C.length;_++)if((I=C[_]).x===u&&I.y===d){if(!I.chainPushable){y=!0,f=!0;break}f=!1,g.push(I);break}if(f)break;u+=a,d+=i}if(0!==g.length||!w.game.levels[w.levelID].levelArray[u][d].canCrushEnemy()&&!y){w.game.levels[w.levelID]===w.game.level&&p.Sound.push();for(var b=0,E=g;b<E.length;b++){var I;(I=E[b]).x+=a,I.y+=i,I.drawX=a,I.drawY=i,I.skipNextTurns=1}return(w.game.levels[w.levelID].levelArray[u][d].canCrushEnemy()||y)&&g[g.length-1].killNoBones(),o.x+=a,o.y+=i,o.drawX=a,o.drawY=i,w.move(e,t),void w.game.levels[w.levelID].tick(w)}if(o.destroyable)return o.kill(),w.game.levels[w.levelID]===w.game.level&&p.Sound.hit(),w.drawX=.5*(w.x-o.x),w.drawY=.5*(w.y-o.y),w.game.levels[w.levelID].particles.push(new m.SlashParticle(o.x,o.y)),w.game.levels[w.levelID].tick(w),void w.game.shakeScreen(10*w.drawX,10*w.drawY)}else if(!o.dead)return void(o.interactable&&o.interact(w))}var T=w.game.levels[w.levelID].levelArray[e][t];T.isSolid()?T instanceof h.LockedDoor&&(w.drawX=.5*(w.x-e),w.drawY=.5*(w.y-t),T.unlock(w)):(w.move(e,t),T.onCollide(w),T instanceof s.Door||T instanceof l.BottomDoor||T instanceof c.Trapdoor||T instanceof v.SideDoor||w.game.levels[w.levelID].tick(w))}},this.hurt=function(e){w.game.levels[w.levelID]===w.game.level&&p.Sound.hurt(),w.inventory.getArmor()&&w.inventory.getArmor().health>0?w.inventory.getArmor().hurt(e):(w.healthBar.hurt(),w.flashing=!0,w.health-=e,w.health<=0&&(w.health=0,w.dead=!0))},this.dashMove=function(e,t){w.x=e,w.y=t;for(var n=0,r=w.game.levels[w.levelID].items;n<r.length;n++){var o=r[n];o.x===e&&o.y===t&&o.onPickup(w)}w.game.levels[w.levelID].updateLighting()},this.doneMoving=function(){return Math.abs(w.drawX)<.01&&Math.abs(w.drawY)<.01},this.move=function(e,t){w.game.levels[w.levelID]===w.game.level&&p.Sound.playerStoneFootstep(),w.openVendingMachine&&w.openVendingMachine.close(),w.drawX=e-w.x,w.drawY=t-w.y,w.x=e,w.y=t;for(var n=0,r=w.game.levels[w.levelID].items;n<r.length;n++){var o=r[n];o.x===e&&o.y===t&&o.onPickup(w)}w.game.levels[w.levelID].updateLighting()},this.moveNoSmooth=function(e,t){w.x=e,w.y=t},this.moveSnap=function(e,t){w.x=e,w.y=t,w.drawX=0,w.drawY=0},this.update=function(){},this.finishTick=function(){w.inventory.tick(),w.flashing=!1;var e=w.health-w.lastTickHealth;w.lastTickHealth=w.health,e<0&&(w.flashing=!0)},this.drawPlayerSprite=function(){w.frame+=.1,w.frame>=4&&(w.frame=0),i.Game.drawMob(1+Math.floor(w.frame),8+2*w.direction,1,2,w.x-w.drawX,w.y-1.5-w.drawY,1,2),w.inventory.getArmor()&&w.inventory.getArmor().health},this.draw=function(){w.flashingFrame+=12/a.GameConstants.FPS,w.dead||(i.Game.drawMob(0,0,1,1,w.x-w.drawX,w.y-w.drawY,1,1),w.flashing&&Math.floor(w.flashingFrame)%2!=0||w.drawPlayerSprite())},this.heartbeat=function(){w.guiHeartFrame=1},this.drawTopLayer=function(){w.healthBar.draw(w.health,w.maxHealth,w.x-w.drawX,w.y-w.drawY,!w.flashing||Math.floor(w.flashingFrame)%2==0)},this.drawGUI=function(){if(w.dead){i.Game.ctx.fillStyle=d.LevelConstants.LEVEL_TEXT_COLOR;var e="Game Over";i.Game.fillText(e,a.GameConstants.WIDTH/2-i.Game.measureText(e).width/2,a.GameConstants.HEIGHT/2-i.Game.letter_height+2)}else{w.inventory.draw(),w.guiHeartFrame>0&&w.guiHeartFrame++,w.guiHeartFrame>5&&(w.guiHeartFrame=0);for(var t=0;t<w.maxHealth;t++){var n=w.guiHeartFrame>0?1:0;t>=Math.floor(w.health)?t==Math.floor(w.health)&&2*w.health%2==1?i.Game.drawFX(4,2,1,1,t,d.LevelConstants.SCREEN_H-1,1,1):i.Game.drawFX(3,2,1,1,t,d.LevelConstants.SCREEN_H-1,1,1):i.Game.drawFX(n,2,1,1,t,d.LevelConstants.SCREEN_H-1,1,1)}w.inventory.getArmor()&&w.inventory.getArmor().drawGUI(w.maxHealth)}!o.Input.isDown(o.Input.M)&&!o.Input.isTapHold||w.game.chatOpen||w.map.draw()},this.updateDrawXY=function(){w.drawX+=-.5*w.drawX,w.drawY+=-.5*w.drawY},this.game=e,this.levelID=0,this.x=t,this.y=n,this.w=1,this.h=1,this.frame=0,this.direction=r.UP,this.isLocalPlayer=g,g&&(o.Input.leftSwipeListener=function(){return w.inputHandler(o.InputEnum.LEFT)},o.Input.rightSwipeListener=function(){return w.inputHandler(o.InputEnum.RIGHT)},o.Input.upSwipeListener=function(){return w.inputHandler(o.InputEnum.UP)},o.Input.downSwipeListener=function(){return w.inputHandler(o.InputEnum.DOWN)}),this.health=2,this.maxHealth=2,this.healthBar=new y.HealthBar,this.dead=!1,this.flashing=!1,this.flashingFrame=0,this.lastTickHealth=this.health,this.guiHeartFrame=0,this.inventory=new u.Inventory(e,this),this.missProb=.1,this.defaultSightRadius=6,this.sightRadius=this.defaultSightRadius,this.map=new f.Map(this.game)}},209:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.EnemySpawnAnimation=void 0;var a=n(5285),i=n(2967),s=n(2621),l=n(5958),c=function(e){function t(t,n,r,o,a,c){var u=e.call(this,r,o)||this;u.ANIM_COUNT=3,u.tick=function(){for(var e in u.level===u.level.game.level&&l.Sound.enemySpawn(),u.dead=!0,u.enemy.skipNextTurns=1,u.level.enemies.push(u.enemy),u.level.game.players)u.level.game.players[e].x===u.x&&u.level.game.players[e].y===u.y&&(u.level.game.players[e].hurt(.5),u.level.game.players[e].move(u.knockbackX,u.knockbackY));s.GenericParticle.spawnCluster(u.level,u.x+.5,u.y+.5,"#ffffff"),s.GenericParticle.spawnCluster(u.level,u.x+.5,u.y+.5,"#ffffff")},u.drawTopLayer=function(){u.frame+=.25,u.frame>=8&&(u.frame=0);for(var e=0;e<u.ANIM_COUNT;e++)i.Game.drawFX(Math.floor(u.frame),26,1,2,u.x+Math.round(0)/16,u.y-1.5,1,2);Math.floor(4*u.frame)%2==0&&u.level.particles.push(new s.GenericParticle(u.level,u.x+.5+.05*Math.random()-.025,u.y+.05*Math.random()-.025,.25,.5*Math.random(),.025*(1*Math.random()-.5),.025*(1*Math.random()-.5),.2*(Math.random()-1),"#ffffff",0))},u.level=t,u.enemy=n,u.frame=0,u.f=[],u.xx=[],u.yy=[];for(var h=0;h<u.ANIM_COUNT;h++)u.f[h]=u.xx[h]=6.28*Math.random(),u.yy[h]=8*Math.random()-8;return u.knockbackX=a,u.knockbackY=c,u}return o(t,e),t}(a.Projectile);t.EnemySpawnAnimation=c},8084:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.HitWarning=void 0;var a=n(5285),i=n(2967),s=function(e){function t(n,r,o){var a=e.call(this,r,o)||this;return a.tick=function(){a.dead=!0},a.draw=function(){(a.x===a.game.players[a.game.localPlayerID].x&&Math.abs(a.y-a.game.players[a.game.localPlayerID].y)<=1||a.y===a.game.players[a.game.localPlayerID].y&&Math.abs(a.x-a.game.players[a.game.localPlayerID].x)<=1)&&i.Game.drawFX(18+Math.floor(t.frame),6,1,1,a.x,a.y,1,1)},a.drawTopLayer=function(){(a.x===a.game.players[a.game.localPlayerID].x&&Math.abs(a.y-a.game.players[a.game.localPlayerID].y)<=1||a.y===a.game.players[a.game.localPlayerID].y&&Math.abs(a.x-a.game.players[a.game.localPlayerID].x)<=1)&&i.Game.drawFX(18+Math.floor(t.frame),5,1,1,a.x,a.y,1,1)},a.game=n,a}return o(t,e),t.frame=0,t.updateFrame=function(){t.frame+=.125,t.frame>=4&&(t.frame=0)},t}(a.Projectile);t.HitWarning=s},5285:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Projectile=void 0;var a=function(e){function t(t,n){var r=e.call(this)||this;return r.hitPlayer=function(e){},r.hitEnemy=function(e){},r.tick=function(){},r.draw=function(){},r.drawTopLayer=function(){},r.x=t,r.y=n,r.dead=!1,r.drawableY=n,r}return o(t,e),t}(n(6779).Drawable);t.Projectile=a},5363:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.WizardFireball=void 0;var a=n(5285),i=n(2967),s=function(e){function t(t,n,r){var o=e.call(this,n,r)||this;return o.tick=function(){o.parent.dead&&(o.dead=!0),o.state++,2===o.state&&(o.frame=0,o.delay=i.Game.rand(0,10))},o.hitPlayer=function(e){2!==o.state||o.dead||e.hurt(1)},o.draw=function(){if(0===o.state)o.frame+=.25,o.frame>=4&&(o.frame=0),i.Game.drawFX(22+Math.floor(o.frame),7,1,1,o.x,o.y,1,1);else if(1===o.state)o.frame+=.25,o.frame>=4&&(o.frame=0),i.Game.drawFX(18+Math.floor(o.frame),7,1,1,o.x,o.y,1,1);else{if(o.delay>0)return void o.delay--;o.frame+=.3,o.frame>17&&(o.dead=!0),i.Game.drawFX(Math.floor(o.frame),6,1,2,o.x,o.y-1,1,2)}},o.parent=t,o.state=0,o.frame=0,o}return o(t,e),t}(a.Projectile);t.WizardFireball=s},792:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Random=void 0;var n=function(){function e(){}return e.xmur3=function(e){for(var t=0,n=1779033703^e.length;t<e.length;t++)n=(n=Math.imul(n^e.charCodeAt(t),3432918353))<<13|n>>>19;return function(){return n=Math.imul(n^n>>>16,2246822507),n=Math.imul(n^n>>>13,3266489909),(n^=n>>>16)>>>0}},e.sfc32=function(e,t,n,r){return function(){var o=(e>>>=0)+(t>>>=0)|0;return e=t^t>>>9,t=(n>>>=0)+(n<<3)|0,n=(n=n<<21|n>>>11)+(o=o+(r=1+(r>>>=0)|0)|0)|0,(o>>>0)/4294967296}},e}();t.Random=n},9784:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ServerAddress=void 0,t.ServerAddress={address:"witch-roguelike-server.herokuapp.com"}},5958:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sound=void 0;var r=n(2967),o=function(){function e(){}return e.loadSounds=function(){e.playerStoneFootsteps=new Array,[1,2,3].forEach((function(t){return e.playerStoneFootsteps.push(new Audio("res/SFX/footsteps/stone/footstep"+t+".wav"))}));for(var t=0,n=e.playerStoneFootsteps;t<n.length;t++)n[t].volume=1;e.enemyFootsteps=new Array,[1,2,3,4,5].forEach((function(t){return e.enemyFootsteps.push(new Audio("res/SFX/footsteps/enemy/enemyfootstep"+t+".wav"))}));for(var r=0,o=e.enemyFootsteps;r<o.length;r++)o[r].volume=1;e.hitSounds=new Array,[1,2,3,4].forEach((function(t){return e.hitSounds.push(new Audio("res/SFX/attacks/swing"+t+".wav"))}));for(var a=0,i=e.hitSounds;a<i.length;a++)i[a].volume=1;e.enemySpawnSound=new Audio("res/SFX/attacks/enemyspawn.wav"),e.enemySpawnSound.volume=1,e.chestSounds=new Array,[1,2,3].forEach((function(t){return e.chestSounds.push(new Audio("res/SFX/chest/chest"+t+".wav"))}));for(var s=0,l=e.chestSounds;s<l.length;s++)l[s].volume=1;e.coinPickupSounds=new Array,[1,2,3,4].forEach((function(t){return e.coinPickupSounds.push(new Audio("res/SFX/items/coins"+t+".wav"))}));for(var c=0,u=e.coinPickupSounds;c<u.length;c++)u[c].volume=1;e.miningSounds=new Array,[1,2,3,4].forEach((function(t){return e.miningSounds.push(new Audio("res/SFX/resources/Pickaxe"+t+".wav"))}));for(var h=0,p=e.miningSounds;h<p.length;h++)p[h].volume=1;e.hurtSounds=new Array,[1].forEach((function(t){return e.hurtSounds.push(new Audio("res/SFX/attacks/hit.wav"))}));for(var d=0,f=e.hurtSounds;d<f.length;d++)f[d].volume=1;e.genericPickupSound=new Audio("res/SFX/items/pickup.wav"),e.genericPickupSound.volume=1,e.breakRockSound=new Audio("res/SFX/resources/rockbreak.wav"),e.breakRockSound.volume=1,e.pushSounds=new Array,[1,2].forEach((function(t){return e.pushSounds.push(new Audio("res/SFX/pushing/push"+t+".wav"))}));for(var m=0,y=e.pushSounds;m<y.length;m++)y[m].volume=1;e.powerupSound=new Audio("res/powerup.wav"),e.powerupSound.volume=.5,e.healSound=new Audio("res/heal.wav"),e.healSound.volume=.5,e.music=new Audio("res/bewitched.mp3")},e.playerStoneFootstep=function(){var t=r.Game.randTable(e.playerStoneFootsteps);t.play(),t.currentTime=0},e.enemyFootstep=function(){var t=r.Game.randTable(e.enemyFootsteps);t.play(),t.currentTime=0},e.hit=function(){var t=r.Game.randTable(e.hitSounds);t.play(),t.currentTime=0,(t=r.Game.randTable(e.hurtSounds)).volume=.5,t.play(),t.currentTime=0,t.volume=1},e.hurt=function(){var t=r.Game.randTable(e.hurtSounds);t.play(),t.currentTime=0},e.enemySpawn=function(){e.enemySpawnSound.play(),e.enemySpawnSound.currentTime=0},e.chest=function(){var t=r.Game.randTable(e.chestSounds);t.play(),t.currentTime=0},e.pickupCoin=function(){var t=r.Game.randTable(e.coinPickupSounds);t.play(),t.currentTime=0},e.mine=function(){var t=r.Game.randTable(e.miningSounds);t.play(),t.currentTime=0},e.breakRock=function(){e.breakRockSound.play(),e.breakRockSound.currentTime=0},e.powerup=function(){e.powerupSound.play(),e.powerupSound.currentTime=0},e.heal=function(){e.healSound.play(),e.healSound.currentTime=0},e.genericPickup=function(){e.genericPickupSound.play(),e.genericPickupSound.currentTime=0},e.push=function(){var t=r.Game.randTable(e.pushSounds);t.play(),t.currentTime=0},e.playMusic=function(){e.music.addEventListener("ended",(function(){e.music.currentTime=0,e.music.play()}),!1)},e}();t.Sound=o},5269:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Bones=void 0;var a=n(2967),i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.draw=function(){a.Game.drawTile(7,t.skin,1,1,t.x,t.y,1,1,t.level.shadeColor,t.shadeAmount())},t}return o(t,e),t}(n(9626).Floor);t.Bones=i},5654:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.BottomDoor=void 0;var a=n(2967),i=function(e){function t(t,n,r,o,i){var s=e.call(this,t,r,o)||this;return s.canCrushEnemy=function(){return!0},s.onCollide=function(e){e.levelID=s.game.changeLevelThroughDoor(e,s.linkedDoor)},s.drawAbovePlayer=function(){},s.drawAboveShading=function(){a.Game.drawFX(2,2,1,1,s.x,s.y-1.25+.125*Math.sin(.006*Date.now()),1,1)},s.game=n,s.linkedDoor=i,s}return o(t,e),t}(n(1384).Tile);t.BottomDoor=i},850:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Button=void 0;var a=n(2967),i=function(e){function t(t,n,r,o){var i=e.call(this,t,n,r)||this;return i.press=function(){i.pressed=!0,i.linkedDoor.opened=!0},i.unpress=function(){i.pressed=!1,i.linkedDoor.opened=!1},i.tickEnd=function(){for(var e in i.unpress(),i.level.game.players)i.level.game.players[e].x===i.x&&i.level.game.players[e].y===i.y&&i.press();for(var t=0,n=i.level.enemies;t<n.length;t++){var r=n[t];r.x===i.x&&r.y===i.y&&i.press()}},i.draw=function(){a.Game.drawTile(1,0,1,1,i.x,i.y,1,1,i.level.shadeColor,i.shadeAmount()),i.pressed?a.Game.drawTile(18,0,1,1,i.x,i.y,i.w,i.h,i.level.shadeColor,i.shadeAmount()):a.Game.drawTile(17,0,1,1,i.x,i.y,i.w,i.h,i.level.shadeColor,i.shadeAmount())},i.w=1,i.h=1,i.pressed=!1,i.turnsSincePressed=1,i.linkedDoor=o,i}return o(t,e),t}(n(1384).Tile);t.Button=i},1902:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Chasm=void 0;var a=n(2967),i=function(e){function t(t,n,r,o,i,s,l){var c=e.call(this,t,n,r)||this;return c.isSolid=function(){return!0},c.canCrushEnemy=function(){return!0},c.draw=function(){c.topEdge&&a.Game.drawTile(22,0,1,2,c.x,c.y,1,2,c.level.shadeColor,c.shadeAmount())},c.drawUnderPlayer=function(){a.Game.drawTile(c.tileX,c.tileY,1,1,c.x,c.y,1,1,c.level.shadeColor,c.shadeAmount())},c.tileX=1===c.skin?24:20,c.tileY=1,o?c.tileX--:i&&c.tileX++,s?c.tileY--:l&&c.tileY++,c.topEdge=s,c}return o(t,e),t}(n(1384).Tile);t.Chasm=i},5990:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.CoffinTile=void 0;var a=n(2967),i=function(e){function t(t,n,r,o){var i=e.call(this,t,n,r)||this;return i.isSolid=function(){return!0},i.canCrushEnemy=function(){return!0},i.drawUnderPlayer=function(){0===i.subTileY?(a.Game.drawTile(0,5,1,1,i.x-1,i.y-1,1,1,i.level.shadeColor,i.shadeAmount()),a.Game.drawTile(1,5,1,1,i.x,i.y-1,1,1,i.level.shadeColor,i.shadeAmount()),a.Game.drawTile(2,5,1,1,i.x+1,i.y-1,1,1,i.level.shadeColor,i.shadeAmount()),a.Game.drawTile(0,6,1,1,i.x-1,i.y,1,1,i.level.shadeColor,i.shadeAmount()),a.Game.drawTile(1,6,1,1,i.x,i.y,1,1,i.level.shadeColor,i.shadeAmount()),a.Game.drawTile(2,6,1,1,i.x+1,i.y,1,1,i.level.shadeColor,i.shadeAmount())):(a.Game.drawTile(0,7,1,1,i.x-1,i.y,1,1,i.level.shadeColor,i.shadeAmount()),a.Game.drawTile(1,7,1,1,i.x,i.y,1,1,i.level.shadeColor,i.shadeAmount()),a.Game.drawTile(2,7,1,1,i.x+1,i.y,1,1,i.level.shadeColor,i.shadeAmount()))},i.subTileY=o,i}return o(t,e),t}(n(1384).Tile);t.CoffinTile=i},9143:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Door=void 0;var a=n(2967),i=function(e){function t(t,n,r,o,i){var s=e.call(this,t,r,o)||this;return s.canCrushEnemy=function(){return!0},s.onCollide=function(e){s.opened=!0,e.levelID=s.game.changeLevelThroughDoor(e,s.linkedDoor)},s.draw=function(){s.opened?a.Game.drawTile(6,s.skin,1,1,s.x,s.y,1,1,s.level.shadeColor,s.shadeAmount()):a.Game.drawTile(3,s.skin,1,1,s.x,s.y,1,1,s.level.shadeColor,s.shadeAmount())},s.drawAbovePlayer=function(){s.opened?a.Game.drawTile(14,0,1,1,s.x,s.y-1,1,1,s.level.shadeColor,s.shadeAmount()):a.Game.drawTile(13,0,1,1,s.x,s.y-1,1,1,s.level.shadeColor,s.shadeAmount())},s.drawAboveShading=function(){a.Game.drawFX(2,2,1,1,s.x,s.y-1.25+.125*Math.sin(.006*Date.now()),1,1)},s.game=n,s.linkedDoor=i,s.opened=!1,s}return o(t,e),t}(n(1384).Tile);t.Door=i},9382:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.DownLadder=void 0;var a=n(2967),i=function(e){function t(t,n,r,o){var i=e.call(this,t,r,o)||this;return i.isRope=!1,i.generate=function(){i.linkedLadder||(i.linkedLadder=i.game.levelgen.generate(i.game,i.level.depth+(i.isRope?0:1),i.isRope),i.linkedLadder.linkedLadder=i)},i.onCollide=function(e){e.levelID=i.game.changeLevelThroughLadder(e,i)},i.draw=function(){var e=4;i.isRope&&(e=16),a.Game.drawTile(1,i.skin,1,1,i.x,i.y,1,1,i.level.shadeColor,i.shadeAmount()),a.Game.drawTile(e,i.skin,1,1,i.x,i.y,1,1,i.level.shadeColor,i.shadeAmount())},i.drawAbovePlayer=function(){},i.game=n,i.linkedLadder=null,i}return o(t,e),t}(n(1384).Tile);t.DownLadder=i},9626:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Floor=void 0;var a=n(2967),i=n(1384),s=function(e){function t(t,n,r){var o=e.call(this,t,n,r)||this;return o.draw=function(){a.Game.drawTile(o.variation,o.skin,1,1,o.x,o.y,1,1,o.level.shadeColor,o.shadeAmount())},o.variation=1,o.skin==i.SkinType.DUNGEON&&(o.variation=a.Game.randTable([1,1,1,1,1,1,8,8,8,9,10,10,10,10,10,12])),o.skin==i.SkinType.CAVE&&(o.variation=a.Game.randTable([1,1,1,1,1,1,8,8,8,9,10,10,10,10,10,12])),o}return o(t,e),t}(i.Tile);t.Floor=s},8341:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.FountainTile=void 0;var a=n(2967),i=function(e){function t(t,n,r,o,i){var s=e.call(this,t,n,r)||this;return s.isSolid=function(){return!0},s.canCrushEnemy=function(){return!0},s.draw=function(){a.Game.drawTile(1,s.skin,1,1,s.x,s.y,1,1,s.level.shadeColor,s.shadeAmount()),a.Game.drawTile(s.subTileX,2+s.subTileY,1,1,s.x,s.y,1,1,s.level.shadeColor,s.shadeAmount())},s.subTileX=o,s.subTileY=i,s}return o(t,e),t}(n(1384).Tile);t.FountainTile=i},7149:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.InsideLevelDoor=void 0;var a=n(2967),i=function(e){function t(t,n,r,o){var i=e.call(this,t,r,o)||this;return i.isSolid=function(){return!i.opened},i.canCrushEnemy=function(){return!i.opened},i.isOpaque=function(){return!i.opened},i.draw=function(){a.Game.drawTile(1,0,1,1,i.x,i.y,1,1,i.level.shadeColor,i.shadeAmount()),i.opened?a.Game.drawTile(15,1,1,1,i.x,i.y,1,1,i.level.shadeColor,i.shadeAmount()):a.Game.drawTile(3,i.skin,1,1,i.x,i.y,1,1,i.level.shadeColor,i.shadeAmount())},i.drawAbovePlayer=function(){i.opened?a.Game.drawTile(14,0,1,1,i.x,i.y-1,1,1,i.level.shadeColor,i.shadeAmount()):a.Game.drawTile(13,0,1,1,i.x,i.y-1,1,1,i.level.shadeColor,i.shadeAmount())},i.game=n,i.opened=!1,i}return o(t,e),t}(n(1384).Tile);t.InsideLevelDoor=i},8791:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.LockedDoor=void 0;var a=n(2967),i=n(1785),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.unlock=function(e){var n=e.inventory.hasItem(i.Key);null!==n&&(e.inventory.removeItem(n),t.level.levelArray[t.x][t.y]=t.unlockedDoor,t.level.doors.push(t.unlockedDoor))},t.isSolid=function(){return!0},t.canCrushEnemy=function(){return!0},t.isOpaque=function(){return!0},t.draw=function(){a.Game.drawTile(17,t.skin,1,1,t.x,t.y,1,1,t.level.shadeColor,t.shadeAmount())},t}return o(t,e),t}(n(1384).Tile);t.LockedDoor=s},6882:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.SideDoor=void 0;var a=n(2967),i=function(e){function t(t,n,r,o,i){var s=e.call(this,t,r,o)||this;return s.canCrushEnemy=function(){return!0},s.onCollide=function(e){s.opened=!0,e.levelID=s.game.changeLevelThroughDoor(e,s.linkedDoor,s.linkedDoor.level.x-s.level.x>0?1:-1)},s.draw=function(){a.Game.drawTile(0,s.skin,1,1,s.x,s.y-1,1,1,s.level.shadeColor,s.shadeAmount()),a.Game.drawTile(1,s.skin,1,1,s.x,s.y,1,1,s.level.shadeColor,s.shadeAmount())},s.drawAbovePlayer=function(){},s.drawAboveShading=function(){a.Game.drawFX(2,2,1,1,s.x,s.y-1.25+.125*Math.sin(.006*Date.now()),1,1)},s.game=n,s.linkedDoor=i,s.opened=!1,s}return o(t,e),t}(n(1384).Tile);t.SideDoor=i},953:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.SpawnFloor=void 0;var a=n(2967),i=function(e){function t(t,n,r){var o=e.call(this,t,n,r)||this;return o.draw=function(){a.Game.drawTile(o.variation,o.skin,1,1,o.x,o.y,o.w,o.h,o.level.shadeColor,o.shadeAmount())},o.w=1,o.h=1,o.variation=1,1==a.Game.rand(1,20)&&(o.variation=a.Game.randTable([8,9,10,12])),o}return o(t,e),t}(n(1384).Tile);t.SpawnFloor=i},5525:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Spike=void 0;var a=n(2967),i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onCollide=function(e){e.hurt(1)},t.draw=function(){a.Game.drawTile(11,0,1,1,t.x,t.y,1,1,t.level.shadeColor,t.shadeAmount())},t}return o(t,e),t}(n(1384).Tile);t.Spike=i},3280:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.SpikeTrap=void 0;var a=n(2967),i=n(1384),s=n(6061),l=n(6750),c=n(8084),u=function(e){function t(t,n,r,o){var i=e.call(this,t,n,r)||this;return i.tick=function(){if(i.tickCount++,i.tickCount>=4&&(i.tickCount=0),i.on=0===i.tickCount,i.on)for(var e in i.level.game.players)i.level===i.level.game.levels[i.level.game.players[e].levelID]&&i.level.game.players[e].x===i.x&&i.level.game.players[e].y===i.y&&i.level.game.players[e].hurt(1);3===i.tickCount&&i.level.projectiles.push(new c.HitWarning(i.level.game,i.x,i.y))},i.tickEnd=function(){if(i.on)for(var e=0,t=i.level.enemies;e<t.length;e++){var n=t[e];n.x===i.x&&n.y===i.y&&n.hurt(null,1)}},i.onCollideEnemy=function(e){i.on&&!(e instanceof s.Crate||e instanceof l.Barrel)&&e.hurt(null,1)},i.draw=function(){a.Game.drawTile(1,i.skin,1,1,i.x,i.y,1,1,i.level.shadeColor,i.shadeAmount())},i.t=0,i.drawUnderPlayer=function(){var e=0;i.t++,i.on||3!==i.tickCount||(i.t%4==1&&(e=.0325),i.t%4==3&&(e=-.0325));var t=[0,1,2,3,3,4,2,0],n=6+t[Math.floor(i.frame)];(1===i.tickCount||0===i.tickCount&&0===t[Math.floor(i.frame)])&&(n=5),a.Game.drawObj(n,0,1,2,i.x+e,i.y-1,1,2,i.level.shadeColor,i.shadeAmount()),i.on&&i.frame<t.length-1&&(t[Math.floor(i.frame)]<3?i.frame+=.4:i.frame+=.2),i.on||(i.frame=0)},i.tickCount=o||0,i.on=!1,i.frame=0,i}return o(t,e),t}(i.Tile);t.SpikeTrap=u},1384:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Tile=t.SkinType=void 0,(n=t.SkinType||(t.SkinType={}))[n.DUNGEON=0]="DUNGEON",n[n.CAVE=1]="CAVE";t.Tile=function(e,t,n){var r=this;this.shadeAmount=function(){return r.level.softVis[r.x][r.y]},this.isSolid=function(){return!1},this.canCrushEnemy=function(){return!1},this.isOpaque=function(){return!1},this.onCollide=function(e){},this.onCollideEnemy=function(e){},this.tick=function(){},this.tickEnd=function(){},this.draw=function(){},this.drawUnderPlayer=function(){},this.drawAbovePlayer=function(){},this.drawAboveShading=function(){},this.skin=e.skin,this.level=e,this.x=t,this.y=n}},9039:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Trapdoor=void 0;var a=n(2967),i=function(e){function t(t,n,r,o){var i=e.call(this,t,r,o)||this;return i.draw=function(){a.Game.drawTile(13,i.skin,1,1,i.x,i.y,1,1,i.level.shadeColor,i.shadeAmount())},i.onCollide=function(e){},i.game=n,i}return o(t,e),t}(n(1384).Tile);t.Trapdoor=i},6563:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.UpLadder=void 0;var a=n(2967),i=function(e){function t(t,n,r,o){var i=e.call(this,t,r,o)||this;return i.isRope=!1,i.onCollide=function(e){e.levelID=i.game.changeLevelThroughLadder(e,i)},i.draw=function(){var e=29,t=0;i.isRope&&(e=16,t=1),a.Game.drawTile(1,i.skin,1,1,i.x,i.y,1,1,i.level.shadeColor,i.shadeAmount()),i.isRope||a.Game.drawTile(e,t,1,1,i.x,i.y-1,1,1,i.level.shadeColor,i.shadeAmount()),a.Game.drawTile(e,t+1,1,1,i.x,i.y,1,1,i.level.shadeColor,i.shadeAmount())},i.drawAbovePlayer=function(){i.isRope&&a.Game.drawTile(16,1,1,1,i.x,i.y-1,1,1,i.level.shadeColor,i.shadeAmount())},i.game=n,i}return o(t,e),t}(n(1384).Tile);t.UpLadder=i},312:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Wall=void 0;var a=n(2967),i=function(e){function t(t,n,r,o){var i=e.call(this,t,n,r)||this;return i.isSolid=function(){return!0},i.canCrushEnemy=function(){return!0},i.isOpaque=function(){return!0},i.draw=function(){1===i.type&&a.Game.drawTile(5,i.skin,1,1,i.x,i.y,1,1,i.level.shadeColor,i.shadeAmount())},i.type=o,i}return o(t,e),t}(n(1384).Tile);t.Wall=i},9732:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.WallSide=void 0;var a=n(2967),i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isSolid=function(){return!0},t.canCrushEnemy=function(){return!0},t.isOpaque=function(){return!1},t.draw=function(){a.Game.drawTile(0,t.skin,1,1,t.x,t.y,1,1,t.level.shadeColor,t.shadeAmount())},t}return o(t,e),t}(n(1384).Tile);t.WallSide=i},3400:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.WallSideTorch=void 0;var a=n(2967),i=n(1384),s=n(5752),l=function(e){function t(t,n,r){var o=e.call(this,t,n,r)||this;return o.isSolid=function(){return!0},o.canCrushEnemy=function(){return!0},o.isOpaque=function(){return!1},o.draw=function(){o.frame+=.3,o.frame>=12&&(o.frame=0),a.Game.drawTile(0,o.skin,1,1,o.x,o.y,1,1,o.level.shadeColor,o.shadeAmount()),a.Game.drawFX(Math.floor(o.frame),32,1,2,o.x,o.y-1,1,2)},o.level.lightSources.push(new s.LightSource(o.x+.5,o.y+.5,3)),o.frame=12*Math.random(),o}return o(t,e),t}(i.Tile);t.WallSideTorch=l},6330:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Dagger=void 0;var a=n(2091),i=n(5958),s=n(5554),l=n(6061),c=n(6750),u=function(e){function t(t,n,r){var o=e.call(this,t,n,r)||this;return o.weaponMove=function(e,t){for(var n=!1,r=0,a=o.game.levels[o.wielder.levelID].enemies;r<a.length;r++){var u=a[r];u.destroyable&&!(u instanceof l.Crate||u instanceof c.Barrel)&&u.x===e&&u.y===t&&(u.hurt(o.wielder,1),n=!0)}return n&&(o.wielder.game.levels[o.wielder.levelID]===o.wielder.game.level&&i.Sound.hit(),o.wielder.drawX=.5*(o.wielder.x-e),o.wielder.drawY=.5*(o.wielder.y-t),o.game.levels[o.wielder.levelID].particles.push(new s.SlashParticle(e,t)),o.game.levels[o.wielder.levelID].tick(o.wielder),o.wielder===o.game.players[o.game.localPlayerID]&&o.game.shakeScreen(10*o.wielder.drawX,10*o.wielder.drawY)),!n},o.getDescription=function(){return"DAGGER\nDamage 1"},o.tileX=22,o.tileY=0,o}return o(t,e),t}(a.Weapon);t.Dagger=u},2920:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.DualDagger=void 0;var a=n(2091),i=n(5958),s=n(5554),l=n(6061),c=n(6750),u=function(e){function t(t,n,r){var o=e.call(this,t,n,r)||this;return o.tickInInventory=function(){o.firstAttack=!0},o.weaponMove=function(e,t){for(var n=!1,r=0,a=o.game.levels[o.wielder.levelID].enemies;r<a.length;r++){var u=a[r];u.destroyable&&!(u instanceof l.Crate||u instanceof c.Barrel)&&u.x===e&&u.y===t&&(u.hurt(o.wielder,1),n=!0)}return n&&(o.wielder.game.levels[o.wielder.levelID]===o.wielder.game.level&&i.Sound.hit(),o.wielder.drawX=.5*(o.wielder.x-e),o.wielder.drawY=.5*(o.wielder.y-t),o.game.levels[o.wielder.levelID].particles.push(new s.SlashParticle(e,t)),o.firstAttack?o.game.levels[o.wielder.levelID].enemies=o.game.levels[o.wielder.levelID].enemies.filter((function(e){return!e.dead})):o.game.levels[o.wielder.levelID].tick(o.wielder),o.wielder===o.game.players[o.game.localPlayerID]&&o.game.shakeScreen(10*o.wielder.drawX,10*o.wielder.drawY),o.firstAttack&&(o.firstAttack=!1)),!n},o.getDescription=function(){return"DUAL DAGGERS\nOne extra attack per turn"},o.tileX=23,o.tileY=0,o.firstAttack=!0,o}return o(t,e),t}(a.Weapon);t.DualDagger=u},1656:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Shotgun=void 0;var a=n(2091),i=n(5958),s=n(2621),l=function(e){function t(t,n,r){var o=e.call(this,t,n,r)||this;return o.weaponMove=function(e,t){var n=2*e-o.wielder.x,r=2*t-o.wielder.y,a=3*e-2*o.wielder.x,l=3*t-2*o.wielder.y,c=3;if(!o.game.levels[o.wielder.levelID].tileInside(e,t)||o.game.levels[o.wielder.levelID].levelArray[e][t].isSolid())return!0;!o.game.levels[o.wielder.levelID].tileInside(n,r)||o.game.levels[o.wielder.levelID].levelArray[n][r].isSolid()?c=1:o.game.levels[o.wielder.levelID].tileInside(a,l)&&!o.game.levels[o.wielder.levelID].levelArray[a][l].isSolid()||(c=2);for(var u=[],h=4,p=5,d=5,f=0,m=o.game.levels[o.wielder.levelID].enemies;f<m.length;f++)if((C=m[f]).pushable){if(C.x===e&&C.y===t)return!0;C.x===n&&C.y===r&&c>=2&&(u.push({enemy:C,dist:2}),h=2),C.x===a&&C.y===l&&c>=3&&(u.push({enemy:C,dist:3}),h=Math.min(h,3))}else C.destroyable?(C.x===e&&C.y===t&&c>=1&&(p=1,u.push({enemy:C,dist:1})),C.x===n&&C.y===r&&c>=2&&(p=Math.min(p,2),u.push({enemy:C,dist:2})),C.x===a&&C.y===l&&c>=3&&(p=Math.min(p,3),u.push({enemy:C,dist:3}))):(C.x===e&&C.y===t&&c>=1&&(d=1),C.x===n&&C.y===r&&c>=2&&(d=Math.min(d,2)),C.x===a&&C.y===l&&c>=3&&(d=Math.min(d,3)));var y=a,v=l;if(d<p&&d<h)return!0;if(p<=h){for(var g=0,w=u;g<w.length;g++){var _=w[g],C=_.enemy;3===_.dist?C.hurt(o.wielder,.5):C.hurt(o.wielder,1)}o.wielder.game.levels[o.wielder.levelID]===o.wielder.game.level&&i.Sound.hit(),o.wielder.drawX=.5*(o.wielder.x-e),o.wielder.drawY=.5*(o.wielder.y-t),s.GenericParticle.shotgun(o.game.levels[o.wielder.levelID],o.wielder.x+.5,o.wielder.y,y+.5,v,"black"),s.GenericParticle.shotgun(o.game.levels[o.wielder.levelID],o.wielder.x+.5,o.wielder.y,y+.5,v,"#ffddff");var b=new s.GenericParticle(o.game.levels[o.wielder.levelID],.5*(e+o.wielder.x)+.5,.5*(t+o.wielder.y),0,1,0,0,0,"white",0);return b.expirationTimer=10,o.game.levels[o.wielder.levelID].particles.push(b),o.game.levels[o.wielder.levelID].tick(o.wielder),o.wielder===o.game.players[o.game.localPlayerID]&&o.game.shakeScreen(10*o.wielder.drawX,10*o.wielder.drawY),!1}return!0},o.getDescription=function(){return"SHOTGUN\nRange 3, penetration"},o.tileX=26,o.tileY=0,o}return o(t,e),t}(a.Weapon);t.Shotgun=l},3806:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Spear=void 0;var a=n(2091),i=n(5958),s=n(5554),l=n(6061),c=n(6750),u=function(e){function t(t,n,r){var o=e.call(this,t,n,r)||this;return o.weaponMove=function(e,t){for(var n=2*e-o.wielder.x,r=2*t-o.wielder.y,a=!1,u=[],h=0,p=o.game.levels[o.wielder.levelID].enemies;h<p.length;h++)if((m=p[h]).destroyable){if(m.x===e&&m.y===t){if(m instanceof l.Crate||m instanceof c.Barrel)return!0;m.hurt(o.wielder,1),a=!0}m.x!==n||m.y!==r||o.game.levels[o.wielder.levelID].levelArray[e][t].isSolid()||m instanceof l.Crate||m instanceof c.Barrel||u.push(m)}if(!a&&u.length>0){for(var d=0,f=u;d<f.length;d++){var m;(m=f[d]).hurt(o.wielder,1)}return o.wielder.game.level===o.wielder.game.levels[o.wielder.levelID]&&i.Sound.hit(),o.wielder.drawX=.5*(o.wielder.x-e),o.wielder.drawY=.5*(o.wielder.y-t),o.game.levels[o.wielder.levelID].particles.push(new s.SlashParticle(e,t)),o.game.levels[o.wielder.levelID].particles.push(new s.SlashParticle(n,r)),o.game.levels[o.wielder.levelID].tick(o.wielder),o.wielder===o.game.players[o.game.localPlayerID]&&o.game.shakeScreen(10*o.wielder.drawX,10*o.wielder.drawY),!1}return a&&(o.wielder.game.level===o.wielder.game.levels[o.wielder.levelID]&&i.Sound.hit(),o.wielder.drawX=.5*(o.wielder.x-e),o.wielder.drawY=.5*(o.wielder.y-t),o.game.levels[o.wielder.levelID].particles.push(new s.SlashParticle(e,t)),o.game.levels[o.wielder.levelID].tick(o.wielder),o.wielder===o.game.players[o.game.localPlayerID]&&o.game.shakeScreen(10*o.wielder.drawX,10*o.wielder.drawY)),!a},o.getDescription=function(){return"SPEAR\nRange 2"},o.tileX=24,o.tileY=0,o}return o(t,e),t}(a.Weapon);t.Spear=u},2091:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Weapon=void 0;var a=function(e){function t(n,r,o){var a=e.call(this,n,r,o)||this;return a.setWielder=function(e){a.wielder=e},a.coEquippable=function(e){return!(e instanceof t)},a.tick=function(){},a.weaponMove=function(e,t){return!0},n&&(a.game=n.game),a}return o(t,e),t}(n(8499).Equippable);t.Weapon=a},2281:e=>{"use strict";var t,n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),r={},o=0,a=0;function i(e){var t="";do{t=n[e%64]+t,e=Math.floor(e/64)}while(e>0);return t}function s(){var e=i(+new Date);return e!==t?(o=0,t=e):e+"."+i(o++)}for(;a<64;a++)r[n[a]]=a;s.encode=i,s.decode=function(e){var t=0;for(a=0;a<e.length;a++)t=64*t+r[e.charAt(a)];return t},e.exports=s}},t={};!function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}(2967)})();